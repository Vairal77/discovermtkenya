import{r as l,j as e,ai as Ie,aj as Me,ak as Pe,al as Le,X as Te,am as Ee,an as Fe,ao as Ns,ap as ws,aq as Cs,ar as Oe,as as Ss,w as R,v as Z,at as Ke,au as W,av as ee,x as O,u as B,aw as ks,ax as Be,ay as Re,az as $e,aA as qe,aB as ze,aC as Ue,aD as As,aE as Ds,aF as Is,aG as Ms,aH as Ps,aI as _e,m as ge,a4 as We,a5 as ne,aJ as Ls,aK as fe,aL as Ve,aM as ie,aN as He,aO as je,a8 as le,a9 as X,aP as ve,W as Ts,aQ as Es,aR as Fs,B as ye,aS as J,N as Ne,K as z,aT as we,aU as Ce,aV as Os,J as Ks,aW as Bs,aX as Rs,aY as Se,aZ as $s,a_ as qs,a$ as zs,b0 as Qe,b1 as Ye,b2 as Us,a7 as _s,ab as Ws,b3 as Ge,b4 as Xe,b5 as Vs,b6 as Hs,b7 as Qs,b8 as he,b9 as Je,E as Ys,ba as Gs,bb as Xs,bc as Js,ad as ke,bd as Zs,y as et,be as st,bf as tt,bg as at,bh as rt,bi as nt,bj as it,bk as lt,bl as ot,bm as I,bn as ct,bo as dt}from"./vendor-react-BN7Zx91_.js";import{a as mt}from"./vendor-utils-D77wr3qA.js";import{c as P,l as oe,L as D,I as T,B as S,s as N,S as V,a as H,b as Q,d as Y,e as h,f as Ze,p as F,g as q,m as ut,i as xt,D as es,h as ss,j as ts,k as as,T as rs,C as se,n as te,o as ce,q as de,r as ht,A as pt,t as gt,u as ft,v as jt,w as vt,x as bt}from"./admin-BDO4YSSi.js";import"./vendor-supabase-DgrGuUdD.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();const yt=1,Nt=1e6;let me=0;function wt(){return me=(me+1)%Number.MAX_SAFE_INTEGER,me.toString()}const ue=new Map,Ae=a=>{if(ue.has(a))return;const t=setTimeout(()=>{ue.delete(a),G({type:"REMOVE_TOAST",toastId:a})},Nt);ue.set(a,t)},Ct=(a,t)=>{switch(t.type){case"ADD_TOAST":return{...a,toasts:[t.toast,...a.toasts].slice(0,yt)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?Ae(s):a.toasts.forEach(o=>{Ae(o.id)}),{...a,toasts:a.toasts.map(o=>o.id===s||s===void 0?{...o,open:!1}:o)}}case"REMOVE_TOAST":return t.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(s=>s.id!==t.toastId)}}},ae=[];let re={toasts:[]};function G(a){re=Ct(re,a),ae.forEach(t=>{t(re)})}function St({...a}){const t=wt(),s=n=>G({type:"UPDATE_TOAST",toast:{...n,id:t}}),o=()=>G({type:"DISMISS_TOAST",toastId:t});return G({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:n=>{n||o()}}}),{id:t,dismiss:o,update:s}}function kt(){const[a,t]=l.useState(re);return l.useEffect(()=>(ae.push(t),()=>{const s=ae.indexOf(t);s>-1&&ae.splice(s,1)}),[a]),{...a,toast:St,dismiss:s=>G({type:"DISMISS_TOAST",toastId:s})}}const At=Ns,ns=l.forwardRef(({className:a,...t},s)=>e.jsx(Ie,{ref:s,className:P("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...t}));ns.displayName=Ie.displayName;const Dt=mt("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),is=l.forwardRef(({className:a,variant:t,...s},o)=>e.jsx(Me,{ref:o,className:P(Dt({variant:t}),a),...s}));is.displayName=Me.displayName;const It=l.forwardRef(({className:a,...t},s)=>e.jsx(Pe,{ref:s,className:P("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",a),...t}));It.displayName=Pe.displayName;const ls=l.forwardRef(({className:a,...t},s)=>e.jsx(Le,{ref:s,className:P("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...t,children:e.jsx(Te,{className:"h-4 w-4"})}));ls.displayName=Le.displayName;const os=l.forwardRef(({className:a,...t},s)=>e.jsx(Ee,{ref:s,className:P("text-sm font-semibold",a),...t}));os.displayName=Ee.displayName;const cs=l.forwardRef(({className:a,...t},s)=>e.jsx(Fe,{ref:s,className:P("text-sm opacity-90",a),...t}));cs.displayName=Fe.displayName;function Mt(){const{toasts:a}=kt();return e.jsxs(At,{children:[a.map(function({id:t,title:s,description:o,action:n,...c}){return e.jsxs(is,{...c,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(os,{children:s}),o&&e.jsx(cs,{children:o})]}),n,e.jsx(ls,{})]},t)}),e.jsx(ns,{})]})}const Pt=({...a})=>{const{theme:t="system"}=ws();return e.jsx(Cs,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...a})},Lt=Ss,Tt=l.forwardRef(({className:a,sideOffset:t=4,...s},o)=>e.jsx(Oe,{ref:o,sideOffset:t,className:P("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s}));Tt.displayName=Oe.displayName;function Et(){const a=R();return l.useEffect(()=>{const t=setTimeout(()=>{a("/home")},4e3);return()=>clearTimeout(t)},[a]),e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-white",children:e.jsx("div",{className:"relative w-full max-w-md aspect-square mx-auto",children:e.jsx("img",{src:"media/splash.gif",alt:"Loading...",className:"w-full h-full object-contain"})})})}function De(){var b;const a=R(),t=Z(),[s,o]=l.useState(""),[n,c]=l.useState(""),[d,m]=l.useState(!1),[g,x]=l.useState(!1),p=((b=t.state)==null?void 0:b.returnTo)||"/home",j=f=>{f.preventDefault(),x(!0),setTimeout(()=>{const A=N.getUsers().find(M=>M.username===s&&M.password===n);A?(N.setCurrentUser(A),B.success(`Welcome back, ${A.fullName}!`),A.role==="admin"?a("/admin"):a(p)):B.error("Invalid username or password"),x(!1)},500)};return e.jsx("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-6 animate-slide-left-fade",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:oe,alt:"Discover Mount Kenya",className:"h-24 w-auto mx-auto mb-4 object-contain"}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Discover Mount Kenya"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Sign in to continue"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"username",children:"Username"}),e.jsx(T,{id:"username",type:"text",placeholder:"Enter your username",value:s,onChange:f=>o(f.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{id:"password",type:d?"text":"password",placeholder:"Enter your password",value:n,onChange:f=>c(f.target.value),required:!0,className:"pr-10"}),e.jsx("button",{type:"button",onClick:()=>m(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:d?e.jsx(Ke,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsx(S,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground h-12 font-semibold",disabled:g,children:g?"Logging in...":"Login"})]}),e.jsxs(S,{type:"button",onClick:()=>a("/home"),variant:"outline",className:"w-full h-12 font-semibold border-2 border-purple-300 hover:border-purple-400 bg-purple-50 hover:bg-purple-100 text-purple-700",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Return to Home"]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(O,{to:"/create-account",className:"text-primary font-medium hover:underline",children:"Create Account"})]})})]})})}function Ft(){var g;const a=R(),t=Z(),[s,o]=l.useState(!1),n=((g=t.state)==null?void 0:g.returnTo)||"/home",[c,d]=l.useState({fullName:"",password:"",phone:"",location:""}),m=x=>{x.preventDefault();const p=N.getUsers(),j={id:Date.now().toString(),username:c.fullName.split(" ")[0],password:c.password,fullName:c.fullName,phone:c.phone,location:c.location,role:"user"};p.push(j),N.saveUsers(p),N.setCurrentUser(j),B.success("Account created successfully!"),a(n)};return e.jsx("div",{className:"min-h-screen bg-background animate-slide-left-fade",children:e.jsxs("div",{className:"max-w-md mx-auto p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:oe,alt:"Discover Mount Kenya",className:"h-20 w-auto mx-auto mb-4 object-contain"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Join Discover Mount Kenya"})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"fullName",children:"Full Name"}),e.jsx(T,{id:"fullName",type:"text",placeholder:"Enter your full name",value:c.fullName,onChange:x=>d({...c,fullName:x.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{id:"password",type:s?"text":"password",placeholder:"Create a password",value:c.password,onChange:x=>d({...c,password:x.target.value}),required:!0,className:"pr-10"}),e.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:s?e.jsx(Ke,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"phone",children:"Phone Number"}),e.jsx(T,{id:"phone",type:"tel",placeholder:"+254700000000",value:c.phone,onChange:x=>d({...c,phone:x.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"location",children:"Delivery Location"}),e.jsxs(V,{value:c.location,onValueChange:x=>d({...c,location:x}),required:!0,children:[e.jsx(H,{children:e.jsx(Q,{placeholder:"Select your location"})}),e.jsxs(Y,{children:[e.jsx(h,{value:"CBD",children:"CBD"}),e.jsx(h,{value:"Mukima",children:"Mukima"}),e.jsx(h,{value:"Baraka",children:"Baraka"}),e.jsx(h,{value:"Mugambi",children:"Mugambi"}),e.jsx(h,{value:"Katheri",children:"Katheri"}),e.jsx(h,{value:"MKWE",children:"MKWE"}),e.jsx(h,{value:"Likii",children:"Likii"}),e.jsx(h,{value:"Makutano",children:"Makutano"}),e.jsx(h,{value:"Airstrip",children:"Airstrip"})]})]})]}),e.jsx(S,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 h-12 font-semibold",children:"Create Account"})]}),e.jsxs("div",{className:"space-y-3 mt-6",children:[e.jsxs(S,{type:"button",onClick:()=>a("/login"),variant:"outline",className:"w-full h-12 font-semibold border-2 border-blue-300 hover:border-blue-400 bg-blue-50 hover:bg-blue-100 text-blue-700",children:[e.jsx(ks,{className:"w-5 h-5 mr-2"}),"Back to Login"]}),e.jsxs(S,{type:"button",onClick:()=>a("/home"),variant:"outline",className:"w-full h-12 font-semibold border-2 border-purple-300 hover:border-purple-400 bg-purple-50 hover:bg-purple-100 text-purple-700",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Return to Home"]})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-4",children:["Already have an account?"," ",e.jsx(O,{to:"/login",className:"text-primary font-medium hover:underline",children:"Sign in"})]})]})})}const Ot=Ds,Kt=As,ds=l.forwardRef(({className:a,...t},s)=>e.jsx(Be,{className:P("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:s}));ds.displayName=Be.displayName;const ms=l.forwardRef(({className:a,...t},s)=>e.jsxs(Kt,{children:[e.jsx(ds,{}),e.jsx(Re,{ref:s,className:P("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));ms.displayName=Re.displayName;const us=({className:a,...t})=>e.jsx("div",{className:P("flex flex-col space-y-2 text-center sm:text-left",a),...t});us.displayName="AlertDialogHeader";const xs=({className:a,...t})=>e.jsx("div",{className:P("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});xs.displayName="AlertDialogFooter";const hs=l.forwardRef(({className:a,...t},s)=>e.jsx($e,{ref:s,className:P("text-lg font-semibold",a),...t}));hs.displayName=$e.displayName;const ps=l.forwardRef(({className:a,...t},s)=>e.jsx(qe,{ref:s,className:P("text-sm text-muted-foreground",a),...t}));ps.displayName=qe.displayName;const gs=l.forwardRef(({className:a,...t},s)=>e.jsx(ze,{ref:s,className:P(Ze(),a),...t}));gs.displayName=ze.displayName;const fs=l.forwardRef(({className:a,...t},s)=>e.jsx(Ue,{ref:s,className:P(Ze({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));fs.displayName=Ue.displayName;function js({open:a,onConfirm:t,onCancel:s}){return e.jsx(Ot,{open:a,onOpenChange:o=>!o&&s(),children:e.jsxs(ms,{className:"max-w-md border-2 border-primary/20",children:[e.jsxs(us,{children:[e.jsx("div",{className:"mx-auto bg-primary/10 p-4 rounded-full mb-4 w-fit",children:e.jsx(Is,{className:"w-12 h-12 text-primary"})}),e.jsx(hs,{className:"text-2xl text-center font-bold text-primary",children:"Age Verification Required"}),e.jsxs(ps,{className:"text-center text-base mt-2",children:["You must be 18 years or older to enter the Beverages section.",e.jsx("br",{}),e.jsx("br",{}),"Are you 18 years of age or older?"]})]}),e.jsxs(xs,{className:"sm:justify-center gap-4 mt-4",children:[e.jsx(fs,{onClick:s,className:"w-full sm:w-auto min-w-[120px]",children:"No, I'm under 18"}),e.jsx(gs,{onClick:t,className:"w-full sm:w-auto min-w-[120px] bg-primary hover:bg-primary/90",children:"Yes, I'm 18+"})]})]})})}function U(){const a=[{to:"/home",icon:ee,label:"Home"},{to:"/categories",icon:Ps,label:"Categories"},{to:"/settings",icon:_e,label:"About Us"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50 safe-area-bottom",children:e.jsx("div",{className:"flex items-center justify-around h-16 max-w-lg mx-auto px-2",children:a.map(({to:t,icon:s,label:o})=>e.jsxs(Ms,{to:t,className:({isActive:n})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${n?"text-primary":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(s,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:o})]},t))})})}function $(){const[a,t]=l.useState(N.getCurrentUser());return l.useEffect(()=>{const s=setInterval(()=>{const o=N.getCurrentUser();t(o)},500);return()=>clearInterval(s)},[]),l.useEffect(()=>{const s=N.getCurrentUser();t(s)},[]),l.useEffect(()=>{const s=()=>{const n=N.getCurrentUser();t(n)},o=()=>{t(null)};return window.addEventListener("storage",s),window.addEventListener("focus",s),window.addEventListener("userLogout",o),()=>{window.removeEventListener("storage",s),window.removeEventListener("focus",s),window.removeEventListener("userLogout",o)}},[]),e.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-40",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center justify-between",children:e.jsx(O,{to:"/home",className:"cursor-pointer",children:e.jsx("img",{src:oe,alt:"Discover Mount Kenya",className:"h-10 w-auto object-contain"})})})},(a==null?void 0:a.id)||"no-user")}function be({className:a="",type:t="home"}){const[s,o]=l.useState(!0),[n,c]=l.useState(!1),d="https://raw.githubusercontent.com/Vairal77/discovermtkenya/main/public/media",[m,g]=l.useState(`${d}/${t}hero.jpg`),[x,p]=l.useState(!1);return l.useEffect(()=>{const j=new Image;j.src=m,j.onload=()=>{o(!1),c(!1)},j.onerror=()=>{x?(console.error(`Failed to load hero image fallback: ${m}`),o(!1),c(!0)):(console.warn(`Failed to load GitHub image, falling back to local: ${m}`),p(!0),g(`media/${t}hero.jpg`))}},[m,x,t]),e.jsxs("div",{className:`rounded-2xl overflow-hidden shadow-card bg-muted relative ${a}`,style:{aspectRatio:"16/9"},children:[s&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 dark:bg-zinc-800 flex items-center justify-center z-10",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8 animate-spin text-green-600"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Loading experience..."})]})}),n?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-zinc-100 dark:bg-zinc-900",children:e.jsx("p",{className:"text-sm text-zinc-500",children:"Discover Mt Kenya"})}):e.jsx("img",{src:m,alt:`${t} advertisement`,className:"w-full h-full object-cover transition-opacity duration-500",style:{opacity:s?0:1}})]})}function Bt(){const[a,t]=l.useState(N.getCurrentUser()),[s,o]=l.useState(!1),n=We(),{data:c=[],isLoading:d,error:m}=ne({queryKey:["partners","promoted","home"],queryFn:()=>F.getPromoted(10),staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:i=>Math.min(1e3*2**i,1e4)}),g=l.useMemo(()=>[...c].sort(()=>Math.random()-.5).slice(0,2),[c]);l.useEffect(()=>{let i=null;const y=F.onChanges(()=>{i&&clearTimeout(i),i=setTimeout(()=>{n.invalidateQueries({queryKey:["partners","promoted","home"]})},1500)});return()=>{i&&clearTimeout(i),y()}},[n]),l.useEffect(()=>{if(a){const i=N.getOrders().filter(y=>y.userId===a.id&&y.status==="delivered"&&!y.rated);o(i.length>0)}},[a]);const x=[{name:"Accommodation",icon:ee,color:"text-primary",link:"/category/accommodation"},{name:"Food",icon:fe,color:"text-destructive",link:"/category/restaurants"},{name:"Beverages",icon:Ve,color:"text-accent",link:"/category/beverages"},{name:"Activities",icon:ie,color:"text-success",link:"/category/activities"},{name:"Attractions",icon:He,color:"text-purple-500",link:"/category/attractions"},{name:"Shop",icon:je,color:"text-orange-500",link:"/category/shop"}],p=R(),[j,b]=l.useState(!1),[f,k]=l.useState(null),A=async(i,y,r)=>{if(i.preventDefault(),y==="Beverages"){k(r),b(!0);return}if(y==="Food")try{const v=await F.getByCategory("restaurants",{pageSize:1});if(v&&v.length>0){p(`/business/${v[0].id}`);return}}catch(v){console.error(`Failed to fetch ${y} partner:`,v)}p(r)},M=async()=>{b(!1);try{const i=await F.getByCategory("beverages",{pageSize:1});i&&i.length>0?p(`/business/${i[0].id}`):f&&p(f)}catch(i){console.error("Failed to fetch Beverages partner:",i),f&&p(f)}k(null)};return e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-fade-in-up",children:[e.jsx($,{}),e.jsx(js,{open:j,onConfirm:M,onCancel:()=>{b(!1),k(null)}}),s&&a&&e.jsx("div",{className:"max-w-lg mx-auto px-4 py-2",children:e.jsx(O,{to:"/orders",className:"block",children:e.jsxs("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-3 flex items-center gap-3 hover:bg-yellow-200 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-500 text-white rounded-full flex items-center justify-center",children:e.jsx(Ls,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Rate Your Orders"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"You have delivered orders waiting for your review"})]})]})})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsx(be,{type:"home"}),!d&&g.length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Featured"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:g.map(i=>e.jsxs(O,{to:`/business/${i.id}`,className:"bg-card rounded-xl overflow-hidden shadow-card hover:shadow-hover transition-shadow",children:[e.jsx(q,{src:Array.isArray(i.image)?i.image[0]:i.image,alt:i.name,className:"w-full h-32 object-cover",loading:"lazy"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:i.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:i.category}),e.jsxs("p",{className:"text-xs text-primary font-medium mt-1",children:["â­ ",i.rating]})]})]},i.id))})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Categories"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:x.map(i=>{const y=i.icon,r={Accommodation:"from-primary via-primary/90 to-primary/80",Food:"from-red-500 via-red-400 to-red-300",Beverages:"from-blue-500 via-blue-400 to-blue-300",Activities:"from-green-500 via-green-400 to-green-300",Attractions:"from-purple-500 via-purple-400 to-purple-300",Shop:"from-orange-500 via-orange-400 to-orange-300"}[i.name]||"from-gray-500 via-gray-400 to-gray-300";return e.jsxs("a",{href:i.link,onClick:v=>A(v,i.name,i.link),className:`bg-gradient-to-br ${r} rounded-xl p-6 shadow-lg hover:shadow-xl transition-all hover:scale-105 border-2 border-white/20 block cursor-pointer`,children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-3 text-white drop-shadow-lg"}),e.jsx("p",{className:"text-center font-bold text-sm text-white drop-shadow-md",children:i.name})]},i.name)})})]})]}),e.jsx(U,{})]})}function Rt(){const a=R(),[t,s]=l.useState(""),[o,n]=l.useState(!1),[c,d]=l.useState(null),m=We(),{data:g=[],isLoading:x,isFetching:p}=ne({queryKey:["partners","categories"],queryFn:()=>F.getAll(),staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:r=>Math.min(1e3*2**r,1e4)}),{data:j=[],isLoading:b}=ne({queryKey:["partners","promoted","categories"],queryFn:()=>F.getPromoted(10),staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:r=>Math.min(1e3*2**r,1e4)}),f=l.useMemo(()=>[...j].sort(()=>Math.random()-.5).slice(0,2),[j]);l.useEffect(()=>{let r=null;const v=F.onChanges(()=>{r&&clearTimeout(r),r=setTimeout(()=>{m.invalidateQueries({queryKey:["partners","categories"]}),m.invalidateQueries({queryKey:["partners","promoted","categories"]})},1500)});return()=>{r&&clearTimeout(r),v()}},[m]);const k=[{name:"Accommodation",icon:ee,color:"from-primary via-primary/90 to-primary/80",path:"/category/accommodation"},{name:"Food",icon:fe,color:"from-red-500 via-red-400 to-red-300",path:"/category/restaurants"},{name:"Beverages",icon:Ve,color:"from-blue-500 via-blue-400 to-blue-300",path:"/category/beverages"},{name:"Activities",icon:ie,color:"from-green-500 via-green-400 to-green-300",path:"/category/activities"},{name:"Attractions",icon:He,color:"from-purple-500 via-purple-400 to-purple-300",path:"/category/attractions"},{name:"Shop",icon:je,color:"from-orange-500 via-orange-400 to-orange-300",path:"/category/shop"}],A=t===""?[]:g.filter(r=>r.name.toLowerCase().includes(t.toLowerCase())||r.description.toLowerCase().includes(t.toLowerCase())||r.category.toLowerCase().includes(t.toLowerCase())),M=r=>({Accommodation:"https://images.unsplash.com/photo-1578683010236-d716f9a3f461?w=800",Food:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800",Beverages:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=800",Activities:"https://images.unsplash.com/photo-1544367563-12123d83141b?w=800",Attractions:"https://images.unsplash.com/photo-1516426122078-c23e76319801?w=800",Shop:"https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800"})[r]||"https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=800",i=async(r,v,K)=>{if(r.preventDefault(),v==="Beverages"){d(K),n(!0);return}if(v==="Food")try{const C=await F.getByCategory("restaurants",{pageSize:1});if(C&&C.length>0){a(`/business/${C[0].id}`);return}}catch(C){console.error(`Failed to fetch ${v} partner:`,C)}a(K)},y=async()=>{n(!1);try{const r=await F.getByCategory("beverages",{pageSize:1});r&&r.length>0?a(`/business/${r[0].id}`):c&&a(c)}catch(r){console.error("Failed to fetch Beverages partner:",r),c&&a(c)}d(null)};return e.jsxs("div",{className:"relative min-h-screen bg-background pb-20 animate-fade-in-up",children:[e.jsx($,{}),e.jsx(js,{open:o,onConfirm:y,onCancel:()=>{n(!1),d(null)}}),e.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search categories, businesses, items...",value:t,onChange:r=>s(r.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-2 space-y-6",children:[e.jsx(be,{type:"categories"}),f.length>0&&t===""&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Featured"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.map(r=>e.jsxs(O,{to:`/business/${r.id}`,className:"bg-card rounded-xl overflow-hidden shadow-card hover:shadow-hover transition-shadow",children:[e.jsx(q,{src:Array.isArray(r.image)?r.image[0]:r.image,alt:r.name,className:"w-full h-32 object-cover",loading:"lazy"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:r.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:r.category}),e.jsxs("p",{className:"text-xs text-primary font-medium mt-1",children:["â­ ",r.rating]})]})]},r.id))})]}),t!==""&&e.jsxs("section",{children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Search Results (",A.length,")"]}),A.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',t,'"']})]}):e.jsx("div",{className:"space-y-4",children:A.map(r=>e.jsxs(O,{to:`/business/${r.id}`,className:"block bg-card rounded-xl overflow-hidden shadow-card hover:shadow-hover transition-shadow",children:[e.jsx(q,{src:Array.isArray(r.image)?r.image[0]:r.image,alt:r.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:r.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-2",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-4 h-4 text-primary fill-primary"}),r.rating]}),e.jsx("span",{className:"capitalize",children:r.category})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]},r.id))})]}),t===""&&k.map(r=>e.jsxs("a",{href:r.path,onClick:v=>i(v,r.name,r.path),className:"block relative bg-card rounded-xl overflow-hidden shadow-card hover:shadow-hover transition-all hover:scale-[1.02] cursor-pointer",children:[e.jsx(q,{src:M(r.name),alt:r.name,className:"w-full h-48 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:r.name}),e.jsx("p",{className:"text-sm text-white/90",children:r.name==="Food"?"Explore meal options":`Explore ${r.name.toLowerCase()} options`})]})]},r.name))]}),e.jsx(U,{})]})}function $t(){const{category:a}=ve();R();const[t,s]=l.useState(""),[o,n]=l.useState("all"),[c,d]=l.useState(1),{data:m=[],isLoading:g,error:x,isFetching:p}=ne({queryKey:["partners","category",a,{propertyType:o,page:c}],queryFn:()=>a?F.getByCategory(a,{propertyType:o,page:c,pageSize:10}):[],enabled:!!a,staleTime:1e3*60,gcTime:1e3*300,retry:3,retryDelay:i=>Math.min(1e3*2**i,1e4),refetchOnMount:!0,placeholderData:i=>i}),[j,b]=l.useState([]);l.useEffect(()=>{b([]),d(1)},[a,o]),l.useEffect(()=>{Array.isArray(m)&&m.length>0?b(i=>{const y=new Map;return[...i,...m].forEach(r=>y.set(r.id,r)),Array.from(y.values())}):!p&&c===1&&j.length===0&&b([])},[m]);const f=i=>i.category==="accommodation"?i.pricePerNight?`KES ${i.pricePerNight.toLocaleString()}/night`:"KES price pending":i.category==="activities"?i.pricePerPerson?`KES ${i.pricePerPerson.toLocaleString()}/person`:"KES price pending":"KES menu pricing",k=l.useMemo(()=>{const i=t.trim().toLowerCase();return i===""?j:j.filter(y=>{var r;return y.name.toLowerCase().includes(i)||((r=y.description)==null?void 0:r.toLowerCase().includes(i))})},[j,t]),M=(i=>i==="restaurants"?"Food Delivery":i==null?void 0:i.replace("-"," ").replace(/\b\w/g,y=>y.toUpperCase()))(a||"");return g&&k.length,e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-slide-left-fade",children:[e.jsx($,{}),e.jsx("div",{className:"max-w-lg mx-auto px-4 py-4 space-y-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{placeholder:`Search in ${M}...`,value:t,onChange:i=>s(i.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-4",children:[g&&k.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading partners..."})]}),x&&!g&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ts,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsx("p",{className:"text-sm font-semibold mb-2",children:"Failed to load partners"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:x instanceof Error?x.message:"Connection error"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm",children:"Retry"})]}),k.map(i=>e.jsxs(O,{to:`/business/${i.id}`,className:"block bg-card rounded-2xl overflow-hidden shadow-card hover:shadow-hover transition-shadow",children:[e.jsx(q,{src:Array.isArray(i.image)?i.image[0]:i.image,alt:i.name,className:"w-full h-48 object-cover",loading:"lazy"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:i.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-2 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-4 h-4 text-primary fill-primary"}),i.rating]}),i.category==="accommodation"&&i.propertyType&&e.jsx("span",{className:"px-2 py-0.5 bg-primary/10 text-primary rounded-full font-medium",children:i.propertyType}),e.jsx("span",{className:"capitalize",children:i.category}),e.jsx("span",{children:f(i)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:i.description}),e.jsxs("div",{className:"inline-flex items-center gap-2 text-primary font-medium",children:[e.jsx(W,{className:"w-4 h-4"}),i.category==="accommodation"?"View Property":i.category==="activities"?"View Activity":i.category==="restaurant"||i.category==="beverage"?"View Menu":"View Details"]})]})]},i.id)),!g&&k.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:t||o&&o!=="all"?"No properties found matching your search criteria.":"No partners found in this category."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-4",children:[(t||o&&o!=="all")&&e.jsx("button",{onClick:()=>{s(""),n("all")},className:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 text-sm font-medium transition-colors",children:"Clear Filters"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm font-medium shadow-lg hover:shadow-xl transition-all",children:"Refresh Page"})]})]}),k.length>0&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx("button",{onClick:()=>d(i=>i+1),disabled:p,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 text-sm disabled:opacity-50",children:p?"Loading...":"Load more"})})]}),e.jsx(U,{})]})}function qt({message:a="Loading...",fullscreen:t=!0,className:s}){return e.jsx("div",{className:P("z-50 flex items-center justify-center bg-background/90 text-center text-sm text-muted-foreground backdrop-blur",t?"fixed inset-0":"absolute inset-0",s),children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(ge,{className:"h-6 w-6 animate-spin text-primary"}),e.jsx("p",{className:"font-medium text-foreground/80",children:a})]})})}function zt(){var C,L;const{id:a}=ve(),t=R(),[s,o]=l.useState(null),[n,c]=l.useState(0),[d,m]=l.useState([]),[g,x]=l.useState(""),p=l.useMemo(()=>d.filter(u=>u.name.toLowerCase().includes(g.toLowerCase())||u.description.toLowerCase().includes(g.toLowerCase())),[d,g]),[j,b]=l.useState(!0),[f,k]=l.useState([]);l.useEffect(()=>{const u=async(E=!0)=>{if(!a){E&&b(!1);return}try{E&&b(!0);const _=await F.getById(a);if(_){o(_);const ys=await ut.getByPartner_id(a);m(ys)}}catch(_){console.error("Failed to load partner:",_)}finally{E&&b(!1)}};u(!0),console.log("ðŸ”” Setting up real-time subscription on BusinessPage...");const w=F.onChanges(async(E,_)=>{console.log("ðŸ”” Real-time change detected on BusinessPage:",_,E),E.id===a&&(console.log("ðŸ”” Reloading partner details..."),await u(!1))});return()=>{console.log("ðŸ”” Unsubscribing from partner changes on BusinessPage..."),w()}},[a]),l.useEffect(()=>{s&&s.category&&(async()=>{const u=await F.getSimilar(s.category,s.id,2);k(u)})()},[s]);const A=l.useMemo(()=>d.length===0?null:d.reduce((w,E)=>w+(E.price||0),0)/d.length,[d]),M=async u=>{if(!s)return;const w=s.category==="accommodation"?s.pricePerNight??null:s.category==="activities"?s.pricePerPerson??null:(s.category==="restaurant"||s.category==="beverage")&&A?A:null;await xt.logInteraction({partnerId:s.id,partnerCategory:s.category,actionType:s.category==="restaurant"||s.category==="beverage"?"order_call":s.category==="activities"?"activity_call":"book_call",actionSource:u,estimatedValue:w,deviceType:/Mobi|Android/i.test(navigator.userAgent)?"mobile":"desktop",metadata:{partnerName:s.name}})},i=async(u,w)=>{await M(w),window.location.href=`tel:${u}`},y=u=>({"Swimming Pool":Os,Activities:Ks,"Delivery Services":z,"Amazing Views":W,"Spacious Living":Bs,Bathtub:Rs,"Serene Location":ie})[u]||W,r=u=>({"Self Catering":Se,WiFi:$s,Toiletries:qs,"Coffee/Tea Station":Ce,"Chef's Kitchen":Se,"Smart TV":zs})[u]||W;if(j)return e.jsxs("div",{className:"relative min-h-screen bg-background",children:[e.jsx($,{}),e.jsx(qt,{message:"Loading partner details..."})]});if(!s&&!j)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Partner not found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The partner you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>t(-1),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90",children:"Go Back"})]})});const v=Array.isArray(s.image)?s.image:[s.image],K=N.getReviews().filter(u=>u.partnerId===s.id&&u.approved);return e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-slide-left-fade",children:[e.jsx($,{}),e.jsxs("header",{className:"relative",children:[e.jsx("button",{onClick:()=>t(-1),className:"absolute top-4 left-4 z-10 w-10 h-10 bg-white/90 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(Es,{className:"w-5 h-5"})}),v.length>0&&e.jsx(q,{src:v[n],alt:s.name,className:"w-full h-64 object-cover"}),v.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:v.map((u,w)=>e.jsx("button",{onClick:()=>c(w),className:`w-2 h-2 rounded-full ${n===w?"bg-white":"bg-white/50"}`},w))})]}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 -mt-8 relative z-10",children:[e.jsxs("div",{className:"bg-card rounded-2xl p-6 shadow-card",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:s.name==="DMK Flavor Dash"?"Food":s.name==="DMK Sip Central"?"Beverages":s.name}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:s.description}),s.category!=="restaurant"&&s.category!=="beverage"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(X,{className:"w-4 h-4 text-primary fill-primary"}),e.jsx("span",{className:"font-medium",children:s.rating}),e.jsxs("span",{className:"text-muted-foreground",children:["(",K.length," reviews)"]})]})]}),s.category==="accommodation"&&e.jsxs("div",{className:"space-y-4 mt-6",children:[v.length>1&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.slice(0,4).map((u,w)=>e.jsx(q,{src:u,alt:`${s.name} ${w+1}`,className:"w-full h-32 object-cover rounded-xl",onClick:()=>c(w)},w))}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-card grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-semibold",children:s.bedrooms||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Guests"}),e.jsx("p",{className:"font-semibold",children:s.guests||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"}),e.jsx("p",{className:"font-semibold text-sm",children:s.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price"}),e.jsxs("p",{className:"font-semibold",children:["KES ",((C=s.pricePerNight)==null?void 0:C.toLocaleString())||"N/A","/night"]})]})]})]}),s.features&&s.features.length>0&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-card",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Features"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.features.map((u,w)=>{const E=y(u);return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"w-4 h-4 text-primary"}),e.jsx("span",{children:u})]},w)})})]}),s.amenities&&s.amenities.length>0&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-card",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Amenities"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.amenities.map((u,w)=>{const E=r(u);return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"w-4 h-4 text-primary"}),e.jsx("span",{children:u})]},w)})})]}),e.jsxs(S,{onClick:()=>i(s.phone,"business_page"),className:"w-full bg-primary hover:bg-primary/90 text-white text-lg py-6",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Book Now"]})]}),s.category==="activities"&&e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-card space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Activity Type"}),e.jsx("p",{className:"font-semibold",children:s.activityType||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Capacity"}),e.jsxs("p",{className:"font-semibold",children:[s.numberOfPAX||"N/A"," PAX"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"}),e.jsx("p",{className:"font-semibold text-sm",children:s.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price"}),e.jsxs("p",{className:"font-semibold",children:["KES ",((L=s.pricePerPerson)==null?void 0:L.toLocaleString())||"N/A","/person"]})]})]})]}),e.jsxs(S,{onClick:()=>i(s.phone,"business_page"),className:"w-full bg-primary hover:bg-primary/90 text-white text-lg py-6",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Book Now"]})]}),(s.category==="restaurant"||s.category==="beverage")&&e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(T,{type:"text",placeholder:"Search menu items...",value:g,onChange:u=>x(u.target.value),className:"pl-10 bg-card border-border/50"})]}),p.length>0?e.jsx(we.div,{className:"space-y-4",initial:"hidden",animate:"show",variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},children:p.map(u=>e.jsxs(we.div,{variants:{hidden:{opacity:0,x:-20},show:{opacity:1,x:0}},className:"bg-card rounded-xl overflow-hidden shadow-sm border border-border/50 flex",children:[e.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 flex-shrink-0",children:u.image?e.jsx(q,{src:u.image,alt:u.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-muted/30 flex items-center justify-center",children:e.jsx(Ce,{className:"w-8 h-8 text-muted-foreground/30"})})}),e.jsxs("div",{className:"p-3 flex-1 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-semibold text-base line-clamp-1",children:u.name}),e.jsxs("span",{className:"font-bold text-primary text-sm whitespace-nowrap ml-2",children:["KES ",u.price.toLocaleString()]})]}),u.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:u.description})]})]},u.id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsxs("p",{children:['No menu items found matching "',g,'"']})}),e.jsxs(S,{onClick:()=>i(s.phone,"business_page"),className:"w-full bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 text-white text-lg py-6 shadow-lg shadow-primary/20 rounded-xl transition-all duration-300 transform hover:scale-[1.02]",children:[e.jsx(z,{className:"w-5 h-5 mr-2 animate-pulse"}),"Call to Order"]})]}),f.length>0&&e.jsxs("section",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Similar Partners"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.map(u=>e.jsxs(O,{to:`/business/${u.id}`,className:"bg-card rounded-xl overflow-hidden shadow-card hover:shadow-hover transition-shadow",children:[e.jsx(q,{src:Array.isArray(u.image)?u.image[0]:u.image,alt:u.name,className:"w-full h-32 object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:u.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:u.category}),e.jsxs("p",{className:"text-xs text-primary font-medium mt-1",children:["â­ ",u.rating]})]})]},u.id))})]})]}),e.jsx(U,{})]})}function Ut(){const a=R(),[t,s]=l.useState([]),[o,n]=l.useState("CBD"),[c,d]=l.useState([]),[m,g]=l.useState(!1),x=N.getCurrentUser();l.useEffect(()=>{const r=()=>{s(N.getCart());const C=N.getOrders().filter(L=>L.userId===(x==null?void 0:x.id));d(C.sort((L,u)=>new Date(u.timestamp).getTime()-new Date(L.timestamp).getTime()))};r();const v=setInterval(r,2e3);return()=>clearInterval(v)},[x]);const p=(r,v)=>{const K=t.map(C=>{if(C.menuItem.id===r){const L=Math.max(1,C.quantity+v);return{...C,quantity:L}}return C});s(K),N.saveCart(K)},j=r=>{const v=t.filter(K=>K.menuItem.id!==r);s(v),N.saveCart(v),B.success("Item removed from cart")},b={CBD:70,Mukima:100,Baraka:150,Mugambi:120,Katheri:200,MKWE:200,Likii:70,Makutano:100,Airstrip:250},f=t.reduce((r,v)=>r+v.menuItem.price*v.quantity,0),k=b[o]||70,A=f+k,M=()=>{if(t.length===0){B.error("Your cart is empty");return}if(!x){B.error("Please login to continue with your order"),a("/login",{state:{returnTo:"/cart"}});return}a("/checkout")},i=r=>({placed:"bg-info text-info-foreground",confirming:"bg-warning text-warning-foreground",preparing:"bg-primary text-primary-foreground",dispatched:"bg-accent text-accent-foreground",nearby:"bg-success text-success-foreground",delivered:"bg-success text-success-foreground"})[r]||"bg-muted text-muted-foreground",y=r=>({placed:"Placed",confirming:"Confirming",preparing:"Preparing",dispatched:"On the Way",nearby:"Nearby",delivered:"Delivered"})[r];return e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-slide-left-fade",children:[e.jsx($,{}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6",children:[e.jsx(be,{className:"mb-6"}),m?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"My Orders"}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Qe,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No orders yet"}),e.jsx(O,{to:"/home",className:"inline-block px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:"Start Shopping"})]}):e.jsx("div",{className:"space-y-4",children:c.map(r=>e.jsxs(O,{to:`/order-tracking/${r.id}`,className:"block bg-card rounded-xl p-4 shadow-card hover:shadow-hover transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["Order #",r.id]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[new Date(r.timestamp).toLocaleDateString()," at"," ",new Date(r.timestamp).toLocaleTimeString()]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i(r.status)}`,children:y(r.status)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.items.length," items"]}),e.jsxs("p",{className:"font-semibold text-primary",children:["KES ",r.total]})]}),e.jsx(Ye,{className:"w-5 h-5 text-muted-foreground"})]})]},r.id))})]}):t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your cart is empty"}),e.jsx(O,{to:"/home",children:e.jsx(S,{className:"bg-primary hover:bg-primary/90",children:"Start Shopping"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:t.map(r=>e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-card",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:r.menuItem.image,alt:r.menuItem.name,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-1",children:r.menuItem.name}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["KES ",r.menuItem.price]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-muted rounded-lg",children:[e.jsx("button",{onClick:()=>p(r.menuItem.id,-1),className:"p-2 hover:bg-muted-foreground/10 rounded-lg",children:e.jsx(Us,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-medium w-8 text-center",children:r.quantity}),e.jsx("button",{onClick:()=>p(r.menuItem.id,1),className:"p-2 hover:bg-muted-foreground/10 rounded-lg",children:e.jsx(_s,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:()=>j(r.menuItem.id),className:"ml-auto text-destructive hover:bg-destructive/10 p-2 rounded-lg",children:e.jsx(Ws,{className:"w-4 h-4"})})]})]})]})},r.menuItem.id))}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Delivery Location"}),e.jsxs(V,{value:o,onValueChange:n,children:[e.jsx(H,{children:e.jsx(Q,{})}),e.jsxs(Y,{children:[e.jsx(h,{value:"CBD",children:"CBD"}),e.jsx(h,{value:"Mukima",children:"Mukima"}),e.jsx(h,{value:"Baraka",children:"Baraka"}),e.jsx(h,{value:"Mugambi",children:"Mugambi"}),e.jsx(h,{value:"Katheri",children:"Katheri"}),e.jsx(h,{value:"MKWE",children:"MKWE"}),e.jsx(h,{value:"Likii",children:"Likii"}),e.jsx(h,{value:"Makutano",children:"Makutano"}),e.jsx(h,{value:"Airstrip",children:"Airstrip"})]})]})]}),e.jsxs("div",{className:"border-t border-border pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["KES ",f]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery Fee"}),e.jsxs("span",{className:"font-medium",children:["KES ",k]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t border-border",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-primary",children:["KES ",A]})]})]}),e.jsx(O,{to:"/home",className:"block",children:e.jsxs(S,{variant:"outline",className:"w-full h-12 mb-3 flex items-center justify-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"Continue Shopping"]})}),e.jsxs(S,{onClick:M,className:"w-full bg-primary hover:bg-primary/90 h-12",children:["Checkout - KES ",A]})]})]})]}),e.jsx(U,{})]})}const vs=l.forwardRef(({className:a,...t},s)=>e.jsx(Ge,{className:P("grid gap-2",a),...t,ref:s}));vs.displayName=Ge.displayName;const pe=l.forwardRef(({className:a,...t},s)=>e.jsx(Xe,{ref:s,className:P("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:e.jsx(Vs,{className:"flex items-center justify-center",children:e.jsx(Hs,{className:"h-2.5 w-2.5 fill-current text-current"})})}));pe.displayName=Xe.displayName;function _t({open:a,onOpenChange:t,partnerName:s,onRate:o}){const[n,c]=l.useState(0),[d,m]=l.useState(""),g=()=>{n>0&&(o(n,d),c(0),m(""),t(!1))},x=b=>b<n?e.jsx(X,{className:"w-8 h-8 text-yellow-500 fill-yellow-500"}):e.jsx(X,{className:"w-8 h-8 text-gray-300"}),p=()=>{switch(n){case 1:return"Poor experience";case 2:return"Below average";case 3:return"Average";case 4:return"Good experience";case 5:return"Excellent!";default:return"How was your experience?"}},j=()=>{switch(n){case 1:return"ðŸ˜ž";case 2:return"ðŸ˜";case 3:return"ðŸ™‚";case 4:return"ðŸ˜Š";case 5:return"ðŸ¤©";default:return"â­"}};return e.jsx(es,{open:a,onOpenChange:t,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(ts,{children:e.jsx(as,{className:"text-center",children:"Rate Your Experience"})}),e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"How was your order experience?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(b=>e.jsx("button",{onClick:()=>c(b),className:"transition-transform hover:scale-110",children:x(b)},b))}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:j()}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:p()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Leave a comment (optional)"}),e.jsx(rs,{value:d,onChange:b=>m(b.target.value),placeholder:"Tell us about your experience...",className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:g,disabled:n===0,className:"flex-1 bg-primary hover:bg-primary/90",children:[e.jsx(Qs,{className:"w-4 h-4 mr-2"}),"Submit Rating"]}),e.jsx(S,{variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Skip"})]})]})]})})}function Wt(){const a=R(),t=N.getCurrentUser(),s=N.getCart(),[o,n]=l.useState("MPESA"),[c,d]=l.useState((t==null?void 0:t.location)||"CBD"),[m,g]=l.useState((t==null?void 0:t.fullName)||""),[x,p]=l.useState((t==null?void 0:t.phone)||""),[j,b]=l.useState(!1),[f,k]=l.useState(null),A={CBD:70,Mukima:100,Baraka:150,Mugambi:120,Katheri:200,MKWE:200,Likii:70,Makutano:100,Airstrip:250},M=s.reduce((C,L)=>C+L.menuItem.price*L.quantity,0),i=A[c]||70,y=M+i,r=C=>{var w,E;C.preventDefault();const L=N.getOrders(),u={id:`ORD${Date.now()}`,userId:(t==null?void 0:t.id)||"guest",partnerId:((w=s[0])==null?void 0:w.menuItem.partnerId)||"",partnerName:v(((E=s[0])==null?void 0:E.menuItem.partnerId)||""),items:[...s],total:y,deliveryFee:i,deliveryLocation:c,paymentMethod:o,status:"placed",timestamp:new Date().toISOString(),customerName:m,customerPhone:x};L.push(u),N.saveOrders(L),N.saveCart([]),k(u),b(!0),B.success("Order placed successfully!")},v=C=>{var u;return((u=N.getPartners().find(w=>w.id===C))==null?void 0:u.name)||"Unknown Partner"},K=(C,L)=>{if(f){const u=N.getReviews(),w={id:`REV${Date.now()}`,userId:(t==null?void 0:t.id)||"guest",userName:(t==null?void 0:t.fullName)||"Guest",partnerId:f.partnerId,orderId:f.id,rating:C,comment:L,approved:!1,createdAt:new Date().toISOString()};u.push(w),N.saveReviews(u),B.success("Thank you for your feedback!")}a(`/order-tracking/${f==null?void 0:f.id}`)};return e.jsxs("div",{className:"min-h-screen bg-background animate-slide-left-fade",children:[e.jsx($,{}),e.jsx("div",{className:"max-w-lg mx-auto px-4 py-6",children:e.jsxs("form",{onSubmit:r,className:"space-y-6",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Delivery Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"name",children:"Full Name"}),e.jsx(T,{id:"name",value:m,onChange:C=>g(C.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"phone",children:"Phone Number"}),e.jsx(T,{id:"phone",type:"tel",value:x,onChange:C=>p(C.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"location",children:"Delivery Location"}),e.jsxs(V,{value:c,onValueChange:d,required:!0,children:[e.jsx(H,{children:e.jsx(Q,{})}),e.jsxs(Y,{children:[e.jsx(h,{value:"CBD",children:"CBD"}),e.jsx(h,{value:"Mukima",children:"Mukima"}),e.jsx(h,{value:"Baraka",children:"Baraka"}),e.jsx(h,{value:"Mugambi",children:"Mugambi"}),e.jsx(h,{value:"Katheri",children:"Katheri"}),e.jsx(h,{value:"MKWE",children:"MKWE"}),e.jsx(h,{value:"Likii",children:"Likii"}),e.jsx(h,{value:"Makutano",children:"Makutano"}),e.jsx(h,{value:"Airstrip",children:"Airstrip"})]})]})]})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Payment Method"}),e.jsxs(vs,{value:o,onValueChange:n,children:[e.jsxs("div",{className:"flex items-center space-x-2 p-4 border border-border rounded-lg cursor-pointer hover:bg-muted",children:[e.jsx(pe,{value:"MPESA",id:"mpesa"}),e.jsxs(D,{htmlFor:"mpesa",className:"flex-1 cursor-pointer",children:[e.jsx("div",{className:"font-medium",children:"MPESA"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pay via MPESA mobile money"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-4 border border-border rounded-lg cursor-pointer hover:bg-muted",children:[e.jsx(pe,{value:"Card",id:"card"}),e.jsxs(D,{htmlFor:"card",className:"flex-1 cursor-pointer",children:[e.jsx("div",{className:"font-medium",children:"Card Payment"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pay with debit/credit card"})]})]})]})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{children:["KES ",M]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery Fee"}),e.jsxs("span",{children:["KES ",i]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-3 border-t border-border",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-primary",children:["KES ",y]})]})]})]}),e.jsxs(S,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 h-12 text-lg",children:["Place Order - KES ",y]})]})}),e.jsx(_t,{open:j,onOpenChange:b,partnerName:(f==null?void 0:f.partnerName)||"",onRate:K})]})}function Vt({locations:a,selectedLocation:t,onLocationSelect:s,showRiderTracking:o=!1,riderLocation:n,estimatedDelivery:c}){const[d]=l.useState({lat:-.02,lng:37.0739}),[m,g]=l.useState(null),x=p=>{g(p),s(p)};return e.jsxs("div",{className:"w-full h-96 bg-gradient-to-br from-blue-50 to-green-50 rounded-xl border-2 border-blue-200 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-400/20 to-blue-400/20",children:e.jsx("div",{className:"absolute inset-0 opacity-30"})}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),e.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs font-medium text-gray-700 bg-white px-2 py-1 rounded shadow",children:"Nanyuki Center"})]}),a.map((p,j)=>{const b=50+(p.coordinates.lng-d.lng)*1e3,f=50+(p.coordinates.lat-d.lat)*1e3;return e.jsxs("div",{className:"absolute cursor-pointer transform -translate-x-1/2 -translate-y-1/2",style:{left:`${Math.max(10,Math.min(90,b))}%`,top:`${Math.max(10,Math.min(90,f))}%`},onClick:()=>x(p),children:[e.jsx("div",{className:`w-8 h-8 rounded-full border-2 border-white shadow-lg flex items-center justify-center transition-all duration-200 ${t===p.id?"bg-primary scale-110":"bg-blue-500 hover:bg-blue-600"}`,children:e.jsx(J,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:`absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-xs font-medium bg-white px-2 py-1 rounded shadow whitespace-nowrap ${t===p.id?"text-primary":"text-gray-700"}`,children:p.name})]},p.id)}),o&&n&&e.jsxs("div",{className:"absolute cursor-pointer transform -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{left:`${50+(n.lng-d.lng)*1e3}%`,top:`${50+(n.lat-d.lat)*1e3}%`},children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-xs font-medium bg-orange-100 text-orange-800 px-2 py-1 rounded shadow",children:"Rider"})]}),e.jsx("div",{className:"absolute top-4 right-4 flex flex-col gap-2",children:e.jsx(S,{size:"sm",variant:"secondary",className:"bg-white/90 backdrop-blur-sm",children:e.jsx(he,{className:"w-4 h-4"})})}),m&&e.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:e.jsx(se,{className:"bg-white/95 backdrop-blur-sm",children:e.jsx(te,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:m.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Delivery Fee: KES ",m.fee]})]}),c&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:c})]})]})})})}),e.jsx("div",{className:"absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-2 rounded-lg shadow",children:e.jsx("div",{className:"text-xs font-medium text-gray-700",children:"Service Area: 15km radius"})})]})}const xe=a=>({CBD:{lat:-.02,lng:37.0739},Mukima:{lat:-.025,lng:37.08},Baraka:{lat:-.015,lng:37.06},Mugambi:{lat:-.03,lng:37.07},Katheri:{lat:-.01,lng:37.09},MKWE:{lat:-.035,lng:37.055},Likii:{lat:-.02,lng:37.065},Makutano:{lat:-.025,lng:37.075},Airstrip:{lat:-.018,lng:37.078}})[a]||{lat:-.02,lng:37.0739};function Ht({orderId:a,customerLocation:t,estimatedDelivery:s}){const[o,n]=l.useState(null),[c,d]=l.useState("picked_up");l.useEffect(()=>{const x={id:"rider1",name:"John Kamau",phone:"+254720123456",location:xe("CBD"),status:"picked_up"};n(x);const p=setInterval(()=>{n(j=>{if(!j)return null;const b=xe(t),f=j.location,k=f.lat+(b.lat-f.lat)*.1,A=f.lng+(b.lng-f.lng)*.1,M=k-b.lat,i=A-b.lng,y=Math.sqrt(M*M+i*i);let r=j.status;return y<.005?r="arrived":y<.01?r="nearby":y<.02&&(r="on_the_way"),d(r),{...j,location:{lat:k,lng:A},status:r}})},3e3);return()=>clearInterval(p)},[t]);const m=x=>{switch(x){case"picked_up":return"Your order has been picked up and is on the way!";case"on_the_way":return"Your rider is on the way to your location";case"nearby":return"Your rider is nearby and will arrive shortly";case"arrived":return"Your rider has arrived at your location";default:return"Tracking your order..."}},g=x=>{switch(x){case"picked_up":return"text-blue-600 bg-blue-100";case"on_the_way":return"text-yellow-600 bg-yellow-100";case"nearby":return"text-orange-600 bg-orange-100";case"arrived":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(se,{className:"shadow-lg",children:[e.jsx(ce,{children:e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-primary"}),"Order Tracking - #",a]})}),e.jsxs(te,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${g(c)}`,children:c.replace("_"," ").toUpperCase()}),e.jsx(Je,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m(c)}),e.jsxs("div",{className:"flex items-center gap-4 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:o.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:o.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delivery Partner"})]})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsxs(S,{size:"sm",variant:"outline",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Call"]}),e.jsxs(S,{size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"w-4 h-4 mr-2"}),"Message"]})]})]})]})]}),e.jsxs(se,{className:"shadow-lg",children:[e.jsx(ce,{children:e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),"Live Tracking"]})}),e.jsx(te,{children:e.jsx(Vt,{locations:[{id:t,name:t,fee:0,coordinates:xe(t)}],selectedLocation:t,onLocationSelect:()=>{},showRiderTracking:!0,riderLocation:o.location,estimatedDelivery:s})})]}),e.jsxs(se,{className:"shadow-lg",children:[e.jsx(ce,{children:e.jsx(de,{children:"Delivery Instructions"})}),e.jsx(te,{children:e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsx("p",{children:"â€¢ Please ensure someone is available to receive the order"}),e.jsx("p",{children:"â€¢ Have your payment ready if paying on delivery"}),e.jsx("p",{children:"â€¢ Contact the rider directly if you need to provide additional directions"}),e.jsxs("p",{children:["â€¢ Your order will be delivered to: ",e.jsx("strong",{children:t})]})]})})]})]}):e.jsx("div",{className:"w-full h-64 bg-muted rounded-xl flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading rider information..."})})}function Qt(){const{id:a}=ve(),t=R(),[s,o]=l.useState(null);if(l.useEffect(()=>{const d=()=>{const x=N.getOrders().find(p=>p.id===a);x&&o(x)};d();const m=setInterval(d,2e3);return()=>clearInterval(m)},[a]),!s)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("p",{children:"Order not found"})});const n=[{status:"placed",label:"Placed",icon:Qe,color:"bg-blue-500"},{status:"preparing",label:"Preparing",icon:fe,color:"bg-yellow-500"},{status:"dispatched",label:"On the Way",icon:Xs,color:"bg-orange-500"},{status:"delivered",label:"Delivered",icon:Js,color:"bg-green-500"}],c=n.findIndex(d=>d.status===s.status);return e.jsxs("div",{className:"min-h-screen bg-background animate-slide-left-fade",children:[e.jsx($,{}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card mb-6",children:[e.jsx("div",{className:"flex justify-between mb-8",children:n.map((d,m)=>{const g=m<=c,x=d.icon;return e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-2 transition-colors ${g?`${d.color} text-white`:"bg-gray-300 text-gray-500"}`,children:e.jsx(x,{className:"w-6 h-6"})}),e.jsx("span",{className:`text-xs font-medium text-center ${g?"text-gray-800":"text-gray-500"}`,children:d.label}),m<n.length-1&&e.jsx("div",{className:`absolute h-0.5 w-1/4 top-6 ${g?"bg-primary":"bg-muted"}`,style:{left:`${(m+.5)*25}%`}})]},d.status)})}),s.status!=="delivered"&&e.jsxs("div",{className:"bg-muted rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Estimated delivery"}),e.jsx("p",{className:"text-xl font-bold text-primary",children:"30-45 minutes"})]})]}),(s.status==="dispatched"||s.status==="nearby")&&e.jsx("div",{className:"mb-6",children:e.jsx(Ht,{orderId:s.id,customerLocation:s.deliveryLocation,estimatedDelivery:"15-20 minutes"})}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Order Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order ID"}),e.jsx("span",{className:"font-medium",children:s.id})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date & Time"}),e.jsxs("span",{className:"font-medium",children:[new Date(s.timestamp).toLocaleDateString()," at"," ",new Date(s.timestamp).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery Location"}),e.jsx("span",{className:"font-medium",children:s.deliveryLocation})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Method"}),e.jsx("span",{className:"font-medium",children:s.paymentMethod})]}),e.jsxs("div",{className:"border-t border-border pt-3",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{children:["KES ",s.total-s.deliveryFee]})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery Fee"}),e.jsxs("span",{children:["KES ",s.deliveryFee]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-primary",children:["KES ",s.total]})]})]})]})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card mt-6",children:[e.jsxs("h2",{className:"font-semibold text-lg mb-4",children:["Items (",s.items.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.items.map((d,m)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[d.quantity,"x ",d.menuItem.name]}),e.jsxs("span",{className:"font-medium",children:["KES ",d.menuItem.price*d.quantity]})]},m))})]}),e.jsxs(S,{onClick:()=>t("/cart"),className:"w-full mt-6 bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center gap-2 h-12 font-medium",children:[e.jsx(Gs,{className:"w-5 h-5"}),"Back to Orders"]})]})]})}function Yt({open:a,onOpenChange:t,user:s,onSave:o}){const[n,c]=l.useState({id:"",username:"",password:"",fullName:"",phone:"",location:"",role:"user",profileImage:""});l.useEffect(()=>{s&&c(s)},[s,a]);const d=m=>{m.preventDefault(),o(n),t(!1)};return e.jsx(es,{open:a,onOpenChange:t,children:e.jsxs(ss,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ts,{children:e.jsx(as,{children:"Edit Profile"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(D,{htmlFor:"profileImage",className:"text-base font-medium",children:"Profile Image"}),e.jsx("div",{className:"w-full",children:e.jsx(ht,{value:n.profileImage||"",onChange:m=>c({...n,profileImage:m}),placeholder:"Choose Profile Image",className:"w-full h-32 bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors"})})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"fullName",children:"Full Name"}),e.jsx(T,{id:"fullName",value:n.fullName,onChange:m=>c({...n,fullName:m.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"username",children:"Username"}),e.jsx(T,{id:"username",value:n.username,onChange:m=>c({...n,username:m.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"phone",children:"Phone"}),e.jsx(T,{id:"phone",value:n.phone,onChange:m=>c({...n,phone:m.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"location",children:"Default Location"}),e.jsxs(V,{value:n.location,onValueChange:m=>c({...n,location:m}),children:[e.jsx(H,{children:e.jsx(Q,{})}),e.jsxs(Y,{children:[e.jsx(h,{value:"CBD",children:"CBD"}),e.jsx(h,{value:"Mukima",children:"Mukima"}),e.jsx(h,{value:"Baraka",children:"Baraka"}),e.jsx(h,{value:"Mugambi",children:"Mugambi"}),e.jsx(h,{value:"Katheri",children:"Katheri"}),e.jsx(h,{value:"MKWE",children:"MKWE"}),e.jsx(h,{value:"Likii",children:"Likii"}),e.jsx(h,{value:"Makutano",children:"Makutano"}),e.jsx(h,{value:"Airstrip",children:"Airstrip"})]})]})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"password",children:"New Password (Optional)"}),e.jsx(T,{id:"password",type:"password",value:n.password,onChange:m=>c({...n,password:m.target.value}),placeholder:"Leave blank to keep current password"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{type:"submit",className:"flex-1",children:"Save Changes"}),e.jsx(S,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancel"})]})]})]})})}function Gt(){const a=R(),t=N.getCurrentUser(),[s,o]=l.useState(!1),n=()=>{N.setCurrentUser(null),window.dispatchEvent(new CustomEvent("userLogout")),B.success("Logged out successfully"),a("/home")},c=d=>{const g=N.getUsers().map(x=>x.id===d.id?d:x);N.saveUsers(g),N.setCurrentUser(d),B.success("Profile updated successfully")};return t?e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-slide-left-fade",children:[e.jsx($,{}),e.jsx("header",{className:"bg-gradient-hero text-white",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-full mx-auto mb-4 flex items-center justify-center overflow-hidden",children:t.profileImage?e.jsx("img",{src:t.profileImage,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(ke,{className:"w-10 h-10 text-primary"})}),e.jsx("h1",{className:"text-2xl font-bold mb-1",children:t.fullName}),e.jsxs("p",{className:"text-white/90",children:["@",t.username]}),e.jsxs(S,{onClick:()=>o(!0),variant:"outline",size:"sm",className:"mt-4 bg-white/10 border-white/20 text-white hover:bg-white/20",children:[e.jsx(Zs,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})]})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-4",children:[e.jsx("h2",{className:"font-semibold text-lg mb-4",children:"Account Information"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-muted rounded-full flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"font-medium",children:t.fullName})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-muted rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:t.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-muted rounded-full flex items-center justify-center",children:e.jsx(J,{className:"w-5 h-5 text-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Default Location"}),e.jsx("p",{className:"font-medium",children:t.location})]})]})]}),t.role==="admin"&&e.jsxs("button",{onClick:()=>a("/admin"),className:"w-full bg-card rounded-xl p-4 shadow-card hover:shadow-hover transition-shadow flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Admin Panel"}),e.jsx(Ye,{className:"w-5 h-5 text-muted-foreground"})]}),e.jsxs(S,{onClick:n,variant:"destructive",className:"w-full h-12 text-base",children:[e.jsx(et,{className:"w-5 h-5 mr-2"}),"Logout"]}),e.jsx("div",{className:"text-center pt-4",children:e.jsx("img",{src:oe,alt:"Discover Mount Kenya",className:"h-16 w-auto mx-auto mb-2 opacity-50 object-contain"})})]}),e.jsx(Yt,{open:s,onOpenChange:o,user:t,onSave:c}),e.jsx(U,{})]}):(a("/login"),null)}function Xt({show:a=!1}){return a?e.jsxs("div",{className:"text-center py-8 mb-4 text-xs text-muted-foreground border-t border-zinc-100 dark:border-zinc-800 mx-4",children:["Developed by"," ",e.jsx("a",{href:"https://vairal.co.ke",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:"Vairal Media"})]}):null}function Jt(){const[a,t]=l.useState({name:"",organizationType:"",location:"",phone:"",message:""}),s=n=>{n.preventDefault();const c=`
*New Business Inquiry - Discover Mount Kenya*

*Name:* ${a.name}
*Organization Type:* ${a.organizationType}
*Location:* ${a.location}
*Phone:* ${a.phone}

*Message:*
${a.message}

---
_This inquiry was submitted through the Discover Mount Kenya app._
    `.trim(),d=`https://wa.me/254756253477?text=${encodeURIComponent(c)}`;window.open(d,"_blank"),t({name:"",organizationType:"",location:"",phone:"",message:""}),B.success("WhatsApp opened. Please send your inquiry.")},o=()=>{window.location.href="tel:+254711672672"};return e.jsxs("div",{className:"min-h-screen bg-background pb-20 animate-slide-left-fade",children:[e.jsx($,{}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary rounded-xl flex items-center justify-center",children:e.jsx(_e,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Discover Mount Kenya"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mount Kenya's Premier Destination"})]})]}),e.jsx("p",{className:"text-zinc-600 dark:text-zinc-300 leading-relaxed text-sm mt-2",children:"Mount Kenya is not meant to be discovered randomly. Most visitors experience fragments. Good places hidden behind poor discovery. Exceptional service buried under noise. Quality diluted by volume."}),e.jsx("p",{className:"text-zinc-600 dark:text-zinc-300 leading-relaxed text-sm mt-3",children:"Discover Mount Kenya exists to change that. This is a private concierge, built for travellers and residents who value taste, trust, and discretion. Every stay, wellness service, activity, meal, and gift is selected with intent. Partners are vetted. Standards are non-negotiable."}),e.jsxs(S,{onClick:o,className:"w-full bg-primary hover:bg-primary/90 text-white mt-4",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Contact Us"]})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-xl flex items-center justify-center",children:e.jsx(st,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Partner With Us"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Feature your Business"})]})]}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"name",className:"text-sm",children:"Your Name *"}),e.jsx(T,{id:"name",value:a.name,onChange:n=>t({...a,name:n.target.value}),required:!0,placeholder:"Enter your full name",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"organizationType",className:"text-sm",children:"Type of Organization *"}),e.jsxs(V,{value:a.organizationType,onValueChange:n=>t({...a,organizationType:n}),children:[e.jsx(H,{className:"text-sm",children:e.jsx(Q,{placeholder:"Select organization type"})}),e.jsxs(Y,{children:[e.jsx(h,{value:"Accommodation",children:"Accommodation"}),e.jsx(h,{value:"Restaurant",children:"Restaurant"}),e.jsx(h,{value:"Beverage Outlet",children:"Beverage Outlet"}),e.jsx(h,{value:"Activities",children:"Activities"}),e.jsx(h,{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"location",className:"text-sm",children:"County *"}),e.jsxs(V,{value:a.location,onValueChange:n=>t({...a,location:n}),children:[e.jsx(H,{className:"text-sm",children:e.jsx(Q,{placeholder:"Select county"})}),e.jsxs(Y,{children:[e.jsx(h,{value:"Nyeri County",children:"Nyeri County"}),e.jsx(h,{value:"Laikipia County",children:"Laikipia County"}),e.jsx(h,{value:"Meru County",children:"Meru County"}),e.jsx(h,{value:"Isiolo County",children:"Isiolo County"}),e.jsx(h,{value:"Kirinyaga County",children:"Kirinyaga County"}),e.jsx(h,{value:"Embu County",children:"Embu County"})]})]})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"phone",className:"text-sm",children:"Contact Phone *"}),e.jsx(T,{id:"phone",type:"tel",value:a.phone,onChange:n=>t({...a,phone:n.target.value}),required:!0,placeholder:"Enter your phone number",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"message",className:"text-sm",children:"Additional Details"}),e.jsx(rs,{id:"message",value:a.message,onChange:n=>t({...a,message:n.target.value}),placeholder:"Tell us more about your business and partnership interests...",rows:4,className:"text-sm"})]}),e.jsxs(S,{type:"submit",className:"w-full bg-primary hover:bg-primary/90 text-white",children:[e.jsx(tt,{className:"w-4 h-4 mr-2"}),"Send Inquiry"]})]})]})]}),e.jsx(Xt,{show:!0}),e.jsx(U,{})]})}const Zt=()=>{const a=Z();return l.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",a.pathname)},[a.pathname]),e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),e.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Return to Home"})]})})},ea=()=>{const[a,t]=l.useState(null),[s,o]=l.useState(!1),[n,c]=l.useState(!1);return l.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches?(c(!0),!0):!1)return;const g=()=>{"serviceWorker"in navigator&&document.querySelector('link[rel="manifest"]')&&o(!0)},x=j=>{j.preventDefault(),t(j),o(!0)},p=()=>{c(!0),o(!1),t(null)};return g(),window.addEventListener("beforeinstallprompt",x),window.addEventListener("appinstalled",p),()=>{window.removeEventListener("beforeinstallprompt",x),window.removeEventListener("appinstalled",p)}},[]),{isInstallable:s,isInstalled:n,installApp:async()=>{if(a)try{await a.prompt();const{outcome:m}=await a.userChoice;if(m==="accepted")return c(!0),o(!1),t(null),!0}catch(m){console.error("Error installing PWA:",m)}else try{if("serviceWorker"in navigator&&"PushManager"in window){const m=await navigator.serviceWorker.getRegistration();m&&await m.update()}}catch(m){console.error("Error with installation:",m)}return!1}}};function sa(){const{isInstallable:a,isInstalled:t,installApp:s}=ea(),o=Z(),[n,c]=l.useState(!1);if(o.pathname.includes("admin")||o.pathname.includes("dmk-login-admin"))return null;const d=async()=>{await s()&&B.success("App installed successfully!")},m=()=>{c(!0)};return!a||t||n?null:e.jsx("div",{id:"pwa-install-prompt",className:"fixed bottom-20 left-4 right-4 z-50 animate-in slide-in-from-bottom-5 duration-500",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md dark:bg-slate-900/95 border border-primary/20 shadow-xl rounded-2xl p-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Install App"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add to home screen for better experience"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{onClick:d,size:"sm",className:"bg-primary hover:bg-primary/90 text-white shadow-lg",children:[e.jsx(at,{className:"w-4 h-4 mr-2"}),"Install Now"]}),e.jsxs(S,{onClick:m,variant:"ghost",size:"sm",className:"text-muted-foreground hover:bg-black/5 whitespace-nowrap",children:[e.jsx(Te,{className:"w-4 h-4 mr-1"}),"Not Now"]})]})]})})}const bs=async()=>{if("serviceWorker"in navigator)try{const a=await navigator.serviceWorker.register("/discovermtkenya/sw.js");return console.log("Service Worker registered successfully:",a),a.addEventListener("updatefound",()=>{const t=a.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&console.log("New update available")})}),a}catch(a){console.error("Service Worker registration failed:",a)}},ta=new rt({defaultOptions:{queries:{staleTime:1e3*60,gcTime:1e3*300,retry:3,retryDelay:a=>Math.min(1e3*2**a,1e4),refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,networkMode:"online"},mutations:{retry:1,retryDelay:1e3}}}),aa=()=>{const a=Z();return e.jsx(lt,{mode:"wait",children:e.jsxs(ot,{location:a,children:[e.jsx(I,{path:"/",element:e.jsx(ct,{to:"/splash",replace:!0})}),e.jsx(I,{path:"/splash",element:e.jsx(Et,{})}),e.jsx(I,{path:"/login",element:e.jsx(De,{})}),e.jsx(I,{path:"/dmk-login-admin",element:e.jsx(De,{})}),e.jsx(I,{path:"/create-account",element:e.jsx(Ft,{})}),e.jsx(I,{path:"/home",element:e.jsx(Bt,{})}),e.jsx(I,{path:"/categories",element:e.jsx(Rt,{})}),e.jsx(I,{path:"/category/:category",element:e.jsx($t,{})}),e.jsx(I,{path:"/business/:id",element:e.jsx(zt,{})}),e.jsx(I,{path:"/cart",element:e.jsx(Ut,{})}),e.jsx(I,{path:"/checkout",element:e.jsx(Wt,{})}),e.jsx(I,{path:"/order-tracking/:id",element:e.jsx(Qt,{})}),e.jsx(I,{path:"/profile",element:e.jsx(Gt,{})}),e.jsx(I,{path:"/settings",element:e.jsx(Jt,{})}),e.jsx(I,{path:"/admin",element:e.jsx(pt,{})}),e.jsx(I,{path:"/admin/partners",element:e.jsx(gt,{})}),e.jsx(I,{path:"/admin/menus",element:e.jsx(ft,{})}),e.jsx(I,{path:"/admin/users",element:e.jsx(jt,{})}),e.jsx(I,{path:"/admin/reviews",element:e.jsx(vt,{})}),e.jsx(I,{path:"/admin/analytics",element:e.jsx(bt,{})}),e.jsx(I,{path:"*",element:e.jsx(Zt,{})})]},a.pathname)})},ra=()=>(l.useEffect(()=>{bs(),(async()=>{try{const t=await fetch("https://raw.githubusercontent.com/Vairal77/discovermtkenya/main/public/version.json");if(t.ok){const s=await t.json(),o=localStorage.getItem("dmk_app_version");o&&o!==s.version?(console.log("DMK: New version detected, updating assets..."),localStorage.setItem("dmk_app_version",s.version)):o||localStorage.setItem("dmk_app_version",s.version)}}catch{console.log("DMK: Update check failed (offline or GitHub unreachable)")}})()},[]),e.jsx(nt,{client:ta,children:e.jsxs(Lt,{children:[e.jsx(Mt,{}),e.jsx(Pt,{}),e.jsxs(it,{basename:"/discovermtkenya",children:[e.jsx(aa,{}),e.jsx(sa,{})]})]})}));bs();dt(document.getElementById("root")).render(e.jsx(ra,{}));
