import{r as c,j as e,S as Or,R as rr,T as tr,I as Ur,C as ar,a as sr,b as zr,c as nr,P as Vr,d as ir,V as Kr,L as or,e as lr,f as Hr,g as Qr,h as Jr,i as cr,k as Wr,l as Gr,m as J,n as dr,u as v,O as mr,o as ur,p as Xr,X as pr,q as gr,D as hr,s as Yr,t as Zr,U as et,v as rt,w as tt,x as Ge,y as at,z as st,A as xr,M as nt,B as it,E as fr,F as Me,G as ot,H as lt,J as ct,K as dt,N as Ie,Q as yr,W as Be,Y as de,Z as br,_ as vr,$ as jr,a0 as wr,a1 as qe,a2 as ue,a3 as mt,a4 as ut,a5 as ze,a6 as Ne,a7 as te,a8 as _e,a9 as Ve,aa as pe,ab as Ke,ac as xe,ad as Nr,ae as pt,af as gt,ag as we}from"./vendor-react-CDZkADAp.js";import{t as ht,c as xt,a as He,f as Sr,p as ft,b as yt}from"./vendor-utils-D77wr3qA.js";import{c as bt}from"./vendor-supabase--HCFugiW.js";function F(...r){return ht(xt(r))}const vt=He("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=c.forwardRef(({className:r,variant:t,size:a,asChild:n=!1,...s},i)=>{const o=n?Or:"button";return e.jsx(o,{className:F(vt({variant:t,size:a,className:r})),ref:i,...s})});E.displayName="Button";const I=c.forwardRef(({className:r,type:t,...a},n)=>e.jsx("input",{type:t,className:F("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:n,...a}));I.displayName="Input";const jt=He("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),P=c.forwardRef(({className:r,...t},a)=>e.jsx(rr,{ref:a,className:F(jt(),r),...t}));P.displayName=rr.displayName;class wt{getItem(t,a){const n=localStorage.getItem(t);return n?JSON.parse(n):a}setItem(t,a){localStorage.setItem(t,JSON.stringify(a))}getUsers(){return this.getItem("users",this.getDefaultUsers())}saveUsers(t){this.setItem("users",t)}getCurrentUser(){return this.getItem("currentUser",null)}setCurrentUser(t){this.setItem("currentUser",t)}getPartners(){return this.getItem("partners",this.getDefaultPartners())}savePartners(t){this.setItem("partners",t)}getMenuItems(){return this.getItem("menuItems",this.getDefaultMenuItems())}saveMenuItems(t){this.setItem("menuItems",t)}getCart(){return this.getItem("cart",[])}saveCart(t){this.setItem("cart",t)}addToCart(t){const a=this.getCart(),n=a.find(s=>s.menuItem.id===t.id);n?n.quantity+=1:a.push({menuItem:t,quantity:1}),this.saveCart(a)}getOrders(){return this.getItem("orders",[])}saveOrders(t){this.setItem("orders",t)}getRiders(){return this.getItem("riders",this.getDefaultRiders())}saveRiders(t){this.setItem("riders",t)}getReviews(){return this.getItem("reviews",[])}saveReviews(t){this.setItem("reviews",t)}getDeliveryLocations(){return this.getItem("deliveryLocations",[])}saveDeliveryLocations(t){this.setItem("deliveryLocations",t)}getDefaultUsers(){return[{id:"1",username:"Douglas",password:"1234",fullName:"Douglas Mwangi",phone:"+254700000000",location:"CBD",role:"user"},{id:"2",username:"admin",password:"Aud3r3f@c3r3",fullName:"Administrator",phone:"+254711672672",location:"CBD",role:"admin"}]}getDefaultPartners(){return[{id:"r1",name:"The Nanyuki Bistro",category:"restaurant",description:"Fine dining with a local twist. Experience authentic Kenyan cuisine with modern presentation.",location:"Nanyuki CBD",address:"Kenyatta Avenue, Nanyuki Town",phone:"+254720111222",rating:4.8,image:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800",promoted:!0},{id:"r2",name:"Mount Kenya Grill",category:"restaurant",description:"Specializing in grilled meats and nyama choma. Perfect for family gatherings and celebrations.",location:"Nanyuki Outskirts",address:"Nanyuki-Naro Moru Road",phone:"+254720222333",rating:4.6,image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800",promoted:!0},{id:"r3",name:"Savanna Bites",category:"restaurant",description:"Fast casual dining with burgers, pizzas, and local favorites. Quick delivery guaranteed.",location:"Close to CBD",address:"Market Street, Near Equity Bank",phone:"+254720333444",rating:4.5,image:"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=800",promoted:!1},{id:"r4",name:"Taste of Nanyuki",category:"restaurant",description:"Traditional Kikuyu dishes and contemporary fusion cuisine. Home-style cooking at its best.",location:"Nanyuki CBD",address:"Kenyatta Highway",phone:"+254720444555",rating:4.7,image:"https://images.unsplash.com/photo-1552566626-52f8b828add9?w=800",promoted:!0},{id:"r5",name:"Safari Restaurant",category:"restaurant",description:"International cuisine with stunning views of Mount Kenya. Premium dining experience.",location:"Nanyuki Outskirts",address:"Laikipia Road, Hill View Estate",phone:"+254720555666",rating:4.9,image:"https://images.unsplash.com/photo-1559339352-11d035aa65de?w=800",promoted:!0},{id:"b1",name:"Mount Kenya Beverages Co.",category:"beverage",description:"Fresh juices, craft beers, and specialty drinks. Locally sourced ingredients, naturally refreshing.",location:"Nanyuki CBD",address:"Industrial Area, Warehouse 5",phone:"+254730111222",rating:4.7,image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=800",promoted:!0},{id:"b2",name:"Equator Drinks",category:"beverage",description:"Premium coffee, teas, and smoothies. Perfect for any time of day. Barista-crafted perfection.",location:"Close to CBD",address:"Coffee Plaza, Ground Floor",phone:"+254730222333",rating:4.6,image:"https://images.unsplash.com/photo-1544145945-f90425340c7e?w=800",promoted:!0},{id:"b3",name:"Refresh Nanyuki",category:"beverage",description:"Cold-pressed juices and health drinks. Fresh daily. Wellness in every bottle.",location:"Nanyuki CBD",address:"Health Center Complex",phone:"+254730333444",rating:4.5,image:"https://images.unsplash.com/photo-1600271886742-f049cd451bba?w=800",promoted:!1},{id:"b4",name:"Highland Brews",category:"beverage",description:"Craft coffee roastery and artisan beverages. Single-origin beans roasted to perfection.",location:"Nanyuki Outskirts",address:"Coffee Farm Road",phone:"+254730444555",rating:4.8,image:"https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=800",promoted:!1},{id:"b5",name:"Tropical Thirst",category:"beverage",description:"Exotic fruit juices and mocktails. Non-alcoholic options available. Tropical paradise in a glass.",location:"Close to CBD",address:"Riverside Mall",phone:"+254730555666",rating:4.6,image:"https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=800",promoted:!0},{id:"a1",name:"Mount Kenya Villa",category:"accommodation",description:"Luxurious private villa with stunning views of Mount Kenya. Perfect for families and groups.",location:"Nanyuki",phone:"+254710111222",rating:4.9,image:["https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?w=800","https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=800","https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=800"],promoted:!0,propertyType:"Private Villa",bedrooms:4,guests:8,features:["Swimming Pool","Amazing Views","Spacious Living","Serene Location"],amenities:["Self Catering","WiFi","Toiletries","Smart TV"],pricePerNight:15e3},{id:"a2",name:"Mountain View Cottage",category:"accommodation",description:"Cozy 2-bedroom cottage with modern amenities and mountain views.",location:"Nanyuki",phone:"+254710222333",rating:4.7,image:["https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800","https://images.unsplash.com/photo-1602343168117-bb8ffe3e2e9f?w=800"],promoted:!0,propertyType:"2BR",bedrooms:2,guests:4,features:["Amazing Views","Serene Location"],amenities:["Self Catering","WiFi","Smart TV"],pricePerNight:8e3},{id:"a3",name:"Safari Lodge Suites",category:"accommodation",description:"Premium hotel suites in the heart of Nanyuki with excellent service.",location:"Nanyuki CBD",phone:"+254710333444",rating:4.8,image:["https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800","https://images.unsplash.com/photo-1564501049412-61c2a3083791?w=800","https://images.unsplash.com/photo-1615880484746-a134be9a6ecf?w=800","https://images.unsplash.com/photo-1596394516093-501ba68a0ba6?w=800"],promoted:!1,propertyType:"Hotel",bedrooms:1,guests:2,features:["Activities","Delivery Services","Amazing Views"],amenities:["WiFi","Toiletries","Coffee/Tea Station","Smart TV"],pricePerNight:12e3},{id:"a4",name:"Wilderness Cabin",category:"accommodation",description:"Rustic cabin experience in the wilderness, perfect for nature lovers.",location:"Nanyuki Outskirts",phone:"+254710444555",rating:4.6,image:["https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=800","https://images.unsplash.com/photo-1569740849053-6b8f9106ae31?w=800"],promoted:!0,propertyType:"Cabin",bedrooms:3,guests:6,features:["Activities","Serene Location"],amenities:["Self Catering","WiFi"],pricePerNight:6e3},{id:"a5",name:"Executive Studio",category:"accommodation",description:"Modern studio apartment for short or extended stays.",location:"Nanyuki CBD",phone:"+254710555666",rating:4.5,image:["https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800","https://images.unsplash.com/photo-1556912173-4c24ad06cbfc?w=800"],promoted:!1,propertyType:"Studio",bedrooms:1,guests:2,features:["Bathtub"],amenities:["WiFi","Toiletries","Coffee/Tea Station","Smart TV"],pricePerNight:5e3},{id:"act1",name:"Mount Kenya Sunrise Hike",category:"activities",description:"Experience breathtaking sunrise views from the foothills of Mount Kenya. Suitable for all fitness levels.",location:"Mount Kenya Foothills",phone:"+254720111222",rating:4.8,image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",promoted:!0,activityType:"Hiking",numberOfPAX:10,pricePerPerson:2500},{id:"act2",name:"Coffee Farm Tour",category:"activities",description:"Learn about coffee cultivation and processing on a local farm tour with tasting session.",location:"Coffee Estates",phone:"+254720222333",rating:4.7,image:"https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=800",promoted:!0,activityType:"Farm Tour",numberOfPAX:15,pricePerPerson:1500},{id:"act3",name:"Wildlife Safari Adventure",category:"activities",description:"Full-day safari to see elephants, lions, and other wildlife in their natural habitat.",location:"Laikipia Conservancy",phone:"+254720333444",rating:4.9,image:"https://images.unsplash.com/photo-1516426122078-c23e76319801?w=800",promoted:!0,activityType:"Safari Adventure",numberOfPAX:8,pricePerPerson:5500},{id:"act4",name:"Mountain Bike Safari",category:"activities",description:"Explore the beautiful countryside on guided mountain bike tours.",location:"Nanyuki Area",phone:"+254720444555",rating:4.6,image:"https://images.unsplash.com/photo-1571068316344-75bc76f77890?w=800",promoted:!1,activityType:"Bike Safari",numberOfPAX:12,pricePerPerson:3e3},{id:"act5",name:"Wellness Retreat",category:"activities",description:"Relax and rejuvenate with yoga, meditation, and spa treatments.",location:"Serenity Lodge",phone:"+254720555666",rating:4.8,image:"https://images.unsplash.com/photo-1506126613408-eca07ce68773?w=800",promoted:!1,activityType:"Wellness",numberOfPAX:20,pricePerPerson:4500}]}getDefaultMenuItems(){return[{id:"m1",partner_id:"r1",name:"Grilled Chicken Platter",description:"Served with roasted potatoes and garden salad",price:850,category:"Main Course",image:"https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=400"},{id:"m2",partner_id:"r1",name:"Nyama Choma",description:"Authentic Kenyan grilled meat with ugali and kachumbari",price:950,category:"Main Course",image:"https://images.unsplash.com/photo-1544025162-d76694265947?w=400"},{id:"m3",partner_id:"r1",name:"Tilapia Fry",description:"Fresh from Lake Victoria, served with fries",price:950,category:"Main Course",image:"https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=400"},{id:"m4",partner_id:"r1",name:"Veggie Burger",description:"Plant-based burger with house sauce and fries",price:600,category:"Snacks",image:"https://images.unsplash.com/photo-1520072959219-c595dc870360?w=400"},{id:"m5",partner_id:"r1",name:"Chocolate Lava Cake",description:"Warm chocolate cake with vanilla ice cream",price:450,category:"Desserts",image:"https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=400"},{id:"m6",partner_id:"r1",name:"Beef Stew",description:"Slow-cooked beef with vegetables and rice",price:750,category:"Main Course",image:"https://images.unsplash.com/photo-1574484284002-952d92456975?w=400"},{id:"m7",partner_id:"r2",name:"Mixed Grill Platter",description:"Chicken, beef, and sausages with sides",price:1200,category:"Main Course",image:"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400"},{id:"m8",partner_id:"r2",name:"Pork Ribs",description:"BBQ glazed ribs with coleslaw",price:1100,category:"Main Course",image:"https://images.unsplash.com/photo-1544025162-d76694265947?w=400"},{id:"m9",partner_id:"r2",name:"Grilled Fish",description:"Whole fish grilled to perfection",price:900,category:"Main Course",image:"https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=400"},{id:"m10",partner_id:"r2",name:"Chicken Wings",description:"Spicy wings with ranch dipping sauce",price:550,category:"Snacks",image:"https://images.unsplash.com/photo-1608039829572-78524f79c4c7?w=400"},{id:"m11",partner_id:"r2",name:"Grilled Vegetables",description:"Seasonal vegetables with herb butter",price:450,category:"Sides",image:"https://images.unsplash.com/photo-1540420773420-3366772f4999?w=400"},{id:"m12",partner_id:"r2",name:"Beef Skewers",description:"Marinated beef on skewers",price:800,category:"Main Course",image:"https://images.unsplash.com/photo-1529692236671-f1f6cf9683ba?w=400"},{id:"m13",partner_id:"r3",name:"Classic Burger",description:"Beef patty with cheese, lettuce, tomato",price:650,category:"Burgers",image:"https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400"},{id:"m14",partner_id:"r3",name:"Margherita Pizza",description:"Fresh mozzarella, tomato sauce, basil",price:850,category:"Pizzas",image:"https://images.unsplash.com/photo-1574071318508-1cdbab80d002?w=400"},{id:"m15",partner_id:"r3",name:"Chicken Wrap",description:"Grilled chicken with veggies in tortilla",price:550,category:"Wraps",image:"https://images.unsplash.com/photo-1626700051175-6818013e1d4f?w=400"},{id:"m16",partner_id:"r3",name:"French Fries",description:"Crispy golden fries with ketchup",price:300,category:"Sides",image:"https://images.unsplash.com/photo-1576107232684-1279f390859f?w=400"},{id:"m17",partner_id:"r3",name:"Chicken Nuggets",description:"Crispy nuggets with dipping sauce",price:500,category:"Snacks",image:"https://images.unsplash.com/photo-1562967914-608f82629710?w=400"},{id:"m18",partner_id:"r3",name:"BBQ Chicken Pizza",description:"BBQ sauce, chicken, onions, cheese",price:950,category:"Pizzas",image:"https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=400"},{id:"m19",partner_id:"r4",name:"Mukimo Special",description:"Traditional mashed peas and potatoes with meat",price:650,category:"Traditional",image:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400"},{id:"m20",partner_id:"r4",name:"Githeri Deluxe",description:"Boiled maize and beans with vegetables",price:500,category:"Traditional",image:"https://images.unsplash.com/photo-1604329760661-e71dc83f8f26?w=400"},{id:"m21",partner_id:"r4",name:"Chicken Stir Fry",description:"Wok-fried chicken with vegetables and rice",price:750,category:"Fusion",image:"https://images.unsplash.com/photo-1603360946369-dc9bb6258143?w=400"},{id:"m22",partner_id:"r4",name:"Chapati with Stew",description:"Soft chapati served with beef or chicken stew",price:550,category:"Traditional",image:"https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400"},{id:"m23",partner_id:"r4",name:"Pilau Rice",description:"Spiced rice with tender meat pieces",price:700,category:"Traditional",image:"https://images.unsplash.com/photo-1596797038530-2c107229654b?w=400"},{id:"m24",partner_id:"r4",name:"Samosas (6 pcs)",description:"Crispy pastries with meat or vegetable filling",price:250,category:"Snacks",image:"https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400"},{id:"m25",partner_id:"r5",name:"Steak & Lobster",description:"Premium cut steak with grilled lobster tail",price:2500,category:"Premium",image:"https://images.unsplash.com/photo-1546964124-0cce460f38ef?w=400"},{id:"m26",partner_id:"r5",name:"Lamb Chops",description:"Herb-crusted lamb chops with mint sauce",price:1800,category:"Main Course",image:"https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=400"},{id:"m27",partner_id:"r5",name:"Seafood Paella",description:"Spanish rice with mixed seafood",price:1600,category:"Main Course",image:"https://images.unsplash.com/photo-1534080564583-6be75777b70a?w=400"},{id:"m28",partner_id:"r5",name:"Caesar Salad",description:"Crisp romaine with parmesan and croutons",price:550,category:"Salads",image:"https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400"},{id:"m29",partner_id:"r5",name:"Truffle Risotto",description:"Creamy risotto with truffle oil",price:1400,category:"Main Course",image:"https://images.unsplash.com/photo-1476124369491-f5669c08adda?w=400"},{id:"m30",partner_id:"r5",name:"CrÃ¨me BrÃ»lÃ©e",description:"Classic French custard dessert",price:650,category:"Desserts",image:"https://images.unsplash.com/photo-1470124182917-cc6e71b22ecc?w=400"},{id:"b1m1",partner_id:"b1",name:"Fresh Mango Juice 500ml",description:"Pure mango juice, no added sugar",price:150,category:"Juices",image:"https://images.unsplash.com/photo-1600271886742-f049cd451bba?w=400"},{id:"b1m2",partner_id:"b1",name:"Craft Beer Pint",description:"Locally brewed craft beer",price:400,category:"Alcoholic",image:"https://images.unsplash.com/photo-1535958636474-b021ee887b13?w=400"},{id:"b1m3",partner_id:"b1",name:"Mineral Water 1L",description:"Natural spring water",price:100,category:"Water",image:"https://images.unsplash.com/photo-1548839140-29a749e1cf4d?w=400"},{id:"b1m4",partner_id:"b1",name:"Passion Smoothie",description:"Passion fruit blended with yogurt",price:250,category:"Smoothies",image:"https://images.unsplash.com/photo-1505252585461-04db1eb84625?w=400"},{id:"b1m5",partner_id:"b1",name:"Energy Drink",description:"Boost your energy naturally",price:200,category:"Energy",image:"https://images.unsplash.com/photo-1622543925917-763c34d1a86e?w=400"},{id:"b1m6",partner_id:"b1",name:"Mixed Fruit Juice 1L",description:"Blend of tropical fruits",price:300,category:"Juices",image:"https://images.unsplash.com/photo-1546548970-71785318a17b?w=400"},{id:"b2m1",partner_id:"b2",name:"Cappuccino",description:"Rich espresso with steamed milk",price:250,category:"Coffee",image:"https://images.unsplash.com/photo-1534778101976-62847782c213?w=400"},{id:"b2m2",partner_id:"b2",name:"Green Tea",description:"Premium loose leaf green tea",price:150,category:"Tea",image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400"},{id:"b2m3",partner_id:"b2",name:"Iced Latte",description:"Cold espresso with milk over ice",price:300,category:"Coffee",image:"https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?w=400"},{id:"b2m4",partner_id:"b2",name:"Berry Smoothie",description:"Mixed berries with banana",price:350,category:"Smoothies",image:"https://images.unsplash.com/photo-1553530666-ba11a7da3888?w=400"},{id:"b2m5",partner_id:"b2",name:"Hot Chocolate",description:"Rich chocolate with whipped cream",price:280,category:"Hot Drinks",image:"https://images.unsplash.com/photo-1542990253-a781e04c0082?w=400"},{id:"b2m6",partner_id:"b2",name:"Chai Latte",description:"Spiced tea with steamed milk",price:220,category:"Tea",image:"https://images.unsplash.com/photo-1578374173705-0ec0b825334e?w=400"},{id:"b3m1",partner_id:"b3",name:"Carrot-Orange Juice",description:"Cold-pressed carrot and orange",price:280,category:"Cold-Pressed",image:"https://images.unsplash.com/photo-1600271886742-f049cd451bba?w=400"},{id:"b3m2",partner_id:"b3",name:"Detox Green Juice",description:"Kale, cucumber, apple, lemon",price:350,category:"Health",image:"https://images.unsplash.com/photo-1610970881699-44a5587cabec?w=400"},{id:"b3m3",partner_id:"b3",name:"Beetroot Blast",description:"Beetroot, ginger, apple juice",price:300,category:"Cold-Pressed",image:"https://images.unsplash.com/photo-1570831739435-6601aa3fa4fb?w=400"},{id:"b3m4",partner_id:"b3",name:"Protein Shake",description:"Banana, peanut butter, protein powder",price:400,category:"Health",image:"https://images.unsplash.com/photo-1622897931-0f86ee60a824?w=400"},{id:"b3m5",partner_id:"b3",name:"Watermelon Juice",description:"Fresh watermelon juice",price:250,category:"Juices",image:"https://images.unsplash.com/photo-1587049352846-4a222e784262?w=400"},{id:"b3m6",partner_id:"b3",name:"Immunity Booster",description:"Turmeric, ginger, orange, honey",price:350,category:"Health",image:"https://images.unsplash.com/photo-1622543925917-763c34d1a86e?w=400"},{id:"b4m1",partner_id:"b4",name:"Espresso Shot",description:"Pure single-origin espresso",price:180,category:"Coffee",image:"https://images.unsplash.com/photo-1510591509098-f4fdc6d0ff04?w=400"},{id:"b4m2",partner_id:"b4",name:"Pour Over Coffee",description:"Artisan pour over brewing",price:320,category:"Coffee",image:"https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400"},{id:"b4m3",partner_id:"b4",name:"Cold Brew",description:"Smooth cold-brewed coffee",price:350,category:"Coffee",image:"https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?w=400"},{id:"b4m4",partner_id:"b4",name:"Mocha",description:"Chocolate and espresso blend",price:300,category:"Coffee",image:"https://images.unsplash.com/photo-1578374173705-0ec0b825334e?w=400"},{id:"b4m5",partner_id:"b4",name:"Affogato",description:"Espresso shot over vanilla gelato",price:380,category:"Specialty",image:"https://images.unsplash.com/photo-1514066558159-fc8c737ef259?w=400"},{id:"b4m6",partner_id:"b4",name:"Coffee Beans 250g",description:"Freshly roasted coffee beans",price:800,category:"Retail",image:"https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=400"},{id:"b5m1",partner_id:"b5",name:"Pineapple Paradise",description:"Fresh pineapple juice with coconut",price:280,category:"Tropical",image:"https://images.unsplash.com/photo-1587811629661-bd921d213b16?w=400"},{id:"b5m2",partner_id:"b5",name:"Mocktail Sunrise",description:"Orange, grenadine, sparkling water",price:320,category:"Mocktails",image:"https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=400"},{id:"b5m3",partner_id:"b5",name:"Virgin Mojito",description:"Lime, mint, soda water",price:300,category:"Mocktails",image:"https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400"},{id:"b5m4",partner_id:"b5",name:"Tropical Smoothie Bowl",description:"Blended fruits with granola topping",price:450,category:"Smoothie Bowls",image:"https://images.unsplash.com/photo-1590301157890-4810ed352733?w=400"},{id:"b5m5",partner_id:"b5",name:"Coconut Water",description:"Fresh young coconut water",price:200,category:"Natural",image:"https://images.unsplash.com/photo-1574535468632-f62c5e2e7f8f?w=400"},{id:"b5m6",partner_id:"b5",name:"Berry Blast",description:"Mixed berries with ice",price:330,category:"Smoothies",image:"https://images.unsplash.com/photo-1553530666-ba11a7da3888?w=400"},{id:"g1m1",partner_id:"g1",name:"Carrots 6-pack",description:"Fresh organic carrots",price:120,category:"Vegetables",image:"https://images.unsplash.com/photo-1598170845058-32b9d6a5da37?w=400"},{id:"g1m2",partner_id:"g1",name:"Potatoes 10kg",description:"Local farm potatoes",price:500,category:"Vegetables",image:"https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=400"},{id:"g1m3",partner_id:"g1",name:"Fruit Basket Mix",description:"Assorted seasonal fruits",price:800,category:"Fruits",image:"https://images.unsplash.com/photo-1519996529931-28324d5a630e?w=400"},{id:"g1m4",partner_id:"g1",name:"Fresh Milk 2L",description:"Farm fresh whole milk",price:250,category:"Dairy",image:"https://images.unsplash.com/photo-1550583724-b2692b85b150?w=400"},{id:"g1m5",partner_id:"g1",name:"Eggs Tray (30)",description:"Free-range chicken eggs",price:450,category:"Dairy",image:"https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=400"},{id:"g1m6",partner_id:"g1",name:"Tomatoes 2kg",description:"Ripe red tomatoes",price:180,category:"Vegetables",image:"https://images.unsplash.com/photo-1546094096-0df4bcaaa337?w=400"},{id:"g2m1",partner_id:"g2",name:"Rice 5kg",description:"Premium basmati rice",price:850,category:"Grains",image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400"},{id:"g2m2",partner_id:"g2",name:"Cooking Oil 2L",description:"Pure vegetable oil",price:550,category:"Pantry",image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400"},{id:"g2m3",partner_id:"g2",name:"Bread Loaf",description:"Fresh white bread",price:60,category:"Bakery",image:"https://images.unsplash.com/photo-1509440159596-0249088772ff?w=400"},{id:"g2m4",partner_id:"g2",name:"Sugar 2kg",description:"White granulated sugar",price:280,category:"Pantry",image:"https://images.unsplash.com/photo-1587735243615-c03f25aaff15?w=400"},{id:"g2m5",partner_id:"g2",name:"Tea Leaves 500g",description:"Kenyan premium tea",price:350,category:"Beverages",image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400"},{id:"g2m6",partner_id:"g2",name:"Maize Flour 2kg",description:"For making ugali",price:150,category:"Grains",image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400"},{id:"g3m1",partner_id:"g3",name:"Organic Spinach Bundle",description:"Fresh organic spinach",price:100,category:"Organic",image:"https://images.unsplash.com/photo-1576045057995-568f588f82fb?w=400"},{id:"g3m2",partner_id:"g3",name:"Avocado 6-pack",description:"Ripe Kenyan avocados",price:300,category:"Fruits",image:"https://images.unsplash.com/photo-1523049673857-eb18f1d7b578?w=400"},{id:"g3m3",partner_id:"g3",name:"Honey 500ml",description:"Pure raw honey from local farms",price:650,category:"Natural",image:"https://images.unsplash.com/photo-1587049352846-4a222e784262?w=400"},{id:"g3m4",partner_id:"g3",name:"Organic Chicken",description:"Free-range whole chicken 1.5kg",price:950,category:"Meat",image:"https://images.unsplash.com/photo-1604503468506-a8da13d82791?w=400"},{id:"g3m5",partner_id:"g3",name:"Mixed Greens",description:"Lettuce, kale, arugula mix",price:200,category:"Organic",image:"https://images.unsplash.com/photo-1622206151226-18ca2c9ab4a1?w=400"},{id:"g3m6",partner_id:"g3",name:"Brown Eggs Tray (15)",description:"Organic free-range eggs",price:350,category:"Organic",image:"https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=400"},{id:"g4m1",partner_id:"g4",name:"Onions 2kg",description:"Fresh red onions",price:150,category:"Vegetables",image:"https://images.unsplash.com/photo-1580201092675-a0a6a6cafbb7?w=400"},{id:"g4m2",partner_id:"g4",name:"Bananas Bunch",description:"Ripe sweet bananas",price:180,category:"Fruits",image:"https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?w=400"},{id:"g4m3",partner_id:"g4",name:"Cabbage Head",description:"Large fresh cabbage",price:80,category:"Vegetables",image:"https://images.unsplash.com/photo-1594282486552-05b4d80fbb9f?w=400"},{id:"g4m4",partner_id:"g4",name:"Orange Juice 1L",description:"Fresh squeezed orange juice",price:200,category:"Beverages",image:"https://images.unsplash.com/photo-1600271886742-f049cd451bba?w=400"},{id:"g4m5",partner_id:"g4",name:"Beef Mince 1kg",description:"Lean ground beef",price:650,category:"Meat",image:"https://images.unsplash.com/photo-1603048588665-791ca8aea617?w=400"},{id:"g4m6",partner_id:"g4",name:"Yogurt 500ml",description:"Plain natural yogurt",price:180,category:"Dairy",image:"https://images.unsplash.com/photo-1488477181946-6428a0291777?w=400"},{id:"g5m1",partner_id:"g5",name:"Imported Cheese Selection",description:"Assorted European cheeses 500g",price:1200,category:"Premium",image:"https://images.unsplash.com/photo-1486297678162-eb2a19b0a32d?w=400"},{id:"g5m2",partner_id:"g5",name:"Extra Virgin Olive Oil",description:"Italian olive oil 500ml",price:950,category:"Premium",image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400"},{id:"g5m3",partner_id:"g5",name:"Truffle Oil 250ml",description:"White truffle infused oil",price:1800,category:"Specialty",image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=400"},{id:"g5m4",partner_id:"g5",name:"Smoked Salmon 200g",description:"Norwegian smoked salmon",price:1400,category:"Premium",image:"https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=400"},{id:"g5m5",partner_id:"g5",name:"Artisan Pasta 500g",description:"Handmade Italian pasta",price:650,category:"Specialty",image:"https://images.unsplash.com/photo-1621996346565-e3dbc646d9a9?w=400"},{id:"g5m6",partner_id:"g5",name:"Premium Coffee Beans 1kg",description:"Single-origin Ethiopian beans",price:2200,category:"Premium",image:"https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=400"}]}getDefaultRiders(){return[{id:"rider1",name:"John Mutua",phone:"+254700111222",rating:4.8,ordersDelivered:342,status:"available"},{id:"rider2",name:"Peter Kamau",phone:"+254700222333",rating:4.9,ordersDelivered:567,status:"busy"},{id:"rider3",name:"Mary Wanjiku",phone:"+254700333444",rating:4.7,ordersDelivered:234,status:"available"},{id:"rider4",name:"David Otieno",phone:"+254700444555",rating:4.6,ordersDelivered:189,status:"offline"},{id:"rider5",name:"Grace Akinyi",phone:"+254700555666",rating:4.9,ordersDelivered:423,status:"busy"}]}}const Nt=new wt,Xe="/discovermtkenya/assets/logo-Bw5Zg4Bn.png",O=Wr,U=Gr,q=c.forwardRef(({className:r,children:t,...a},n)=>e.jsxs(tr,{ref:n,className:F("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...a,children:[t,e.jsx(Ur,{asChild:!0,children:e.jsx(ar,{className:"h-4 w-4 opacity-50"})})]}));q.displayName=tr.displayName;const Cr=c.forwardRef(({className:r,...t},a)=>e.jsx(sr,{ref:a,className:F("flex cursor-default items-center justify-center py-1",r),...t,children:e.jsx(zr,{className:"h-4 w-4"})}));Cr.displayName=sr.displayName;const _r=c.forwardRef(({className:r,...t},a)=>e.jsx(nr,{ref:a,className:F("flex cursor-default items-center justify-center py-1",r),...t,children:e.jsx(ar,{className:"h-4 w-4"})}));_r.displayName=nr.displayName;const $=c.forwardRef(({className:r,children:t,position:a="popper",...n},s)=>e.jsx(Vr,{children:e.jsxs(ir,{ref:s,className:F("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:a,...n,children:[e.jsx(Cr,{}),e.jsx(Kr,{className:F("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(_r,{})]})}));$.displayName=ir.displayName;const St=c.forwardRef(({className:r,...t},a)=>e.jsx(or,{ref:a,className:F("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...t}));St.displayName=or.displayName;const k=c.forwardRef(({className:r,children:t,...a},n)=>e.jsxs(lr,{ref:n,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Hr,{children:e.jsx(Qr,{className:"h-4 w-4"})})}),e.jsx(Jr,{children:t})]}));k.displayName=lr.displayName;const Ct=c.forwardRef(({className:r,...t},a)=>e.jsx(cr,{ref:a,className:F("-mx-1 my-1 h-px bg-muted",r),...t}));Ct.displayName=cr.displayName;function kr({src:r,alt:t,className:a,containerClassName:n,...s}){const[i,o]=c.useState(!0),[m,g]=c.useState(!1);return e.jsxs("div",{className:F("relative overflow-hidden bg-muted/20",n),children:[i&&!m&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/10 animate-pulse",children:e.jsx(J,{className:"w-6 h-6 animate-spin text-primary/40"})}),m&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-muted/20 text-muted-foreground",children:[e.jsx(dr,{className:"w-8 h-8 mb-2 opacity-20"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wider opacity-40",children:"Failed to load"})]}),e.jsx("img",{src:r,alt:t,className:F("transition-all duration-500",i?"opacity-0 scale-105 blur-sm":"opacity-100 scale-100 blur-0",m?"hidden":"block",a),onLoad:()=>o(!1),onError:()=>{o(!1),g(!0)},...s})]})}const Ye={BASE_URL:"/discovermtkenya/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENV:"development",VITE_APP_NAME:"DMK",VITE_APP_VERSION:"1.0.0",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ3aGduemlvcXJoamd2eGZmdXlxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzNzg2NzksImV4cCI6MjA3Njk1NDY3OX0.IukGQw9fwHFKWNsmhea-5z4fCOZ8S4b6G3QET1JrHSU",VITE_SUPABASE_URL:"https://vwhgnzioqrhjgvxffuyq.supabase.co"},Pr=r=>{if(typeof import.meta<"u"&&Ye)return Ye[r]},$e=Pr("VITE_SUPABASE_URL")||"https://vwhgnzioqrhjgvxffuyq.supabase.co",Oe=Pr("VITE_SUPABASE_ANON_KEY")||"sb_publishable_OO3Sj9U7S8RPTXOb6kkxxA_2T5EBES-";(!$e||!Oe)&&(console.error("âŒ Supabase configuration missing!"),console.error("URL:",$e),console.error("Key:",Oe?"Present":"Missing"));const N=bt($e,Oe,{realtime:{params:{eventsPerSecond:10}},auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1},global:{headers:{"X-Client-Info":"dmk-app"},fetch:(r,t={})=>{const a=new AbortController,n=setTimeout(()=>a.abort("Request timeout (60s)"),6e4),s=t.signal;let i=a.signal;return s&&(typeof AbortSignal.any=="function"?i=AbortSignal.any([a.signal,s]):s.addEventListener("abort",()=>{a.abort(s.reason||"External abort")})),fetch(r,{...t,signal:i}).catch(o=>{if(o.name==="AbortError"){const m=i.reason&&typeof i.reason=="string"?i.reason:"Request timed out or connection was lost";throw new Error(`FetchError: ${m}`)}throw o}).finally(()=>clearTimeout(n))}}}),B=async(r,t=45e3)=>{const a=new AbortController,n=setTimeout(()=>{a.abort(`Query timed out after ${t}ms`)},t);try{return await r.abortSignal(a.signal)}catch(s){console.error("âŒ Service request failed:",s);const i=s.message||s.reason||String(s);return s.name==="AbortError"||i.includes("aborted")||i.includes("timeout")?{data:null,error:{message:`Connection issue: ${i}. Re-trying might help.`,code:"TIMEOUT",details:i}}:{data:null,error:{message:`Database error: ${i}`,code:s.code||"UNKNOWN"}}}finally{clearTimeout(n)}},W={async count(){try{const{count:r,error:t}=await N.from("partners").select("*",{count:"exact",head:!0});if(t)throw t;return r||0}catch(r){return console.error("âŒ Error counting partners:",r),0}},async getDropdownList(){try{const{data:r,error:t}=await N.from("partners").select("id, name, category").order("name",{ascending:!0});if(t)throw t;return r||[]}catch(r){return console.error("âŒ Error loading partner dropdown list:",r),[]}},async getAll(r){try{let t=N.from("partners").select("id, name, category, description, image, rating, promoted, pricePerNight, pricePerPerson, propertyType, location, phone, features, amenities, activityType, created_at, updated_at").order("created_at",{ascending:!1});if(r!=null&&r.search&&r.search.trim().length>0){const i=r.search.replace(/[,()]/g," ").trim();i&&(t=t.or(`name.ilike.%${i}%,description.ilike.%${i}%,location.ilike.%${i}%`))}if(r!=null&&r.limit&&r.limit>0)t=t.limit(r.limit);else if(r!=null&&r.page&&(r!=null&&r.pageSize)){const i=(r.page-1)*r.pageSize,o=i+r.pageSize-1;t=t.range(i,o)}const a=await B(t,6e4),{data:n,error:s}=a;if(s)throw console.error("âŒ Failed to load partners from Supabase:",s),new Error(`Failed to load partners: ${s.message||"Database error"}`);return n||[]}catch(t){if(t.code==="42703"||String(t.message).includes("does not exist")){console.warn("âš ï¸ Column missing in partner fetch, falling back to select(*)");try{const{data:n}=await N.from("partners").select("*").order("created_at",{ascending:!1}).range(0,((r==null?void 0:r.pageSize)||20)-1);return n||[]}catch(n){console.error("âŒ Fallback also failed",n)}}throw String((t==null?void 0:t.message)||"").includes("timeout")?(console.error("â±ï¸ Timeout loading partners - connection may be slow"),new Error("Connection timeout. Please check your internet connection.")):(console.error("âŒ Critical error loading partners:",t),t)}},async getByCategory(r,t){try{const n={accommodation:"accommodation",restaurants:"restaurant",beverages:"beverage",activities:"activities",attractions:"attractions",shop:"shop"}[r.toLowerCase()]||r.toLowerCase();let s=N.from("partners").select("id, name, category, description, image, rating, promoted, pricePerNight, pricePerPerson, propertyType").eq("category",n).order("rating",{ascending:!1});n==="accommodation"&&(t!=null&&t.propertyType)&&t.propertyType!=="all"&&(s=s.eq("propertyType",t.propertyType));const i=Math.max(1,(t==null?void 0:t.page)||1),o=Math.max(1,Math.min(60,(t==null?void 0:t.pageSize)||30)),m=(i-1)*o,g=m+o-1;s=s.range(m,g);const j=await B(s,45e3),{data:T,error:_}=j;if(_){console.warn(`âš ï¸ Optimized fetch for ${r} failed, retrying with select(*)`);let w=N.from("partners").select("*").eq("category",n).range(m,g);const x=await B(w,45e3);if(x.error)throw x.error;return x.data||[]}return T||[]}catch(a){throw String((a==null?void 0:a.message)||"").includes("timeout")?(console.error(`â±ï¸ Timeout loading ${r} partners - connection may be slow`),new Error("Connection timeout. Please check your internet connection.")):(console.error(`âŒ Error loading partners by category ${r}:`,a),a)}},async getPromoted(r){try{let t=N.from("partners").select("id, name, category, description, image, rating, promoted, pricePerNight, pricePerPerson, location, phone, created_at").eq("promoted",!0).order("rating",{ascending:!1});r&&(t=t.limit(r));const a=await B(t,3e4),{data:n,error:s}=a;if(s)throw console.error("âŒ Failed to load promoted partners:",s),new Error(`Failed to load promoted partners: ${s.message}`);return n||[]}catch(t){throw String((t==null?void 0:t.message)||"").includes("timeout")?(console.error("â±ï¸ Timeout loading promoted partners - connection may be slow"),new Error("Connection timeout. Please check your internet connection.")):(console.error("âŒ Error loading promoted partners:",t),t)}},async getSimilar(r,t,a=2){try{const n=N.from("partners").select("id, name, category, image, rating").eq("category",r).neq("id",t).limit(a),s=await B(n,6e4),{data:i,error:o}=s;if(o)throw console.error("âŒ Failed to load similar partners:",o),new Error(`Failed to load similar partners: ${o.message}`);return(i||[]).sort(()=>Math.random()-.5)}catch(n){throw console.error("âŒ Error loading similar partners:",n),n}},async getById(r){try{console.log(`ğŸ” Loading partner ${r} from Supabase...`);const t=N.from("partners").select(["id","name","category","description","image","rating","phone","location","pricePerNight","pricePerPerson","features","amenities","amenities","propertyType","activityType","numberOfPAX","created_at","updated_at"].join(", ")).eq("id",r).single(),a=await B(t,6e4),{data:n,error:s}=a;if(s){if(s.code==="PGRST116")return console.log(`âš ï¸ Partner ${r} not found in database`),null;throw console.error("âŒ Failed to load partner:",s),v.error(`Failed to load partner: ${s.message}`),new Error(`Database error: ${s.message}`)}return console.log(`âœ… Loaded partner: ${n.name}`),n}catch(t){throw console.error("âŒ Critical error loading partner:",t),t}},async create(r){try{console.log("ğŸ” Creating partner in Supabase:",r.name);const t={};Object.keys(r).forEach(s=>{const i=r[s];i!==void 0&&(t[s]=i)}),console.log("ğŸ“ Creating with data:",JSON.stringify(t,null,2));const{data:a,error:n}=await N.from("partners").insert([t]).select().single();if(n)throw console.error("âŒ Failed to create partner:",n),console.error("âŒ Error details:",JSON.stringify(n,null,2)),v.error(`Failed to create partner: ${n.message}`),new Error(`Database error: ${n.message}`);if(!a)throw new Error("No data returned from create operation");return console.log(`âœ… Created partner: ${a.name}`),v.success(`Partner "${a.name}" created successfully`),a}catch(t){return console.error("âŒ Critical error creating partner:",t),console.error("âŒ Error message:",t.message),v.error(`Failed to create partner: ${t.message||"Database connection required"}`),null}},async update(r,t){try{console.log(`ğŸ” Updating partner ${r} in Supabase...`);const a={};Object.keys(t).forEach(i=>{const o=t[i];o!==void 0&&(a[i]=o)}),a.updated_at=new Date().toISOString(),console.log("ğŸ“ Sending updates:",JSON.stringify(a,null,2));const{data:n,error:s}=await N.from("partners").update(a).eq("id",r).select().single();if(s)throw console.error("âŒ Failed to update partner:",s),console.error("âŒ Error details:",JSON.stringify(s,null,2)),v.error(`Failed to update partner: ${s.message}`),new Error(`Database error: ${s.message}`);if(!n)throw new Error("No data returned from update operation");return console.log(`âœ… Updated partner: ${n.name}`),v.success(`Partner "${n.name}" updated successfully`),n}catch(a){return console.error("âŒ Critical error updating partner:",a),console.error("âŒ Error message:",a.message),console.error("âŒ Error stack:",a.stack),v.error(`Failed to update partner: ${a.message||"Database connection required"}`),null}},async delete(r){try{console.log(`ğŸ” Deleting partner ${r} from Supabase...`);const t=await this.getById(r),a=(t==null?void 0:t.name)||"Partner",{error:n}=await N.from("partners").delete().eq("id",r);if(n)throw console.error("âŒ Failed to delete partner:",n),v.error(`Failed to delete partner: ${n.message}`),new Error(`Database error: ${n.message}`);return console.log(`âœ… Deleted partner: ${a}`),v.success(`Partner "${a}" deleted successfully`),!0}catch(t){return console.error("âŒ Critical error deleting partner:",t),v.error("Failed to delete partner. Database connection required."),!1}},getConnectionStatus(){return{isOnline:!0,message:"Connected to database"}},async retryConnection(){try{const{data:r,error:t}=await N.from("partners").select("count",{count:"exact",head:!0});return t?(v.error("Connection failed. Please check your internet connection."),!1):(v.success("Database connection verified"),!0)}catch{return v.error("Connection failed. Please check your internet connection."),!1}},onChanges(r){try{console.log("ğŸ”” Setting up real-time partner subscription...");const t=N.channel("partners-realtime").on("postgres_changes",{event:"*",schema:"public",table:"partners"},async a=>{console.log("ğŸ”” Real-time partner change:",a);const n=a.eventType,s=a.new||a.old;r(s,n)}).subscribe(a=>{console.log("ğŸ”” Subscription status:",a)});return()=>{console.log("ğŸ”” Unsubscribing from partner changes..."),t.unsubscribe()}}catch(t){return console.warn("Real-time subscription failed:",t),()=>{}}}},ce={async count(){try{const{count:r,error:t}=await N.from("menu_items").select("*",{count:"exact",head:!0});if(t)throw t;return r||0}catch(r){return console.error("âŒ Error counting menu items:",r),0}},async getAll(r){try{let t=N.from("menu_items").select("id, partner_id, name, description, price, category, image, promoted, item_type, created_at, updated_at").neq("id","00000000-0000-0000-0000-000000000000").order("created_at",{ascending:!1});if(r!=null&&r.partner_id&&(r==null?void 0:r.partner_id)!=="all"&&(t=t.eq("partner_id",r.partner_id)),r!=null&&r.search&&r.search.trim().length>0){const i=r.search.replace(/[,()]/g," ").trim();i&&(t=t.ilike("name",`%${i}%`))}if(r!=null&&r.page&&(r!=null&&r.pageSize)){const i=(r.page-1)*r.pageSize,o=i+r.pageSize-1;t=t.range(i,o)}const a=await B(t,3e4),{data:n,error:s}=a;if(s){if(s.code==="42703"){let i=N.from("menu_items").select("id, partner_id, name, description, price, category, image, created_at, updated_at").neq("id","00000000-0000-0000-0000-000000000000").order("created_at",{ascending:!1});if(r!=null&&r.partner_id&&(r==null?void 0:r.partner_id)!=="all"&&(i=i.eq("partner_id",r.partner_id)),r!=null&&r.page&&(r!=null&&r.pageSize)){const m=(r.page-1)*r.pageSize,g=m+r.pageSize-1;i=i.range(m,g)}const o=await B(i,3e4);if(o.data)return o.data}throw console.error("âŒ Failed to load menu items:",s),new Error(`Failed to load menu items: ${s.message}`)}return n||[]}catch(t){throw console.error("âŒ Critical error loading menu items:",t),t}},async getByPartner_id(r){try{const t=N.from("menu_items").select("id, partner_id, name, description, price, category, image, promoted, item_type, created_at, updated_at").eq("partner_id",r).order("created_at",{ascending:!1}),a=await B(t,6e4),{data:n,error:s}=a;if(s){console.warn(`âš ï¸ Fetching menu items for ${r} failed, retrying with select(*)`);const i=N.from("menu_items").select("*").eq("partner_id",r).order("created_at",{ascending:!1}),o=await B(i,6e4);if(o.error)throw o.error;if(o.data)return o.data;throw console.error("âŒ Failed to load partner menu items:",s),new Error(`Failed to load menu items: ${s.message}`)}return n||[]}catch(t){throw console.error("âŒ Critical error loading partner menu items:",t),t}},async getPromoted(r,t=5){try{let a=N.from("menu_items").select("id, partner_id, name, description, price, category, image, promoted, item_type, created_at, updated_at").eq("promoted",!0).order("created_at",{ascending:!1});if(r){const o=r.toLowerCase();let m="food";if(o.includes("beverage")?m="beverage":o.includes("shop")?m="product":o.includes("activities")?m="service":o.includes("attractions")&&(m="other"),["food","beverage","product","service"].includes(m))a=a.eq("item_type",m);else if(o.includes("accommodation"))a=a.in("item_type",["service","other"]);else{const g=o.includes("food")||o.includes("restaurant")?"restaurant":o.includes("beverage")?"beverage":o.includes("shop")?"shop":o.includes("activities")?"activities":o.includes("attractions")?"attractions":r;a=a.eq("category",g)}}t&&(a=a.limit(t));const n=await B(a,6e4),{data:s,error:i}=n;if(i)throw console.error("âŒ Failed to load promoted menu items:",i),new Error(`Failed to load promoted menu items: ${i.message}`);return s||[]}catch(a){throw console.error("âŒ Critical error loading promoted menu items:",a),a}},async create(r){try{console.log("ğŸ” Creating menu item in Supabase:",r.name);const t={};Object.keys(r).forEach(o=>{const m=r[o];m!==void 0&&(t[o]=m)}),console.log("ğŸ“ Creating with data:",JSON.stringify(t,null,2));const a=N.from("menu_items").insert([t]).select().single(),n=await B(a,6e4),{data:s,error:i}=n;if(i)throw console.error("âŒ Failed to create menu item:",i),v.error(`Failed to create menu item: ${i.message}`),new Error(`Database error: ${i.message}`);if(!s)throw new Error("No data returned from create operation");return console.log(`âœ… Created menu item: ${s.name}`),v.success(`Menu item "${s.name}" created successfully`),s}catch(t){throw console.error("âŒ Critical error creating menu item:",t),v.error(`Failed to create menu item: ${t.message||"Database connection required"}`),t}},async update(r,t){try{console.log(`ğŸ” Updating menu item ${r} in Supabase...`);const a={};Object.keys(t).forEach(m=>{const g=t[m];g!==void 0&&(a[m]=g)}),a.updated_at=new Date().toISOString(),console.log("ğŸ“ Sending updates:",JSON.stringify(a,null,2));const n=N.from("menu_items").update(a).eq("id",r).select().single(),s=await B(n,6e4),{data:i,error:o}=s;if(o)throw console.error("âŒ Failed to update menu item:",o),v.error(`Failed to update menu item: ${o.message}`),new Error(`Database error: ${o.message}`);if(!i)throw new Error("No data returned from update operation");return console.log(`âœ… Updated menu item: ${i.name}`),v.success(`Menu item "${i.name}" updated successfully`),i}catch(a){throw console.error("âŒ Critical error updating menu item:",a),v.error(`Failed to update menu item: ${a.message||"Database connection required"}`),a}},async delete(r){try{console.log(`ğŸ” Deleting menu item ${r} from Supabase...`);const t=N.from("menu_items").delete().eq("id",r),a=await B(t,6e4),{error:n}=a;if(n)throw console.error("âŒ Failed to delete menu item:",n),v.error(`Failed to delete menu item: ${n.message}`),new Error(`Database error: ${n.message}`);return console.log(`âœ… Deleted menu item: ${r}`),v.success("Menu item deleted successfully"),!0}catch(t){throw console.error("âŒ Critical error deleting menu item:",t),v.error(`Failed to delete menu item: ${t.message||"Database connection required"}`),t}},onChanges(r){try{console.log("ğŸ”” Setting up real-time menu_items subscription...");const t=N.channel("menu-items-realtime").on("postgres_changes",{event:"*",schema:"public",table:"menu_items"},async a=>{console.log("ğŸ”” Real-time menu item change:",a);const n=a.eventType,s=a.new||a.old;r(s,n)}).subscribe(a=>{console.log("ğŸ”” Menu subscription status:",a)});return()=>{console.log("ğŸ”” Unsubscribing from menu item changes..."),t.unsubscribe()}}catch(t){return console.warn("Menu real-time subscription failed:",t),()=>{}}}},me={async count(){try{const{count:r,error:t}=await N.from("users").select("*",{count:"exact",head:!0});if(t)throw t;return r||0}catch(r){return console.error("âŒ Error counting users:",r),0}},async getAll(){try{const r=N.from("users").select("id, username, full_name, phone, location, role, profile_image, created_at, updated_at").order("created_at",{ascending:!1}),t=await B(r,3e4),{data:a,error:n}=t;if(n)throw console.error("âŒ Failed to load users:",n),new Error(`Failed to load users: ${n.message}`);return(a||[]).map(s=>({...s,fullName:s.full_name}))}catch(r){throw String((r==null?void 0:r.message)||"").includes("timeout")?(console.error("â±ï¸ Timeout loading users - connection may be slow"),new Error("Connection timeout. Please check your internet connection.")):(console.error("âŒ Critical error loading users:",r),r)}},async create(r){try{const t={};Object.keys(r).forEach(s=>{const i=r[s];i!==void 0&&(t[s]=i)});const{data:a,error:n}=await N.from("users").insert([t]).select().single();if(n)return console.error("âŒ Failed to create user:",n),v.error(`Failed to create user: ${n.message}`),null;if(!a)throw new Error("No data returned from create operation");return v.success("User created successfully"),a}catch(t){return console.error("âŒ Critical error creating user:",t),v.error("Failed to create user. Database connection required."),null}},async update(r,t){try{const a={};Object.keys(t).forEach(i=>{const o=t[i];o!==void 0&&(a[i]=o)}),a.updated_at=new Date().toISOString();const{data:n,error:s}=await N.from("users").update(a).eq("id",r).select().single();if(s)return console.error("âŒ Failed to update user:",s),v.error(`Failed to update user: ${s.message}`),null;if(!n)throw new Error("No data returned from update operation");return v.success("User updated successfully"),n}catch(a){return console.error("âŒ Critical error updating user:",a),v.error("Failed to update user. Database connection required."),null}},async delete(r){try{const{error:t}=await N.from("users").delete().eq("id",r);return t?(console.error("âŒ Failed to delete user:",t),v.error(`Failed to delete user: ${t.message}`),!1):(v.success("User deleted successfully"),!0)}catch(t){return console.error("âŒ Critical error deleting user:",t),v.error("Failed to delete user. Database connection required."),!1}},onChanges(r){try{console.log("ğŸ”” Setting up real-time users subscription...");const t=N.channel("users-realtime").on("postgres_changes",{event:"*",schema:"public",table:"users"},async a=>{console.log("ğŸ”” Real-time user change:",a);const n=a.eventType,s=a.new||a.old;r(s,n)}).subscribe(a=>{console.log("ğŸ”” User subscription status:",a)});return()=>{console.log("ğŸ”” Unsubscribing from user changes..."),t.unsubscribe()}}catch(t){return console.warn("User real-time subscription failed:",t),()=>{}}}},ge={async count(){try{const{count:r,error:t}=await N.from("reviews").select("*",{count:"exact",head:!0});if(t)throw t;return r||0}catch(r){return console.error("âŒ Error counting reviews:",r),0}},async getAll(){try{const r=N.from("reviews").select("id, partner_id, user_id, user_name, rating, comment, created_at, updated_at").order("created_at",{ascending:!1}),t=await B(r,3e4),{data:a,error:n}=t;if(n)throw console.error("âŒ Failed to load reviews:",n),new Error(`Failed to load reviews: ${n.message}`);return a||[]}catch(r){throw String((r==null?void 0:r.message)||"").includes("timeout")?(console.error("â±ï¸ Timeout loading reviews - connection may be slow"),new Error("Connection timeout. Please check your internet connection.")):(console.error("âŒ Critical error loading reviews:",r),r)}},async getByPartner_id(r){try{const t=N.from("reviews").select("id, partner_id, user_id, user_name, rating, comment, created_at, updated_at").eq("partner_id",r).order("created_at",{ascending:!1}),a=await B(t,6e4),{data:n,error:s}=a;if(s)throw console.error("âŒ Failed to load partner reviews:",s),new Error(`Failed to load reviews: ${s.message}`);return n||[]}catch(t){throw console.error("âŒ Critical error loading partner reviews:",t),t}},async create(r){try{const t={};Object.keys(r).forEach(s=>{const i=r[s];i!==void 0&&(t[s]=i)});const{data:a,error:n}=await N.from("reviews").insert([t]).select().single();if(n)return console.error("âŒ Failed to create review:",n),v.error(`Failed to submit review: ${n.message}`),null;if(!a)throw new Error("No data returned from create operation");return v.success("Review submitted successfully"),a}catch(t){return console.error("âŒ Critical error creating review:",t),v.error("Failed to submit review. Database connection required."),null}},async delete(r){try{const{error:t}=await N.from("reviews").delete().eq("id",r);return t?(console.error("âŒ Failed to delete review:",t),v.error(`Failed to delete review: ${t.message}`),!1):(v.success("Review deleted successfully"),!0)}catch(t){return console.error("âŒ Critical error deleting review:",t),v.error("Failed to delete review. Database connection required."),!1}},onChanges(r){try{console.log("ğŸ”” Setting up real-time reviews subscription...");const t=N.channel("reviews-realtime").on("postgres_changes",{event:"*",schema:"public",table:"reviews"},async a=>{console.log("ğŸ”” Real-time review change:",a);const n=a.eventType,s=a.new||a.old;r(s,n)}).subscribe(a=>{console.log("ğŸ”” Review subscription status:",a)});return()=>{console.log("ğŸ”” Unsubscribing from review changes..."),t.unsubscribe()}}catch(t){return console.warn("Review real-time subscription failed:",t),()=>{}}}},ne={async logInteraction(r){try{const t={partner_id:r.partnerId,partner_category:r.partnerCategory,action_type:r.actionType,action_source:r.actionSource,estimated_value:r.estimatedValue??null,device_type:r.deviceType??null,metadata:r.metadata??{}},{data:a,error:n}=await N.from("partner_interactions").insert(t).select().single();return n?(console.error("âŒ Failed to log interaction:",n),null):a}catch(t){return console.error("âŒ Critical error logging interaction:",t),null}},async getSummary(r={}){try{const{data:t,error:a}=await B(N.rpc("get_interaction_summary",{p_partner_id:r.partnerId||null,category_filter:r.partnerCategory||null,date_from:r.dateFrom||null,date_to:r.dateTo||null}),6e4);if(a){console.warn("âš ï¸ PostgreSQL function not available, using client-side aggregation:",a);let n=N.from("partner_interactions").select("partner_id, partner_category, action_type, estimated_value, created_at");r.partnerId&&(n=n.eq("partner_id",r.partnerId)),r.partnerCategory&&(n=n.eq("partner_category",r.partnerCategory)),r.dateFrom&&(n=n.gte("created_at",r.dateFrom)),r.dateTo&&(n=n.lte("created_at",r.dateTo));const s=await B(n.order("created_at",{ascending:!1}),6e4),{data:i,error:o}=s;if(o)throw new Error(`Failed to load summary: ${o.message}`);const m=i??[],g=m.length,j=m.reduce((S,C)=>S+(C.estimated_value??0),0),T=g,_=new Set(m.map(S=>S.partner_id)),w=new Map;m.forEach(S=>{const C=w.get(S.partner_category)||{interactions:0,revenue:0,bookingPace:0};C.interactions+=1,C.revenue+=S.estimated_value??0,C.bookingPace+=1,w.set(S.partner_category,C)});const x=Array.from(w.entries()).map(([S,C])=>({category:S,interactions:C.interactions,revenue:C.revenue,bookingPace:C.bookingPace})),f=T>0?j/T:0;return{totalInteractions:g,bookingPace:T,totalEstimatedRevenue:j,averageDailyRate:f,uniquePartners:_.size,breakdownByCategory:x}}if(t&&typeof t=="object")return{totalInteractions:t.totalInteractions||0,bookingPace:t.bookingPace||0,totalEstimatedRevenue:t.totalEstimatedRevenue||0,averageDailyRate:t.averageDailyRate||0,uniquePartners:t.uniquePartners||0,breakdownByCategory:t.breakdownByCategory||[]};throw new Error("Invalid response from get_interaction_summary function")}catch(t){throw console.error("âŒ Critical error computing interaction summary:",t),t}},async getDailyTrend(r={}){try{let t=N.from("partner_interaction_daily_summary").select("day, partner_id, partner_category, interaction_count, booking_pace, estimated_revenue").order("day",{ascending:!0});r.partnerId&&(t=t.eq("partner_id",r.partnerId)),r.partnerCategory&&(t=t.eq("partner_category",r.partnerCategory)),r.dateFrom&&(t=t.gte("day",r.dateFrom)),r.dateTo&&(t=t.lte("day",r.dateTo));const a=await B(t,6e4),{data:n,error:s}=a;if(s)throw console.error("âŒ Failed to load interaction trend:",s),new Error(`Failed to load trend: ${s.message}`);return(n??[]).map(i=>({day:i.day,partner_id:i.partner_id,partner_category:i.partner_category,interactionCount:i.interaction_count,bookingPace:i.booking_pace,estimatedRevenue:i.estimated_revenue}))}catch(t){throw console.error("âŒ Critical error loading daily trend:",t),t}},async getRecentInteractions(r=25){try{const{data:t,error:a}=await N.from("partner_interactions").select("id, partner_id, partner_category, action_type, action_source, device_type, estimated_value, metadata, created_at").order("created_at",{ascending:!1}).limit(Math.min(r,100));if(a)throw console.error("âŒ Failed to load recent interactions:",a),a;return t??[]}catch(t){throw console.error("âŒ Critical error loading recent interactions:",t),t}},async getSnapshot(r={}){const t=new Date;t.setHours(0,0,0,0);const a=new Date;a.setHours(23,59,59,999);const n={...r,dateFrom:t.toISOString(),dateTo:a.toISOString()},s=await this.getSummary(n),i=N.from("partner_interactions").select("partner_id, partner_category, estimated_value, created_at, partners!inner(name, category)").gte("created_at",n.dateFrom).lte("created_at",n.dateTo).order("created_at",{ascending:!1}).limit(100),o=await B(i,6e4),{data:m,error:g}=o;g&&console.error("âŒ Failed to load snapshot top partner:",g);const j=new Map;(m??[]).forEach(_=>{const w=_.partner_id;if(!w)return;const x=Array.isArray(_.partners)?_.partners[0]:_.partners,f=(x==null?void 0:x.name)??"Unknown",S=(x==null?void 0:x.category)??_.partner_category,C=j.get(w)||{id:w,name:f,category:S,interactions:0,revenue:0};C.interactions+=1,C.revenue+=_.estimated_value??0,j.set(w,C)});const T=Array.from(j.values()).sort((_,w)=>w.revenue-_.revenue)[0];return{totalToday:s.totalInteractions,bookingPaceToday:s.bookingPace,estimatedRevenueToday:s.totalEstimatedRevenue,averageDailyRateToday:s.averageDailyRate,topPartner:T}},async getInteractions(r={},t=250){try{let a=N.from("partner_interactions").select("id, partner_id, partner_category, action_type, action_source, device_type, estimated_value, metadata, created_at").order("created_at",{ascending:!1}).limit(Math.min(t,100));r.partnerId&&(a=a.eq("partner_id",r.partnerId)),r.partnerCategory&&(a=a.eq("partner_category",r.partnerCategory)),r.dateFrom&&(a=a.gte("created_at",r.dateFrom)),r.dateTo&&(a=a.lte("created_at",r.dateTo));const n=await B(a,6e4),{data:s,error:i}=n;if(i)throw console.error("âŒ Failed to load interactions:",i),new Error(`Failed to load interactions: ${i.message}`);return s??[]}catch(a){throw console.error("âŒ Critical error loading interactions:",a),a}},onChanges(r){try{const t=N.channel("partner-interactions-realtime").on("postgres_changes",{event:"*",schema:"public",table:"partner_interactions"},a=>{const n=a.eventType,s=a.new||a.old;s&&r(s,n)}).subscribe();return()=>{t.unsubscribe()}}catch(t){return console.warn("Interaction real-time subscription failed:",t),()=>{}}}},ie={async getByType(r){try{const{data:t,error:a}=await N.from("app_lookups").select("value").eq("type",r).order("sort_order",{ascending:!0}).order("value",{ascending:!0});return a?(console.error(`âŒ Failed to load lookups for ${r}:`,a),[]):t?t.map(n=>n.value):[]}catch(t){return console.error(`âŒ Critical error loading lookups for ${r}:`,t),[]}},async add(r,t){try{const{error:a}=await N.from("app_lookups").insert([{type:r,value:t}]);if(a)throw a;return!0}catch(a){return console.error(`âŒ Failed to add lookup ${r}/${t}:`,a),!1}},async remove(r,t){try{const{error:a}=await N.from("app_lookups").delete().eq("type",r).eq("value",t);if(a)throw a;return!0}catch(a){return console.error(`âŒ Failed to remove lookup ${r}/${t}:`,a),!1}}},Qe=Zr,_t=Yr,Fr=c.forwardRef(({className:r,...t},a)=>e.jsx(mr,{ref:a,className:F("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...t}));Fr.displayName=mr.displayName;const ke=c.forwardRef(({className:r,children:t,...a},n)=>e.jsxs(_t,{children:[e.jsx(Fr,{}),e.jsxs(ur,{ref:n,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...a,children:[t,e.jsxs(Xr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(pr,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ke.displayName=ur.displayName;const Pe=({className:r,...t})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",r),...t});Pe.displayName="DialogHeader";const Ar=({className:r,...t})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t});Ar.displayName="DialogFooter";const Fe=c.forwardRef(({className:r,...t},a)=>e.jsx(gr,{ref:a,className:F("text-lg font-semibold leading-none tracking-tight",r),...t}));Fe.displayName=gr.displayName;const kt=c.forwardRef(({className:r,...t},a)=>e.jsx(hr,{ref:a,className:F("text-sm text-muted-foreground",r),...t}));kt.displayName=hr.displayName;const he=c.forwardRef(({className:r,...t},a)=>e.jsx("textarea",{className:F("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:a,...t}));he.displayName="Textarea";const X=c.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:F("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t}));X.displayName="Card";const Pt=c.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:F("flex flex-col space-y-1.5 p-6",r),...t}));Pt.displayName="CardHeader";const Ft=c.forwardRef(({className:r,...t},a)=>e.jsx("h3",{ref:a,className:F("text-2xl font-semibold leading-none tracking-tight",r),...t}));Ft.displayName="CardTitle";const At=c.forwardRef(({className:r,...t},a)=>e.jsx("p",{ref:a,className:F("text-sm text-muted-foreground",r),...t}));At.displayName="CardDescription";const Y=c.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:F("p-6 pt-0",r),...t}));Y.displayName="CardContent";const Tt=c.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:F("flex items-center p-6 pt-0",r),...t}));Tt.displayName="CardFooter";function re({value:r,onChange:t,className:a="",placeholder:n="Upload image"}){const[s,i]=c.useState(!1),o=g=>{var T;const j=(T=g.target.files)==null?void 0:T[0];if(j){i(!0);const _=new FileReader;_.onload=w=>{var f;const x=(f=w.target)==null?void 0:f.result;t(x),i(!1)},_.readAsDataURL(j)}},m=()=>{t("")};return e.jsx("div",{className:`space-y-2 ${a}`,children:r?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r,alt:"Uploaded",className:"w-full h-32 object-cover rounded-lg border border-border"}),e.jsx(E,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:m,children:e.jsx(pr,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center hover:border-primary transition-colors",children:[e.jsx(dr,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:n}),e.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"hidden",id:"image-upload"}),e.jsxs(E,{type:"button",variant:"outline",size:"sm",disabled:s,onClick:()=>{var g;return(g=document.getElementById("image-upload"))==null?void 0:g.click()},children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),s?"Uploading...":"Choose Image"]})]})})}function Z({children:r}){const t=rt(),a=tt(),n=[{to:"/admin",icon:st,label:"Dashboard"},{to:"/admin/partners",icon:xr,label:"Partners"},{to:"/admin/menus",icon:nt,label:"Product Management"},{to:"/admin/lookups",icon:it,label:"Type Management"},{to:"/admin/users",icon:fr,label:"Users"},{to:"/admin/reviews",icon:Me,label:"Reviews"},{to:"/admin/analytics",icon:ot,label:"Analytics"}],s=()=>{Nt.setCurrentUser(null),window.dispatchEvent(new CustomEvent("userLogout")),v.success("Logged out successfully"),a("/login")};return e.jsxs("div",{className:"min-h-screen bg-muted flex",children:[e.jsxs("aside",{className:"w-64 bg-card border-r border-border hidden md:flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Xe,alt:"Discover Mount Kenya",className:"h-10 w-auto object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"Discover Mount Kenya"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Admin Panel"})]})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:n.map(i=>{const o=i.icon,m=t.pathname===i.to;return e.jsxs(Ge,{to:i.to,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${m?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,children:[e.jsx(o,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:i.label})]},i.to)})}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs(E,{variant:"outline",className:"w-full justify-start",onClick:s,children:[e.jsx(at,{className:"w-5 h-5 mr-3"}),"Logout"]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-card border-b border-border p-4 md:hidden",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Xe,alt:"Discover Mount Kenya",className:"h-10 w-auto object-contain"}),e.jsx("h1",{className:"font-bold text-lg",children:"Admin Panel"})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:r}),e.jsx("footer",{className:"bg-card border-t border-border p-4 text-center",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Developed by"," ",e.jsx("a",{href:"https://vairal.co.ke",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Vairal Media"})]})}),e.jsx("nav",{className:"bg-card border-t border-border md:hidden",children:e.jsx("div",{className:"flex items-center justify-around p-2",children:n.map(i=>{const o=i.icon,m=t.pathname===i.to;return e.jsxs(Ge,{to:i.to,className:`flex flex-col items-center p-2 ${m?"text-primary":"text-muted-foreground"}`,children:[e.jsx(o,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:i.label})]},i.to)})})})]})]})}const Dt=He("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Rt({className:r,variant:t,...a}){return e.jsx("div",{className:F(Dt({variant:t}),r),...a})}const Et={light:"",dark:".dark"},Tr=c.createContext(null);function Dr(){const r=c.useContext(Tr);if(!r)throw new Error("useChart must be used within a <ChartContainer />");return r}const Je=c.forwardRef(({id:r,className:t,children:a,config:n,...s},i)=>{const o=c.useId(),m=`chart-${r||o.replace(/:/g,"")}`;return e.jsx(Tr.Provider,{value:{config:n},children:e.jsxs("div",{"data-chart":m,ref:i,className:F("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...s,children:[e.jsx(Lt,{id:m,config:n}),e.jsx(lt,{children:a})]})})});Je.displayName="Chart";const Lt=({id:r,config:t})=>{const a=Object.entries(t).filter(([n,s])=>s.theme||s.color);return a.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(Et).map(([n,s])=>`
${s} [data-chart=${r}] {
${a.map(([i,o])=>{var g;const m=((g=o.theme)==null?void 0:g[n])||o.color;return m?`  --color-${i}: ${m};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Rr=ct,We=c.forwardRef(({active:r,payload:t,className:a,indicator:n="dot",hideLabel:s=!1,hideIndicator:i=!1,label:o,labelFormatter:m,labelClassName:g,formatter:j,color:T,nameKey:_,labelKey:w},x)=>{const{config:f}=Dr(),S=c.useMemo(()=>{var R;if(s||!(t!=null&&t.length))return null;const[l]=t,u=`${w||l.dataKey||l.name||"value"}`,D=Ue(f,l,u),p=!w&&typeof o=="string"?((R=f[o])==null?void 0:R.label)||o:D==null?void 0:D.label;return m?e.jsx("div",{className:F("font-medium",g),children:m(p,t)}):p?e.jsx("div",{className:F("font-medium",g),children:p}):null},[o,m,t,s,g,f,w]);if(!r||!(t!=null&&t.length))return null;const C=t.length===1&&n!=="dot";return e.jsxs("div",{ref:x,className:F("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[C?null:S,e.jsx("div",{className:"grid gap-1.5",children:t.map((l,u)=>{const D=`${_||l.name||l.dataKey||"value"}`,p=Ue(f,l,D),R=T||l.payload.fill||l.color;return e.jsx("div",{className:F("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:j&&(l==null?void 0:l.value)!==void 0&&l.name?j(l.value,l.name,l,u,l.payload):e.jsxs(e.Fragment,{children:[p!=null&&p.icon?e.jsx(p.icon,{}):!i&&e.jsx("div",{className:F("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":C&&n==="dashed"}),style:{"--color-bg":R,"--color-border":R}}),e.jsxs("div",{className:F("flex flex-1 justify-between leading-none",C?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[C?S:null,e.jsx("span",{className:"text-muted-foreground",children:(p==null?void 0:p.label)||l.name})]}),l.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:l.value.toLocaleString()})]})]})},l.dataKey)})})]})});We.displayName="ChartTooltip";const Mt=c.forwardRef(({className:r,hideIcon:t=!1,payload:a,verticalAlign:n="bottom",nameKey:s},i)=>{const{config:o}=Dr();return a!=null&&a.length?e.jsx("div",{ref:i,className:F("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",r),children:a.map(m=>{const g=`${s||m.dataKey||"value"}`,j=Ue(o,m,g);return e.jsxs("div",{className:F("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[j!=null&&j.icon&&!t?e.jsx(j.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:m.color}}),j==null?void 0:j.label]},m.value)})}):null});Mt.displayName="ChartLegend";function Ue(r,t,a){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let s=a;return a in t&&typeof t[a]=="string"?s=t[a]:n&&a in n&&typeof n[a]=="string"&&(s=n[a]),s in r?r[s]:r[a]}const It=[{label:"All partners",value:"all"},{label:"Accommodation",value:"accommodation"},{label:"Restaurants",value:"restaurant"},{label:"Beverages",value:"beverage"},{label:"Activities",value:"activities"}],Se=[{label:"Last 7 days",value:"7d",days:7},{label:"Last 30 days",value:"30d",days:30},{label:"Last 90 days",value:"90d",days:90},{label:"Last 180 days",value:"180d",days:180},{label:"Last 365 days",value:"365d",days:365}],Re=[{label:"Night",start:0,end:5},{label:"Morning",start:6,end:11},{label:"Afternoon",start:12,end:17},{label:"Evening",start:18,end:23}],Bt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ze=[1,2,3,4,5,6,0],qt={bookings:{label:"Bookings",color:"#2563eb"},revenue:{label:"Revenue (KES)",color:"#16a34a"},adr:{label:"Avg Rate",color:"#f97316"}},ee=r=>`KES ${Math.round(r).toLocaleString()}`,$t=r=>{const t=Se[1],a=Se.find(i=>i.value===r)||t,n=new Date,s=new Date(n);return s.setHours(0,0,0,0),n.setMinutes(59,59,999),s.setDate(s.getDate()-(a.days-1)),{from:s,to:n}},Ot=r=>{switch(r){case"order_call":return"Order";case"activity_call":return"Activity";default:return"Booking"}};function Xt(){var K;const[r,t]=c.useState({totalPartners:0,totalUsers:0,totalReviews:0,averageRating:0,promotedPartners:0,recentPartners:[],topRatedPartners:[]}),[a,n]=c.useState([]),[s,i]=c.useState(null),[o,m]=c.useState(null),[g,j]=c.useState([]),[T,_]=c.useState([]),[w,x]=c.useState([]),[f,S]=c.useState("all"),[C,l]=c.useState("30d"),[u,D]=c.useState(!0),[p,R]=c.useState(!1),[h,V]=c.useState(null),Q=c.useCallback(async(d=!0)=>{try{d&&D(!0),V(null);const{from:A,to:M}=$t(C),H={partnerCategory:f==="all"?void 0:f,dateFrom:A.toISOString(),dateTo:M.toISOString()},L=await Promise.allSettled([W.count(),me.count(),ge.count(),W.getAll({limit:5}),W.getPromoted(),ne.getSummary(H),ne.getSnapshot(H)]),ae=L[0].status==="fulfilled"?L[0].value:0,oe=L[1].status==="fulfilled"?L[1].value:0,ve=L[2].status==="fulfilled"?L[2].value:0,se=L[3].status==="fulfilled"?L[3].value:[],le=L[4].status==="fulfilled"?L[4].value:[],Lr=L[5].status==="fulfilled"?L[5].value:null,Mr=L[6].status==="fulfilled"?L[6].value:null,Ir=le.length,Ae=[...se,...le],Br=Ae.length>0?Ae.reduce((De,$r)=>De+$r.rating,0)/Ae.length:0;t({totalPartners:ae,totalUsers:oe,totalReviews:ve,averageRating:Number(Br.toFixed(1)),promotedPartners:Ir,recentPartners:se,topRatedPartners:le.slice(0,5)}),i(Lr),m(Mr);const je=await Promise.allSettled([ne.getDailyTrend(H),ne.getInteractions(H,50)]),qr=je[0].status==="fulfilled"?je[0].value:[],Te=je[1].status==="fulfilled"?je[1].value:[],Ht=new Set(Te.map(De=>De.partner_id)),Qt=[];j(qr),_(Te),x(Te.slice(0,15)),n([...se,...le])}catch(A){console.error("Error loading dashboard data:",A),V(`Failed to load dashboard: ${A.message||"Unknown error"}`)}finally{d&&D(!1),R(!1)}},[C,f]);c.useEffect(()=>{Q(!0)},[Q]),c.useEffect(()=>{let d=null;const A=ne.onChanges(()=>{d&&clearTimeout(d),d=setTimeout(()=>{R(!0),Q(!1)},2e3)});return()=>{d&&clearTimeout(d),A()}},[Q]);const y=c.useMemo(()=>new Map(a.map(d=>[d.id,d])),[a]),z=c.useMemo(()=>g.map(d=>{const A=new Date(d.day),M=d.bookingPace,H=d.estimatedRevenue||0,L=M>0?H/M:0;return{day:Sr(A,"MMM d"),bookings:M,revenue:Math.round(H),adr:Math.round(L)}}),[g]),G=c.useMemo(()=>{const d=Array.from({length:7},()=>Array(Re.length).fill(0));let A=0;T.forEach(L=>{const ae=L.created_at?new Date(L.created_at):new Date,oe=ae.getDay(),ve=ae.getHours(),se=Re.findIndex(le=>ve>=le.start&&ve<=le.end);se!==-1&&(d[oe][se]+=1,d[oe][se]>A&&(A=d[oe][se]))});const M=Ze.map(L=>d[L]),H=Ze.map(L=>Bt[L]);return{matrix:M,labels:H,max:A}},[T]),fe=c.useMemo(()=>{const d=new Map;return T.forEach(A=>{const M=y.get(A.partner_id);if(!M)return;const H=d.get(M.id)||{partner:M,interactions:0,bookings:0,revenue:0},L={partner:M,interactions:H.interactions+1,bookings:H.bookings+(A.action_type==="book_call"?1:0),revenue:H.revenue+(A.estimated_value??0)};d.set(M.id,L)}),Array.from(d.values()).sort((A,M)=>M.revenue-A.revenue).slice(0,8)},[T,y]),ye=c.useMemo(()=>w.map(d=>{const A=y.get(d.partner_id),M=d.created_at?ft(d.created_at):new Date;return{id:d.id,partnerName:(A==null?void 0:A.name)||"Unknown Partner",category:(A==null?void 0:A.category)??d.partner_category,action:Ot(d.action_type),revenue:d.estimated_value??0,timeAgo:yt(M,{addSuffix:!0})}}),[w,y]),be=c.useMemo(()=>s?[{label:"Booking Pace",value:s.bookingPace.toLocaleString(),icon:dt,description:"Calls placed in selected period",color:"bg-primary/10 text-primary border-primary/20"},{label:"Total Calls",value:s.totalInteractions.toLocaleString(),icon:Ie,description:"All recorded interactions",color:"bg-blue-50 text-blue-700 border-blue-200"},{label:"Est. Revenue",value:ee(s.totalEstimatedRevenue),icon:yr,description:"Projected from calls",color:"bg-emerald-50 text-emerald-700 border-emerald-200"},{label:"Average Rate",value:ee(s.averageDailyRate),icon:Be,description:"Average revenue per booking",color:"bg-orange-50 text-orange-700 border-orange-200"}]:[],[s]),b=c.useMemo(()=>s==null?void 0:s.breakdownByCategory.slice().sort((d,A)=>A.revenue-d.revenue).slice(0,4),[s]);return e.jsx(Z,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in-up",children:[u&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-muted/50 rounded-lg px-4 py-3",children:[e.jsx(J,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading dashboard dataâ€¦"})]}),h&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-4 py-3",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsxs("span",{children:["Failed to load: ",h,". Some data may be missing."]})]}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Snapshot of bookings, revenue, and partner performance across DMK."}),p&&!u&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/30 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Syncing real-time updatesâ€¦"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(O,{value:f,onValueChange:d=>S(d),children:[e.jsx(q,{className:"w-full sm:w-[200px]",children:e.jsx(U,{placeholder:"Partner category"})}),e.jsx($,{children:It.map(d=>e.jsx(k,{value:d.value,children:d.label},d.value))})]}),e.jsxs(O,{value:C,onValueChange:l,children:[e.jsx(q,{className:"w-full sm:w-[200px]",children:e.jsx(U,{placeholder:"Date range"})}),e.jsx($,{children:Se.map(d=>e.jsx(k,{value:d.value,children:d.label},d.value))})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{label:"Total Partners",value:r.totalPartners.toLocaleString(),icon:xr,description:"Active business listings",color:"bg-primary/10 text-primary border-primary/20"},{label:"Total Users",value:r.totalUsers.toLocaleString(),icon:fr,description:"Registered customers",color:"bg-green-50 text-green-700 border-green-200"},{label:"Total Reviews",value:r.totalReviews.toLocaleString(),icon:Ie,description:"Customer feedback entries",color:"bg-blue-50 text-blue-700 border-blue-200"},{label:"Average Rating",value:r.averageRating.toString(),icon:Be,description:"Across all partners",color:"bg-purple-50 text-purple-700 border-purple-200"}].map(d=>{const A=d.icon;return e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-sm border hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:F("w-12 h-12 rounded-lg border-2 flex items-center justify-center",d.color),children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:d.label}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:d.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d.description})]})]})},d.label)})}),be.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:be.map(d=>{const A=d.icon;return e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-sm border hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:F("w-12 h-12 rounded-lg border-2 flex items-center justify-center",d.color),children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:d.label}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:d.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d.description})]})]})},d.label)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Booking Trend"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Calls, bookings, and revenue over the selected period"})]}),e.jsxs(Rt,{variant:"outline",className:"text-xs",children:[e.jsx(br,{className:"mr-1 h-3 w-3"}),(K=Se.find(d=>d.value===C))==null?void 0:K.label]})]}),e.jsx("div",{className:"px-4 pb-6",children:z.length===0?e.jsx("div",{className:"flex h-64 items-center justify-center text-sm text-muted-foreground",children:"No interactions recorded in this period."}):e.jsx(Je,{config:qt,className:"h-72 w-full",children:e.jsxs(vr,{data:z,children:[e.jsx(jr,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.4}),e.jsx(wr,{dataKey:"day",tickLine:!1,axisLine:!1,stroke:"hsl(var(--muted-foreground))"}),e.jsx(qe,{yAxisId:"left",tickLine:!1,axisLine:!1,stroke:"hsl(var(--muted-foreground))",width:60}),e.jsx(qe,{yAxisId:"right",orientation:"right",tickLine:!1,axisLine:!1,stroke:"hsl(var(--muted-foreground))",width:60}),e.jsx(Rr,{content:e.jsx(We,{})}),e.jsx(ue,{yAxisId:"left",type:"monotone",dataKey:"bookings",name:"Bookings",stroke:"var(--color-bookings)",fill:"var(--color-bookings)",fillOpacity:.15}),e.jsx(ue,{yAxisId:"right",type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"var(--color-revenue)",fill:"var(--color-revenue)",fillOpacity:.1}),e.jsx(ue,{yAxisId:"right",type:"monotone",dataKey:"adr",name:"Avg Rate",stroke:"var(--color-adr)",strokeDasharray:"4 4",fillOpacity:0})]})})})]}),e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Today at a Glance"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live snapshot of todayâ€™s activity"})]}),e.jsx("div",{className:"space-y-4 px-6 py-5",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Bookings"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:o.bookingPaceToday.toLocaleString()})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Est. Revenue"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:ee(o.estimatedRevenueToday)})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Avg Rate"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:ee(o.averageDailyRateToday)})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Total Calls"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:o.totalToday.toLocaleString()})]})]}),o.topPartner&&e.jsxs("div",{className:"rounded-lg border border-primary/20 bg-primary/5 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-primary",children:[e.jsx(mt,{className:"h-4 w-4"}),"Top performer today"]}),e.jsx("p",{className:"mt-2 text-sm font-medium text-foreground",children:o.topPartner.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:o.topPartner.category}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Calls: ",o.topPartner.interactions]}),e.jsx("span",{className:"font-semibold text-foreground",children:ee(o.topPartner.revenue)})]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No interactions recorded yet today."})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-card rounded-xl border shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-border px-6 py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Realtime Booking Heatmap"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Intensity of calls by day and time of day (local time)"})]})}),e.jsx("div",{className:"overflow-x-auto px-6 py-5",children:T.length===0?e.jsx("div",{className:"flex h-48 items-center justify-center text-sm text-muted-foreground",children:"Not enough data to render the heatmap for this range."}):e.jsx("div",{className:"min-w-[480px]",children:e.jsxs("div",{className:"grid grid-cols-[120px_repeat(4,1fr)] gap-1 text-xs",children:[e.jsx("div",{className:"py-2"}),Re.map(d=>e.jsx("div",{className:"py-2 text-center font-medium text-muted-foreground",children:d.label},d.label)),G.matrix.map((d,A)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center py-1 font-medium text-muted-foreground",children:G.labels[A]},`label-${G.labels[A]}`),d.map((M,H)=>{const L=G.max||1,ae=M/L,oe=M===0?"bg-muted text-muted-foreground":ae<.25?"bg-primary/10 text-foreground":ae<.5?"bg-primary/30 text-primary-foreground":ae<.75?"bg-primary/50 text-primary-foreground":"bg-primary text-primary-foreground";return e.jsx("div",{className:F("flex h-10 items-center justify-center rounded-md text-xs font-medium transition-colors",oe),children:M},`cell-${A}-${H}`)})]}))]})})})]}),e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-border px-6 py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Recent Activity"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Latest partner interactions"})]})}),e.jsx("div",{className:"space-y-4 px-6 py-5",children:ye.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No activity recorded for this period."}):ye.map(d=>e.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-lg border border-border/50 bg-muted/30 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:d.partnerName}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:d.category}),e.jsxs("div",{className:"mt-2 inline-flex items-center gap-1 rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary",children:[e.jsx(ut,{className:"h-3 w-3"}),d.action]})]}),e.jsxs("div",{className:"text-right",children:[d.revenue?e.jsx("p",{className:"text-sm font-semibold text-foreground",children:ee(d.revenue)}):null,e.jsx("p",{className:"text-xs text-muted-foreground",children:d.timeAgo})]})]},d.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Partner Performance"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top partners by interactions and projected revenue"})]}),e.jsx("div",{className:"overflow-x-auto px-6 py-4",children:fe.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No partner activity recorded for this selection."}):e.jsxs("table",{className:"w-full min-w-[520px] text-sm",children:[e.jsx("thead",{className:"text-left text-xs text-muted-foreground",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 font-medium",children:"Partner"}),e.jsx("th",{className:"pb-3 font-medium",children:"Category"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Calls"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Bookings"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Avg Rate"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Revenue"})]})}),e.jsx("tbody",{className:"divide-y divide-border/60",children:fe.map(d=>{const A=d.bookings>0?d.revenue/d.bookings:0;return e.jsxs("tr",{className:"text-sm text-muted-foreground",children:[e.jsx("td",{className:"py-3 text-foreground",children:e.jsx("div",{className:"font-medium",children:d.partner.name})}),e.jsx("td",{className:"py-3 capitalize",children:d.partner.category}),e.jsx("td",{className:"py-3 text-right",children:d.interactions}),e.jsx("td",{className:"py-3 text-right",children:d.bookings}),e.jsx("td",{className:"py-3 text-right",children:ee(A)}),e.jsx("td",{className:"py-3 text-right font-semibold text-foreground",children:ee(d.revenue)})]},d.partner.id)})})]})})]}),e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Revenue Breakdown"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Category performance across the selected timeframe"})]}),e.jsx("div",{className:"px-6 py-5 space-y-4",children:b&&b.length>0?b.map(d=>e.jsxs("div",{className:"rounded-lg border border-border/60 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground capitalize",children:d.category}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.interactions.toLocaleString()," calls | Booking pace: ",d.bookingPace.toLocaleString()]})]}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:ee(d.revenue)})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:"h-2 rounded-full bg-primary",style:{width:s&&s.totalInteractions>0?`${d.interactions/s.totalInteractions*100}%`:"0%"}})})]},d.category)):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revenue analytics will appear as soon as calls are logged."})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Featured Partners Coverage"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.promotedPartners.toLocaleString()," promoted listings out of ",r.totalPartners.toLocaleString()," total partners"]})]}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("div",{className:"w-full rounded-full bg-muted",children:e.jsx("div",{className:"h-3 rounded-full bg-primary transition-all",style:{width:r.totalPartners>0?`${r.promotedPartners/r.totalPartners*100}%`:"0%"}})}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Promoted"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:r.promotedPartners.toLocaleString()})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"Non-Promoted"}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:(r.totalPartners-r.promotedPartners).toLocaleString()})]})]})]})]}),e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px-6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Top Rated Partners"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leading properties and outlets by guest feedback"})]}),e.jsx("div",{className:"space-y-3 px-6 py-5",children:r.topRatedPartners.map((d,A)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/30 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:d.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:d.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-semibold text-primary",children:["â­ ",d.rating]}),e.jsxs("p",{className:"text-[10px] uppercase text-muted-foreground",children:["#",A+1]})]})]},d.id))})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Dashboard Information"}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"All analytics refresh automatically from Supabase. Filters allow you to drill down by partner type and timeframe."}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Booking pace is calculated from real call-to-book actions."}),e.jsx("li",{children:"â€¢ Estimated revenue leverages partner pricing fields where available."}),e.jsx("li",{children:"â€¢ Heatmap and trends reflect live interaction data, updating instantly."}),e.jsx("li",{children:"â€¢ Use the partner filters to focus on specific verticals."})]})]})]})})]})})}function Ut({open:r,onOpenChange:t,partner:a,onSave:n}){const[s,i]=c.useState({name:"",category:"restaurant",image:"",description:"",location:"",address:"",phone:"",rating:4.5,promoted:!1}),[o,m]=c.useState([]),[g,j]=c.useState([]),[T,_]=c.useState([]),[w,x]=c.useState([]),[f,S]=c.useState([]);c.useEffect(()=>{r&&(async()=>{const[u,D,p,R,h]=await Promise.all([ie.getByType("property_type"),ie.getByType("attraction_type"),ie.getByType("feature"),ie.getByType("amenity"),ie.getByType("activity_type")]);m(u),j(D),_(p),x(R),S(h)})()},[r]),c.useEffect(()=>{i(a||{name:"",category:"restaurant",image:"",description:"",location:"",address:"",phone:"",rating:4.5,promoted:!1})},[a,r]);const C=l=>{l.preventDefault(),n(a?{...s,id:a.id}:s),t(!1)};return e.jsx(Qe,{open:r,onOpenChange:t,children:e.jsxs(ke,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Pe,{children:e.jsx(Fe,{children:a?"Edit Partner":"Add New Partner"})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"category",children:"Category"}),e.jsxs(O,{value:s.category,onValueChange:l=>i({...s,category:l}),children:[e.jsx(q,{children:e.jsx(U,{})}),e.jsxs($,{children:[e.jsx(k,{value:"accommodation",children:"Accommodation"}),e.jsx(k,{value:"restaurant",children:"Restaurants"}),e.jsx(k,{value:"beverage",children:"Beverage Outlets"}),e.jsx(k,{value:"activities",children:"Activities"}),e.jsx(k,{value:"attractions",children:"Attractions"}),e.jsx(k,{value:"shop",children:"Shop"})]})]})]}),(s.category==="accommodation"||s.category==="attractions")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"name",children:s.category==="accommodation"?"Name of Property *":"Name of Attraction *"}),e.jsx(I,{id:"name",value:s.name,onChange:l=>i({...s,name:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"propertyType",children:s.category==="accommodation"?"Property Type *":"Attraction Type *"}),e.jsxs(O,{value:s.propertyType||"",onValueChange:l=>i({...s,propertyType:l}),children:[e.jsx(q,{children:e.jsx(U,{placeholder:s.category==="accommodation"?"Select property type":"Select attraction type"})}),e.jsx($,{children:s.category==="accommodation"?o.map(l=>e.jsx(k,{value:l,children:l},l)):g.map(l=>e.jsx(k,{value:l,children:l},l))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"location",children:"Location *"}),e.jsx(I,{id:"location",value:s.location,onChange:l=>i({...s,location:l.target.value}),required:!0})]}),(s.category==="accommodation"||s.category==="attractions")&&e.jsxs("div",{children:[e.jsx(P,{htmlFor:"features",children:"Features"}),e.jsxs(O,{value:"multiple",onValueChange:()=>{},children:[e.jsx(q,{className:"h-auto min-h-[40px]",children:e.jsx(U,{placeholder:"Select features (hold Ctrl to select multiple)"})}),e.jsx($,{className:"max-h-60",children:T.map(l=>{var u;return e.jsxs("div",{className:"px-2 py-1",children:[e.jsx("input",{type:"checkbox",id:`feature-${l}`,checked:((u=s.features)==null?void 0:u.includes(l))||!1,onChange:D=>{const p=s.features||[],R=D.target.checked?[...p,l]:p.filter(h=>h!==l);i({...s,features:R})},className:"mr-2"}),e.jsx("label",{htmlFor:`feature-${l}`,children:l})]},l)})})]})]}),s.category==="accommodation"&&e.jsxs("div",{children:[e.jsx(P,{htmlFor:"amenities",children:"Room Amenities"}),e.jsxs(O,{value:"multiple",onValueChange:()=>{},children:[e.jsx(q,{className:"h-auto min-h-[40px]",children:e.jsx(U,{placeholder:"Select amenities (hold Ctrl to select multiple)"})}),e.jsx($,{className:"max-h-60",children:w.map(l=>{var u;return e.jsxs("div",{className:"px-2 py-1",children:[e.jsx("input",{type:"checkbox",id:`amenity-${l}`,checked:((u=s.amenities)==null?void 0:u.includes(l))||!1,onChange:D=>{const p=s.amenities||[],R=D.target.checked?[...p,l]:p.filter(h=>h!==l);i({...s,amenities:R})},className:"mr-2"}),e.jsx("label",{htmlFor:`amenity-${l}`,children:l})]},l)})})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"description",children:"Description *"}),e.jsx(he,{id:"description",value:s.description,onChange:l=>i({...s,description:l.target.value}),required:!0,rows:3})]}),s.category==="accommodation"&&e.jsxs("div",{children:[e.jsx(P,{htmlFor:"pricePerNight",children:"Price Per Night (KES)"}),e.jsx(I,{id:"pricePerNight",type:"number",placeholder:"Optional",value:s.pricePerNight||"",onChange:l=>i({...s,pricePerNight:parseFloat(l.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(I,{id:"phone",value:s.phone,onChange:l=>i({...s,phone:l.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image1",children:"Image 1"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[0]:s.image,onChange:l=>i({...s,image:Array.isArray(s.image)?[l,s.image[1],s.image[2],s.image[3],s.image[4],s.image[5]].filter(Boolean):[l]}),placeholder:"Upload image 1"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image2",children:"Image 2"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[1]:"",onChange:l=>i({...s,image:Array.isArray(s.image)?[s.image[0],l,s.image[2],s.image[3],s.image[4],s.image[5]].filter(Boolean):[s.image,l].filter(Boolean)}),placeholder:"Upload image 2"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image3",children:"Image 3"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[2]:"",onChange:l=>i({...s,image:Array.isArray(s.image)?[s.image[0],s.image[1],l,s.image[3],s.image[4],s.image[5]].filter(Boolean):[s.image,l].filter(Boolean)}),placeholder:"Upload image 3"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image4",children:"Image 4"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[3]:"",onChange:l=>i({...s,image:Array.isArray(s.image)?[s.image[0],s.image[1],s.image[2],l,s.image[4],s.image[5]].filter(Boolean):[s.image,l].filter(Boolean)}),placeholder:"Upload image 4"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image5",children:"Image 5"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[4]:"",onChange:l=>i({...s,image:Array.isArray(s.image)?[s.image[0],s.image[1],s.image[2],s.image[3],l,s.image[5]].filter(Boolean):[s.image,l].filter(Boolean)}),placeholder:"Upload image 5"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image6",children:"Image 6"}),e.jsx(re,{value:Array.isArray(s.image)?s.image[5]:"",onChange:l=>i({...s,image:Array.isArray(s.image)?[s.image[0],s.image[1],s.image[2],s.image[3],s.image[4],l].filter(Boolean):[s.image,l].filter(Boolean)}),placeholder:"Upload image 6"})]})]})]}),s.category==="activities"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"name",children:"Name of Activity *"}),e.jsx(I,{id:"name",value:s.name,onChange:l=>i({...s,name:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image",children:"Business Image *"}),e.jsx(re,{value:s.image,onChange:l=>i({...s,image:l}),placeholder:"Upload activity image"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"activityType",children:"Activity Type *"}),e.jsxs(O,{value:s.activityType||"",onValueChange:l=>i({...s,activityType:l}),children:[e.jsx(q,{children:e.jsx(U,{placeholder:"Select activity type"})}),e.jsx($,{children:f.map(l=>e.jsx(k,{value:l,children:l},l))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"description",children:"Description *"}),e.jsx(he,{id:"description",value:s.description,onChange:l=>i({...s,description:l.target.value}),required:!0,rows:3})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"location",children:"Location *"}),e.jsx(I,{id:"location",value:s.location,onChange:l=>i({...s,location:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(I,{id:"phone",value:s.phone,onChange:l=>i({...s,phone:l.target.value}),required:!0})]})]}),(s.category==="restaurant"||s.category==="beverage"||s.category==="shop")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"name",children:"Business Name *"}),e.jsx(I,{id:"name",value:s.name,onChange:l=>i({...s,name:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image",children:"Business Image *"}),e.jsx(re,{value:s.image,onChange:l=>i({...s,image:l}),placeholder:"Upload business image"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"description",children:"Description *"}),e.jsx(he,{id:"description",value:s.description,onChange:l=>i({...s,description:l.target.value}),required:!0,rows:3})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"location",children:"Location *"}),e.jsx(I,{id:"location",value:s.location,onChange:l=>i({...s,location:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(I,{id:"phone",value:s.phone,onChange:l=>i({...s,phone:l.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"rating",children:"Rating (1-5) *"}),e.jsx(I,{id:"rating",type:"number",step:"0.1",min:"1",max:"5",value:s.rating,onChange:l=>i({...s,rating:parseFloat(l.target.value)}),required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"promoted",checked:s.promoted,onChange:l=>i({...s,promoted:l.target.checked}),className:"w-4 h-4"}),e.jsx(P,{htmlFor:"promoted",className:"cursor-pointer",children:"Promoted"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"submit",className:"flex-1",children:"Save"}),e.jsx(E,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancel"})]})]})]})})}function Yt(){const[r,t]=c.useState(!1),[a,n]=c.useState(),[s,i]=c.useState(""),[o,m]=c.useState("all"),g=ze(),[j,T]=c.useState(1),_=20,[w,x]=c.useState("");c.useEffect(()=>{const y=setTimeout(()=>x(s),500);return()=>clearTimeout(y)},[s]);const{data:f=[],isLoading:S,isFetching:C,error:l}=Ne({queryKey:["admin","partners",j,w,o],queryFn:async()=>{const y=await W.getAll({page:j,pageSize:_,search:w});return console.log("âœ… Admin: Loaded",y.length,"partners"),y},staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:y=>Math.min(1e3*2**y,1e4),placeholderData:y=>y});c.useEffect(()=>{const y=W.onChanges(()=>{g.invalidateQueries({queryKey:["admin","partners"]})});return()=>y()},[g]);const u=te({mutationFn:y=>W.create(y),onSuccess:()=>{g.invalidateQueries({queryKey:["admin","partners"]}),v.success("Partner created successfully")},onError:y=>{console.error("âŒ Admin: Failed to create partner",y),v.error("Failed to create partner")}}),D=te({mutationFn:({id:y,data:z})=>W.update(y,z),onSuccess:()=>{g.invalidateQueries({queryKey:["admin","partners"]}),v.success("Partner updated successfully")},onError:y=>{console.error("âŒ Admin: Failed to update partner",y),v.error("Failed to update partner")}}),p=te({mutationFn:y=>W.delete(y),onSuccess:()=>{g.invalidateQueries({queryKey:["admin","partners"]}),v.success("Partner removed")},onError:y=>{console.error("âŒ Admin: Failed to delete partner",y),v.error("Failed to delete partner")}}),R=async y=>{confirm("Are you sure you want to delete this partner?")&&await p.mutateAsync(y)},h=async y=>{const z=f.find(G=>G.id===y);z&&await D.mutateAsync({id:y,data:{promoted:!z.promoted}})},V=async y=>{try{if(y.id){const{id:z,...G}=y;await D.mutateAsync({id:z,data:G})}else await u.mutateAsync(y);n(void 0)}catch(z){console.error("âŒ Admin: Save failed",z)}},Q=c.useMemo(()=>f.filter(y=>o==="all"||y.category===o),[f,o]);return e.jsx(Z,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Partners Management ",e.jsx("span",{className:"text-sm font-normal text-green-600 bg-green-50 border border-green-200 rounded px-2 py-0.5 ml-2",children:"v2.0 Fix Verified"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage Partners"}),S&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Loading partnersâ€¦"})]}),C&&!S&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Syncingâ€¦"})]}),l&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-red-200 bg-red-50 px-3 py-1 text-xs text-red-600",children:[e.jsx(de,{className:"h-3 w-3"}),e.jsx("span",{children:l instanceof Error?l.message:"Failed to load partners. Retrying..."})]})]}),e.jsxs(E,{onClick:()=>{n(void 0),t(!0)},className:"bg-primary hover:bg-primary/90",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Add Partner"]})]}),e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search partners by name, description, or location...",value:s,onChange:y=>i(y.target.value),className:"pl-10"})]}),e.jsxs(O,{value:o,onValueChange:m,children:[e.jsx(q,{className:"w-full md:w-48",children:e.jsx(U,{placeholder:"Filter by category"})}),e.jsxs($,{children:[e.jsx(k,{value:"all",children:"All Categories"}),e.jsx(k,{value:"accommodation",children:"Accommodation"}),e.jsx(k,{value:"restaurant",children:"Restaurants"}),e.jsx(k,{value:"beverage",children:"Beverage Outlets"}),e.jsx(k,{value:"activities",children:"Activities"}),e.jsx(k,{value:"attractions",children:"Attractions"}),e.jsx(k,{value:"shop",children:"Shop"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Q.map(y=>e.jsxs("div",{className:"bg-card rounded-xl overflow-hidden shadow-card",children:[e.jsx(kr,{src:Array.isArray(y.image)?y.image[0]:y.image,alt:y.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:y.name}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:y.category})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(pe,{className:"w-4 h-4 text-primary fill-primary"}),e.jsx("span",{className:"font-medium",children:y.rating})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:y.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{size:"sm",variant:y.promoted?"default":"outline",onClick:()=>h(y.id),className:"flex-1",children:y.promoted?"Promoted":"Promote"}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>{n(y),t(!0)},children:e.jsx(Ke,{className:"w-4 h-4"})}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>R(y.id),className:"text-destructive hover:text-destructive",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})]},y.id))}),f.length>0&&e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(E,{variant:"outline",onClick:()=>T(y=>Math.max(1,y-1)),disabled:j===1||S,children:"Previous"}),e.jsxs("span",{className:"flex items-center text-sm text-muted-foreground",children:["Page ",j]}),e.jsx(E,{variant:"outline",onClick:()=>T(y=>y+1),disabled:f.length<_||S,children:"Next"})]}),e.jsx(Ut,{open:r,onOpenChange:y=>{t(y),y||n(void 0)},partner:a,onSave:V})]})})}const Er=c.forwardRef(({className:r,...t},a)=>e.jsx(Nr,{className:F("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",r),...t,ref:a,children:e.jsx(pt,{className:F("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Er.displayName=Nr.displayName;function zt({open:r,onOpenChange:t,menuItem:a,partners:n,defaultPartnerId:s,onSave:i}){const[o,m]=c.useState({partner_id:"",name:"",description:"",price:0,category:"",image:"",promoted:!1,item_type:"food"});c.useEffect(()=>{if(a)m({...a,partner_id:a.partner_id||(n.length>0?n[0].id:""),name:a.name||"",description:a.description||"",price:a.price||0,category:a.category||"",image:a.image||"",promoted:a.promoted||!1,item_type:a.item_type||"food"});else{const x=s&&s!=="all"?s:n.length>0?n[0].id:"",f=n.find(C=>C.id===x);let S="food";f&&(f.category.toLowerCase().includes("shop")?S="product":f.category.toLowerCase().includes("activities")?S="service":f.category.toLowerCase().includes("beverage")&&(S="beverage")),m({partner_id:x,name:"",description:"",price:0,category:"",image:"",promoted:!1,item_type:S})}},[a,n,r,s]);const g=n.find(x=>x.id===o.partner_id),j=(g==null?void 0:g.category)||"";c.useEffect(()=>{if(!(a!=null&&a.id)&&g){const x=g.category.toLowerCase();let f=o.item_type;x.includes("shop")?f="product":x.includes("activities")&&(f="service"),f!==o.item_type&&m(S=>({...S,item_type:f}))}},[g]);const _=(()=>{const x=j.toLowerCase().includes("shop")||o.item_type==="product",f=j.toLowerCase().includes("activities")||o.item_type==="service",S=j.toLowerCase().includes("attractions");return x?{name:"Product Name",desc:"Product Description"}:f?{name:"Service Name",desc:"Service Description"}:S?{name:"Highlight Name",desc:"Highlight Description"}:{name:"Item Name",desc:"Description"}})(),w=x=>{if(x.preventDefault(),!o.partner_id){alert("Please select a partner");return}if(!o.name||!o.price){alert("Please fill in all required fields");return}const f={...o,partner_id:o.partner_id};a&&a.id?i({...f,id:a.id}):i(f),t(!1)};return e.jsx(Qe,{open:r,onOpenChange:t,children:e.jsxs(ke,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Pe,{children:e.jsx(Fe,{children:a!=null&&a.id?"Edit Menu Item":"Add New Menu Item"})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"partner_id",children:"Partner"}),e.jsxs(O,{value:o.partner_id,onValueChange:x=>m({...o,partner_id:x}),children:[e.jsx(q,{children:e.jsx(U,{placeholder:"Select a partner"})}),e.jsx($,{children:n.map(x=>e.jsx(k,{value:x.id,children:x.name},x.id))})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"item_type",children:"Item Type"}),e.jsxs(O,{value:o.item_type,onValueChange:x=>m({...o,item_type:x}),children:[e.jsx(q,{children:e.jsx(U,{placeholder:"Select item type"})}),e.jsxs($,{children:[e.jsx(k,{value:"food",children:"Food"}),e.jsx(k,{value:"beverage",children:"Beverage"}),e.jsx(k,{value:"product",children:"Product (Shop)"}),e.jsx(k,{value:"service",children:"Service (Activity)"}),e.jsx(k,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"name",children:_.name}),e.jsx(I,{id:"name",value:o.name,onChange:x=>m({...o,name:x.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"description",children:_.desc}),e.jsx(he,{id:"description",value:o.description,onChange:x=>m({...o,description:x.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"category",children:'Category/Tag (e.g., "Breakfast", "Electronics")'}),e.jsx(I,{id:"category",value:o.category,onChange:x=>m({...o,category:x.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"price",children:"Price (KES)"}),e.jsx(I,{id:"price",type:"number",value:o.price,onChange:x=>m({...o,price:parseFloat(x.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"image",children:"Item Image"}),e.jsx(re,{value:o.image,onChange:x=>m({...o,image:x}),placeholder:"Upload item image"})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-muted/30 p-3 rounded-lg border border-primary/10",children:[e.jsx(Er,{id:"promoted",checked:o.promoted,onCheckedChange:x=>m({...o,promoted:x})}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(P,{htmlFor:"promoted",className:"text-sm font-semibold leading-none cursor-pointer",children:"Promoted / Featured"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Display this item in the "Featured" section of the category page.'})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"submit",className:"flex-1",children:"Save"}),e.jsx(E,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancel"})]})]})]})})}function Zt(){const[r,t]=c.useState("all"),[a,n]=c.useState(!1),[s,i]=c.useState(),o=ze(),{data:m=[],isLoading:g,isFetching:j,error:T}=Ne({queryKey:["admin","partners_list"],queryFn:()=>W.getDropdownList(),staleTime:1e3*60*5,refetchOnWindowFocus:!1}),_=c.useMemo(()=>m.filter(b=>!b.category.toLowerCase().includes("accommodation")),[m]),[w,x]=c.useState(1),f=20,[S,C]=c.useState(""),[l,u]=c.useState("");c.useEffect(()=>{const b=setTimeout(()=>u(S),500);return()=>clearTimeout(b)},[S]);const{data:D=[],isLoading:p,isFetching:R,error:h}=Ne({queryKey:["admin","menu_items",w,r,l],queryFn:()=>ce.getAll({page:w,pageSize:f,partner_id:r,search:l}),staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:b=>Math.min(1e3*2**b,1e4),placeholderData:b=>b});c.useEffect(()=>{var K;const b=(K=ce.onChanges)==null?void 0:K.call(ce,()=>{o.invalidateQueries({queryKey:["admin","menu_items"]})});return()=>{b&&b()}},[o]);const V=te({mutationFn:b=>ce.create(b),onSuccess:()=>{o.invalidateQueries({queryKey:["admin","menu_items"]}),v.success("Product created")},onError:b=>{console.error("Failed to create product",b),v.error("Failed to create product")}}),Q=te({mutationFn:({id:b,data:K})=>ce.update(b,K),onSuccess:()=>{o.invalidateQueries({queryKey:["admin","menu_items"]}),v.success("Product updated")},onError:b=>{console.error("Failed to update product",b),v.error("Failed to update product")}}),y=te({mutationFn:b=>ce.delete(b),onSuccess:()=>{o.invalidateQueries({queryKey:["admin","menu_items"]}),v.success("Product removed")},onError:b=>{console.error("Failed to delete product",b),v.error("Failed to delete product")}}),z=D,G=b=>{var K;return((K=m.find(d=>d.id===b))==null?void 0:K.name)||"Unknown"},fe=async b=>{confirm("Are you sure you want to delete this product?")&&await y.mutateAsync(b)},ye=b=>{const{id:K,created_at:d,updated_at:A,...M}=b;i(M),n(!0)},be=async b=>{try{if(b.id){const{id:K,...d}=b;await Q.mutateAsync({id:K,data:d})}else await V.mutateAsync(b);i(void 0)}catch(K){console.error("Failed to save product",K)}};return e.jsx(Z,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Product Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage products for all partners"}),p&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Loading menu itemsâ€¦"})]}),R&&!p&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Syncingâ€¦"})]}),(T||h)&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-red-200 bg-red-50 px-3 py-1 text-xs text-red-600",children:[e.jsx(de,{className:"h-3 w-3"}),e.jsx("span",{children:"Failed to load data. Retryingâ€¦"})]})]}),e.jsxs(E,{onClick:()=>{i(void 0),n(!0)},className:"bg-primary hover:bg-primary/90",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Add Product Item"]})]}),e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Search Item"}),e.jsx("input",{type:"text",className:"w-full border rounded-md px-3 py-2 text-sm",placeholder:"Search menu items...",value:S,onChange:b=>C(b.target.value)})]}),e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Filter by Partner"}),e.jsxs(O,{value:r,onValueChange:t,children:[e.jsx(q,{children:e.jsx(U,{placeholder:"All Partners"})}),e.jsxs($,{children:[e.jsx(k,{value:"all",children:"All Partners"}),_.map(b=>e.jsx(k,{value:b.id,children:b.name},b.id))]})]})]})]})}),z.length===0?e.jsx("div",{className:"bg-card rounded-xl p-12 shadow-card text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No menu items found. Add your first menu item to get started."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:z.map(b=>e.jsxs("div",{className:"bg-card rounded-xl overflow-hidden shadow-card",children:[b.image&&e.jsx(kr,{src:b.image,alt:b.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:b.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:G(b.partner_id)}),b.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:b.description}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-lg font-bold text-primary",children:["KES ",b.price.toLocaleString()]}),e.jsxs("div",{className:"flex gap-1",children:[b.promoted&&e.jsx("span",{className:"text-[10px] bg-amber-100 text-amber-800 px-2 py-1 rounded-full border border-amber-200 font-semibold",children:"Featured"}),e.jsx("span",{className:"text-xs bg-muted text-muted-foreground px-2 py-1 rounded-full uppercase",children:b.item_type||"item"}),e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full",children:b.category})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>{i(b),n(!0)},className:"flex-1",children:[e.jsx(Ke,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>ye(b),title:"Copy Item",children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>fe(b.id),className:"text-destructive hover:text-destructive",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})]},b.id))}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8 pb-8",children:[e.jsx(E,{variant:"outline",onClick:()=>x(b=>Math.max(1,b-1)),disabled:w===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center text-sm text-muted-foreground",children:["Page ",w]}),e.jsx(E,{variant:"outline",onClick:()=>x(b=>b+1),disabled:D.length<f,children:"Next"})]}),e.jsx(zt,{open:a,onOpenChange:b=>{n(b),b||i(void 0)},menuItem:s,partners:_,defaultPartnerId:r,onSave:be})]})})}const er=[{label:"All partners",value:"all"},{label:"Accommodation",value:"accommodation"},{label:"Restaurants",value:"restaurant"},{label:"Beverages",value:"beverage"},{label:"Activities",value:"activities"}],Ce=[{label:"Last 7 days",value:"7d",days:7},{label:"Last 30 days",value:"30d",days:30},{label:"Last 90 days",value:"90d",days:90},{label:"Last 365 days",value:"365d",days:365}],Vt=r=>{const t=Ce.find(s=>s.value===r)||Ce[1],a=new Date,n=new Date(a);return n.setHours(0,0,0,0),a.setMinutes(59,59,999),n.setDate(n.getDate()-(t.days-1)),{from:n,to:a}},Kt={bookings:{label:"Bookings",color:"#2563eb"},revenue:{label:"Revenue (KES)",color:"#16a34a"},adr:{label:"Avg Rate",color:"#f97316"}},Ee=r=>`KES ${Math.round(r).toLocaleString()}`;function ea(){var u,D;const[r,t]=c.useState("all"),[a,n]=c.useState("30d"),[s,i]=c.useState(!0),[o,m]=c.useState(!1),[g,j]=c.useState(null),[T,_]=c.useState([]),[w,x]=c.useState(null),[f,S]=c.useState([]),C=c.useCallback(async(p=!0)=>{try{p&&i(!0),j(null);const{from:R,to:h}=Vt(a),V={partnerCategory:r==="all"?void 0:r,dateFrom:R.toISOString(),dateTo:h.toISOString()},[Q,y,z]=await Promise.all([W.getAll(),ne.getSummary(V),ne.getDailyTrend(V)]);_(Q),x(y),S(z)}catch(R){console.error("Error loading analytics:",R),j(`Failed to load analytics: ${R.message||"Unknown error"}`)}finally{p&&i(!1),m(!1)}},[r,a]);c.useEffect(()=>{C(!0)},[C]),c.useEffect(()=>{const p=ne.onChanges(()=>{m(!0),C(!1)});return()=>p()},[C]);const l=c.useMemo(()=>f.map(p=>{const R=new Date(p.day),h=p.bookingPace,V=p.estimatedRevenue||0,Q=h>0?V/h:0;return{day:Sr(R,"MMM d"),bookings:h,revenue:Math.round(V),adr:Math.round(Q)}}),[f]);return s?e.jsx(Z,{children:e.jsx("div",{className:"max-w-7xl mx-auto flex h-[60vh] items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"mx-auto mb-4 h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading analyticsâ€¦"})]})})}):g?e.jsx(Z,{children:e.jsx("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(de,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Failed to Load Analytics"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:g}),e.jsx(E,{onClick:()=>C(!0),variant:"outline",children:"Try Again"})]})})}):e.jsx(Z,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Analytics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Business intelligence and KPIs"}),o&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Syncing live dataâ€¦"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(O,{value:r,onValueChange:p=>t(p),children:[e.jsx(q,{className:"w-full sm:w-[200px]",children:e.jsx(U,{placeholder:"Partner category"})}),e.jsx($,{children:er.map(p=>e.jsx(k,{value:p.value,children:p.label},p.value))})]}),e.jsxs(O,{value:a,onValueChange:n,children:[e.jsx(q,{className:"w-full sm:w-[200px]",children:e.jsx(U,{placeholder:"Date range"})}),e.jsx($,{children:Ce.map(p=>e.jsx(k,{value:p.value,children:p.label},p.value))})]})]})]}),w&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{label:"Booking Pace",value:w.bookingPace.toLocaleString(),icon:Ie,description:"Calls in selected period",color:"bg-primary/10 text-primary border-primary/20"},{label:"Total Calls",value:w.totalInteractions.toLocaleString(),icon:br,description:"All interactions",color:"bg-blue-50 text-blue-700 border-blue-200"},{label:"Est. Revenue",value:Ee(w.totalEstimatedRevenue),icon:yr,description:"Projected from pricing",color:"bg-emerald-50 text-emerald-700 border-emerald-200"},{label:"Avg Rate",value:Ee(w.averageDailyRate),icon:Be,description:"Average per booking",color:"bg-orange-50 text-orange-700 border-orange-200"}].map(p=>{const R=p.icon;return e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-sm border hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg border-2 flex items-center justify-center ${p.color}`,children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:p.label}),e.jsx("p",{className:"text-2xl font-semibold text-foreground",children:p.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:p.description})]})]})},p.label)})}),e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Trend"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bookings, revenue, and ADR over time"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(u=er.find(p=>p.value===r))==null?void 0:u.label," Â· ",(D=Ce.find(p=>p.value===a))==null?void 0:D.label]})]}),e.jsx("div",{className:"px-4 pb-6",children:l.length===0?e.jsx("div",{className:"flex h-64 items-center justify-center text-sm text-muted-foreground",children:"No data available for this selection."}):e.jsx(Je,{config:Kt,className:"h-72 w-full",children:e.jsxs(vr,{data:l,children:[e.jsx(jr,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.4}),e.jsx(wr,{dataKey:"day",tickLine:!1,axisLine:!1,stroke:"hsl(var(--muted-foreground))"}),e.jsx(qe,{tickLine:!1,axisLine:!1,stroke:"hsl(var(--muted-foreground))",width:60}),e.jsx(Rr,{content:e.jsx(We,{})}),e.jsx(ue,{type:"monotone",dataKey:"bookings",name:"Bookings",stroke:"var(--color-bookings)",fill:"var(--color-bookings)",fillOpacity:.15}),e.jsx(ue,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"var(--color-revenue)",fill:"var(--color-revenue)",fillOpacity:.1}),e.jsx(ue,{type:"monotone",dataKey:"adr",name:"Avg Rate",stroke:"var(--color-adr)",strokeDasharray:"4 4",fillOpacity:0})]})})})]}),w&&w.breakdownByCategory.length>0&&e.jsxs("div",{className:"bg-card rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"border-b border-border px  -6 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Revenue Breakdown by Category"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Distribution of calls and projected revenue"})]}),e.jsx("div",{className:"px-6 py-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:w.breakdownByCategory.slice().sort((p,R)=>R.revenue-p.revenue).map(p=>e.jsxs("div",{className:"rounded-lg border border-border/60 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold capitalize text-foreground",children:p.category}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p.interactions.toLocaleString()," calls Â· Booking pace ",p.bookingPace.toLocaleString()]})]}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:Ee(p.revenue)})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:"h-2 rounded-full bg-primary",style:{width:w.totalInteractions>0?`${p.interactions/w.totalInteractions*100}%`:"0%"}})})]},p.category))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Analytics Notes"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Booking pace counts all calls for the timeframe."}),e.jsx("li",{children:"â€¢ Estimated revenue uses partner pricing fields where available."}),e.jsx("li",{children:"â€¢ Use filters to focus on specific partner categories and ranges."})]})]})]})})]})})}function ra(){const[r,t]=c.useState([]),[a,n]=c.useState([]),[s,i]=c.useState(""),[o,m]=c.useState("all"),[g,j]=c.useState("all"),[T,_]=c.useState(!0);c.useEffect(()=>{w();const u=ge.onChanges(async()=>{console.log("ğŸ”” Reviews changed, reloading..."),await x()});return()=>{u()}},[]);const w=async()=>{try{_(!0);const[u,D]=await Promise.all([ge.getAll(),W.getAll()]);t(u),n(D),console.log(`âœ… Loaded ${u.length} reviews`)}catch(u){console.error("Failed to load data:",u),v.error("Failed to load reviews")}finally{_(!1)}},x=async()=>{try{const u=await ge.getAll();t(u)}catch(u){console.error("Failed to load reviews:",u)}},f=async u=>{confirm("Are you sure you want to delete this review?")&&await ge.delete(u)&&await x()},S=u=>{var D;return((D=a.find(p=>p.id===u))==null?void 0:D.name)||"Unknown Partner"},C=r.filter(u=>{const D=s===""||u.userName.toLowerCase().includes(s.toLowerCase())||u.comment.toLowerCase().includes(s.toLowerCase())||S(u.partner_id).toLowerCase().includes(s.toLowerCase()),p=o==="all"||u.partner_id===o,R=g==="all"||u.rating===parseInt(g);return D&&p&&R}),l={total:r.length,fiveStars:r.filter(u=>u.rating===5).length,fourStars:r.filter(u=>u.rating===4).length,threeStars:r.filter(u=>u.rating===3).length,twoStars:r.filter(u=>u.rating===2).length,oneStar:r.filter(u=>u.rating===1).length,averageRating:r.length>0?(r.reduce((u,D)=>u+D.rating,0)/r.length).toFixed(1):"0"};return T?e.jsx(Z,{children:e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading reviews..."})})})}):e.jsx(Z,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Reviews Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage customer reviews and ratings"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Reviews"}),e.jsx("p",{className:"text-3xl font-bold",children:l.total})]}),e.jsx(Me,{className:"w-12 h-12 text-primary opacity-20"})]})})}),e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-3xl font-bold",children:l.averageRating}),e.jsx(pe,{className:"w-6 h-6 text-primary fill-primary"})]})]})})})}),e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Rating Distribution"}),e.jsx("div",{className:"space-y-1",children:[5,4,3,2,1].map(u=>{const D=u===5?l.fiveStars:u===4?l.fourStars:u===3?l.threeStars:u===2?l.twoStars:l.oneStar,p=l.total>0?D/l.total*100:0;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs w-8",children:[u,"â˜…"]}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${p}%`}})}),e.jsx("span",{className:"text-xs w-8 text-right",children:D})]},u)})})]})})}),e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Top Rated"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-primary fill-primary"}),e.jsx("span",{className:"text-lg font-bold",children:l.fiveStars}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"5-star reviews"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-primary fill-primary"}),e.jsx("span",{className:"text-lg font-bold",children:l.fourStars}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"4-star reviews"})]})]})]})})})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search by user, comment, or partner...",value:s,onChange:u=>i(u.target.value),className:"pl-10"})]}),e.jsxs(O,{value:o,onValueChange:m,children:[e.jsx(q,{className:"w-full md:w-48",children:e.jsx(U,{placeholder:"Filter by partner"})}),e.jsxs($,{children:[e.jsx(k,{value:"all",children:"All Partners"}),a.map(u=>e.jsx(k,{value:u.id,children:u.name},u.id))]})]}),e.jsxs(O,{value:g,onValueChange:j,children:[e.jsx(q,{className:"w-full md:w-48",children:e.jsx(U,{placeholder:"Filter by rating"})}),e.jsxs($,{children:[e.jsx(k,{value:"all",children:"All Ratings"}),e.jsx(k,{value:"5",children:"5 Stars"}),e.jsx(k,{value:"4",children:"4 Stars"}),e.jsx(k,{value:"3",children:"3 Stars"}),e.jsx(k,{value:"2",children:"2 Stars"}),e.jsx(k,{value:"1",children:"1 Star"})]})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",C.length," of ",r.length," reviews"]})]}),C.length===0?e.jsxs("div",{className:"bg-card rounded-xl p-12 shadow-card text-center",children:[e.jsx(Me,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground opacity-20"}),e.jsx("p",{className:"text-muted-foreground",children:"No reviews found matching your filters."})]}):e.jsx("div",{className:"space-y-4",children:C.map(u=>e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-semibold text-primary",children:u.userName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:u.userName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:S(u.partner_id)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((D,p)=>e.jsx(pe,{className:`w-4 h-4 ${p<u.rating?"text-primary fill-primary":"text-gray-300"}`},p))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[u.rating,".0"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:u.comment}),u.created_at&&e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(u.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>f(u.id),className:"text-destructive hover:text-destructive",children:e.jsx(xe,{className:"w-4 h-4"})})]})})},u.id))})]})})}function ta(){const[r,t]=c.useState(""),[a,n]=c.useState("all"),[s,i]=c.useState(!1),[o,m]=c.useState(),[g,j]=c.useState({username:"",fullName:"",phone:"",location:"",role:"user"}),T=ze(),{data:_=[],isLoading:w,isFetching:x,error:f}=Ne({queryKey:["admin","users"],queryFn:me.getAll,staleTime:1e3*60,gcTime:1e3*300,refetchOnMount:!0,retry:3,retryDelay:h=>Math.min(1e3*2**h,1e4),suspense:!1});c.useEffect(()=>{const h=me.onChanges(async()=>{T.invalidateQueries({queryKey:["admin","users"]})});return()=>{h()}},[T]),c.useEffect(()=>{j(o?{username:o.username,fullName:o.fullName,phone:o.phone,location:o.location,role:o.role}:{username:"",fullName:"",phone:"",location:"",role:"user"})},[o]);const S=te({mutationFn:h=>me.create(h),onSuccess:()=>{T.invalidateQueries({queryKey:["admin","users"]}),v.success("User created successfully")},onError:h=>{console.error("Failed to create user",h),v.error("Failed to create user")}}),C=te({mutationFn:({id:h,data:V})=>me.update(h,V),onSuccess:()=>{T.invalidateQueries({queryKey:["admin","users"]}),v.success("User updated successfully")},onError:h=>{console.error("Failed to update user",h),v.error("Failed to update user")}}),l=te({mutationFn:h=>me.delete(h),onSuccess:()=>{T.invalidateQueries({queryKey:["admin","users"]}),v.success("User removed")},onError:h=>{console.error("Failed to delete user",h),v.error("Failed to delete user")}}),u=async()=>{if(!g.username||!g.fullName||!g.phone){v.error("Please fill in all required fields");return}try{o!=null&&o.id?await C.mutateAsync({id:o.id,data:g}):await S.mutateAsync(g),i(!1),m(void 0)}catch(h){console.error("Failed to save user",h)}},D=async h=>{confirm("Are you sure you want to delete this user?")&&await l.mutateAsync(h)},p=c.useMemo(()=>_.filter(h=>{const V=r===""||h.username.toLowerCase().includes(r.toLowerCase())||h.fullName.toLowerCase().includes(r.toLowerCase())||h.phone.includes(r)||h.location.toLowerCase().includes(r.toLowerCase()),Q=a==="all"||h.role===a;return V&&Q}),[_,r,a]),R={total:_.length,admins:_.filter(h=>h.role==="admin").length,users:_.filter(h=>h.role==="user").length};return e.jsxs(Z,{children:[x&&e.jsx("div",{className:"max-w-7xl mx-auto py-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(J,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:w?"Loading usersâ€¦":"Syncingâ€¦"})]})}),f&&!x&&e.jsx("div",{className:"max-w-7xl mx-auto py-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-yellow-600 bg-yellow-50 border border-yellow-200 rounded-lg px-4 py-2",children:[e.jsx(AlertCircle,{className:"h-4 w-4"}),e.jsx("span",{children:"Couldn't load users. Showing cached data."})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Users Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts and permissions"}),x&&e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-xs text-primary",children:[e.jsx(J,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"Refreshing usersâ€¦"})]})]}),e.jsxs(E,{onClick:()=>{m(void 0),i(!0)},className:"bg-primary hover:bg-primary/90",children:[e.jsx(_e,{className:"w-5 h-5 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold",children:R.total})]}),e.jsx(we,{className:"w-12 h-12 text-primary opacity-20"})]})})}),e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Admins"}),e.jsx("p",{className:"text-3xl font-bold",children:R.admins})]}),e.jsx(we,{className:"w-12 h-12 text-destructive opacity-20"})]})})}),e.jsx(X,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Regular Users"}),e.jsx("p",{className:"text-3xl font-bold",children:R.users})]}),e.jsx(we,{className:"w-12 h-12 text-green-500 opacity-20"})]})})})]}),e.jsx("div",{className:"bg-card rounded-xl p-6 shadow-card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search by username, name, phone, or location...",value:r,onChange:h=>t(h.target.value),className:"pl-10"})]}),e.jsxs(O,{value:a,onValueChange:n,children:[e.jsx(q,{className:"w-full md:w-48",children:e.jsx(U,{placeholder:"Filter by role"})}),e.jsxs($,{children:[e.jsx(k,{value:"all",children:"All Roles"}),e.jsx(k,{value:"user",children:"Users"}),e.jsx(k,{value:"admin",children:"Admins"})]})]})]})}),p.length===0?e.jsx("div",{className:"bg-card rounded-xl p-12 shadow-card text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No users found. Add your first user to get started."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(h=>e.jsx(X,{children:e.jsxs(Y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(we,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:h.fullName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",h.username]})]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h.role==="admin"?"bg-destructive/10 text-destructive":"bg-primary/10 text-primary"}`,children:h.role})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"ğŸ“"}),e.jsx("span",{children:h.phone})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"ğŸ“"}),e.jsx("span",{children:h.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>{m(h),i(!0)},className:"flex-1",children:[e.jsx(Ke,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>D(h.id),className:"text-destructive hover:text-destructive",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})},h.id))}),e.jsx(Qe,{open:s,onOpenChange:i,children:e.jsxs(ke,{children:[e.jsx(Pe,{children:e.jsx(Fe,{children:o?"Edit User":"Add New User"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"username",children:"Username *"}),e.jsx(I,{id:"username",value:g.username,onChange:h=>j({...g,username:h.target.value}),placeholder:"johndoe",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"fullName",children:"Full Name *"}),e.jsx(I,{id:"fullName",value:g.fullName,onChange:h=>j({...g,fullName:h.target.value}),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(I,{id:"phone",value:g.phone,onChange:h=>j({...g,phone:h.target.value}),placeholder:"+254712345678",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"location",children:"Location *"}),e.jsx(I,{id:"location",value:g.location,onChange:h=>j({...g,location:h.target.value}),placeholder:"Nanyuki",required:!0})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"role",children:"Role *"}),e.jsxs(O,{value:g.role,onValueChange:h=>j({...g,role:h}),children:[e.jsx(q,{children:e.jsx(U,{})}),e.jsxs($,{children:[e.jsx(k,{value:"user",children:"User"}),e.jsx(k,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(Ar,{children:[e.jsx(E,{variant:"outline",onClick:()=>{i(!1),m(void 0)},children:"Cancel"}),e.jsxs(E,{onClick:u,className:"bg-primary",children:[o?"Update":"Create"," User"]})]})]})})]})]})}const Le=[{value:"property_type",label:"Property Types (Accommodation)"},{value:"feature",label:"Features (Accommodation & Attractions)"},{value:"amenity",label:"Room Amenities (Accommodation)"},{value:"attraction_type",label:"Attraction Types"},{value:"activity_type",label:"Activity Types"}];function aa(){var x;const[r,t]=c.useState(Le[0].value),[a,n]=c.useState([]),[s,i]=c.useState(""),[o,m]=c.useState(!1),[g,j]=c.useState(!1);c.useEffect(()=>{T()},[r]);const T=async()=>{m(!0);const f=await ie.getByType(r);n(f),m(!1)},_=async f=>{if(f.preventDefault(),!s.trim())return;j(!0),await ie.add(r,s.trim())?(v.success("Value added successfully"),i(""),T()):v.error("Failed to add value"),j(!1)},w=async f=>{if(!confirm(`Are you sure you want to delete "${f}"?`))return;await ie.remove(r,f)?(v.success("Value removed successfully"),T()):v.error("Failed to remove value")};return e.jsx(Z,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Type Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage dropdown options for Partners"})]})}),e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-card space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Select List to Edit"}),e.jsxs(O,{value:r,onValueChange:t,children:[e.jsx(q,{children:e.jsx(U,{})}),e.jsx($,{children:Le.map(f=>e.jsx(k,{value:f.value,children:f.label},f.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Add New Item"}),e.jsxs("form",{onSubmit:_,className:"flex gap-2",children:[e.jsx(I,{value:s,onChange:f=>i(f.target.value),placeholder:`New ${(x=Le.find(f=>f.value===r))==null?void 0:x.label.split(" ")[0]}...`}),e.jsx(E,{type:"submit",disabled:!s.trim()||g,children:g?e.jsx(J,{className:"w-4 h-4 animate-spin"}):e.jsx(_e,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:["Current Values",o&&e.jsx(J,{className:"w-4 h-4 animate-spin text-muted-foreground"})]}),a.length===0&&!o?e.jsxs("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-xl",children:[e.jsx(de,{className:"w-6 h-6 mx-auto mb-2 opacity-50"}),"No items found for this list. Add one above."]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border group hover:border-primary/50 transition-colors",children:[e.jsx("span",{className:"font-medium truncate",children:f}),e.jsx(E,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>w(f),children:e.jsx(xe,{className:"w-4 h-4"})})]},f))})]})]})]})})}export{Xt as A,E as B,X as C,Qe as D,I,P as L,O as S,he as T,q as a,U as b,F as c,$ as d,k as e,vt as f,kr as g,ke as h,ne as i,Pe as j,Fe as k,Xe as l,ce as m,Y as n,Pt as o,W as p,Ft as q,re as r,Nt as s,Yt as t,Zt as u,aa as v,ta as w,ra as x,ea as y};
